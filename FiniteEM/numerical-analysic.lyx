#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass ctex-book
\begin_preamble
\input{math-preamble}
\end_preamble
\options UTF8,dvipsnames,svgnames,x11names,hyperref,colorlinks=true
\use_default_options true
\begin_modules
graphicboxes
theorems-std
theorems-chap
\end_modules
\maintain_unincluded_children false
\language chinese-simplified
\language_package none
\inputencoding utf8-plain
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures false
\graphics default
\default_output_format pdf4
\output_sync 0
\bibtex_command default
\index_command default
\float_placement H
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 2
\use_package amssymb 2
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
数值分析
\end_layout

\begin_layout Author
Young
\end_layout

\begin_layout Chapter*
数值常用
\end_layout

\begin_layout Section
二进制操作
\end_layout

\begin_layout Standard
对整数 
\begin_inset Formula $n$
\end_inset

，n<<1得到 
\begin_inset Formula $n*2$
\end_inset

；n >> 1 得到 floor(n/2)，因此 1+n>>1 得到 ceil(n/2)。
\end_layout

\begin_layout Standard
只有无符号整数，除以
\begin_inset Formula $2$
\end_inset

和右移位才是等价的。负数除法是向上（向零）取整的。
\end_layout

\begin_layout Subsection
二进制反转
\end_layout

\begin_layout Standard
如果数字
\begin_inset Formula $A$
\end_inset

 的二进制编码为 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
abcde
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
，则 bcde==a>>1（右移位），如果按照大小顺序处理，则 bcde 的反转已经得到，于是可以使用归纳法。
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language=Python,keywordstyle={\color{blue}}"
inline false
status open

\begin_layout Plain Layout

for i in range(0,ilen):
\end_layout

\begin_layout Plain Layout

	rev[i] = (rev[i >> 1] >> 1) | ((i & 1) << (ilen - 1))
\end_layout

\end_inset

| 后面对首个二进制位反转，| 前面对余下
\begin_inset Formula $n-1$
\end_inset

位反转。
\end_layout

\begin_layout Section
特殊矩阵
\end_layout

\begin_layout Standard
下三角矩阵
\begin_inset Formula $L_{ij}$
\end_inset

，指标满足
\begin_inset Formula $i\ge j$
\end_inset

；上三角矩阵
\begin_inset Formula $U_{ij}$
\end_inset

，指标满足
\begin_inset Formula $i\le j$
\end_inset

。
\end_layout

\begin_layout Section
追赶法
\end_layout

\begin_layout Subsection
基本原理
\end_layout

\begin_layout Standard
\begin_inset CommandInset href
LatexCommand href
name "追赶法求解三对角方程组"
target "https://blog.csdn.net/u010450214/article/details/50170623"
literal "false"

\end_inset

。Thomas, L.H., Elliptic Problems in Linear Differential Equations over a Network.
 Watson Science Computer Laboratory Report, 1949.。
\end_layout

\begin_layout Standard
（主）三对角方程，可以用“追赶法”求解，又称为 “Thomas算法”。追赶法的基本原理是矩阵的LU分解。即将矩阵
\begin_inset Formula $A$
\end_inset

分解为
\begin_inset Formula 
\[
A=L\,U
\]

\end_inset

其中
\begin_inset Formula $L$
\end_inset

是下三角，对角线元素为
\begin_inset Formula $1$
\end_inset

；
\begin_inset Formula $U$
\end_inset

为上三角矩阵。
\series bold

\begin_inset Formula $LU$
\end_inset

分解就是高斯消去法的矩阵形式
\series default
。容易验证，一个三角矩阵作LU分解以后，得到一个下2对角矩阵和一个上2对角矩阵，即
\begin_inset Formula 
\[
A=\left[\begin{array}{ccccc}
a_{11} & a_{12}\\
a_{21} & a_{22} & a_{23}\\
 & a_{32} & a_{33} & a_{34}\\
 & \ddots & \ddots & \ddots\\
\\
 &  & a_{n-1,n-2} & a_{n-1,n-1} & a_{n-1,n}\\
 &  &  &  & a_{n,n}
\end{array}\right],
\]

\end_inset


\begin_inset Formula 
\[
L=\left[\begin{array}{ccccc}
1\\
L_{21} & 1\\
 & L_{32} & 1\\
 & \ddots & \ddots\\
 &  & L_{n-1,n-2} & 1\\
 &  &  & L_{n,n-1} & 1
\end{array}\right],\quad U=\left[\begin{array}{ccccc}
U_{11} & U_{12}\\
 & U_{22} & U_{23}\\
 &  & U_{33} & U_{34}\\
 &  & \ddots & \ddots\\
 &  &  & U_{n-1,n-1} & U_{n-1,n}\\
 &  &  &  & U_{n,n}
\end{array}\right],
\]

\end_inset

对于 
\begin_inset Formula $2\le i<n$
\end_inset

（掐头去尾），有方程
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
 & L_{i,i-1}U_{i-1,i-1}=A_{i,i-1}\\
 & L_{i,i-1}U_{i-1,i}+U_{i,i}=A_{i,i}\\
 & U_{i,i+1}=A_{i,i+1}
\end{align*}

\end_inset


\begin_inset Formula $i=0,n$
\end_inset

 的方程如下
\begin_inset Formula 
\begin{align*}
 & U_{11}=A_{11},\quad U_{12}=A_{12}\\
 & L_{n,n-1}U_{n-1,n}+U_{n,n}=A_{n,n},\quad\text{形式相同}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
综合起来，
\begin_inset Formula $A$
\end_inset

的LU分解计算过程如下（原位求解，下标从零开始）：
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language=Python,numbers=left,basicstyle={\ttfamily},keywordstyle={\color{blue}}"
inline false
status open

\begin_layout Plain Layout

for i in range(1,n+1):
\end_layout

\begin_layout Plain Layout

	A(i,i-1)=A(i,i-1)/A(i-1,i-1)
\end_layout

\begin_layout Plain Layout

	A(i,i)=A(i,i)-A(i,i-1)*A(i-1,i)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
在计算过程中，将下三角矩阵
\begin_inset Formula $L$
\end_inset

和上三角矩阵
\begin_inset Formula $U$
\end_inset

的值保存在原矩阵
\begin_inset Formula $A$
\end_inset

中。计算结束以后，矩阵
\begin_inset Formula $A$
\end_inset

中的元素为
\begin_inset Formula 
\[
\left[\begin{array}{ccccc}
U_{11} & U_{12}\\
L_{21} & U_{22} & U_{23}\\
 & L_{32} & U_{33} & U_{34}\\
 & \ddots & \ddots & \ddots\\
\\
 &  & L_{n-1,n-2} & U_{n-1,n-1} & U_{n-1,n}\\
 &  &  & L_{n,n-1} & U_{n,n}
\end{array}\right]
\]

\end_inset


\end_layout

\begin_layout Remark
三角矩阵
\begin_inset Formula $A$
\end_inset

作LU分解之后，严格上三角部分的元素没有变，即
\begin_inset Formula 
\[
U_{i,i+1}=a_{i,i+1},\quad i=1,2,\cdots,n-1
\]

\end_inset


\end_layout

\begin_layout Subsection
LU回代
\end_layout

\begin_layout Example
\begin_inset Argument 1
status open

\begin_layout Plain Layout
追的过程：分解
\end_layout

\end_inset

 对于
\begin_inset Formula $n$
\end_inset

阶的三对角方程组，
\begin_inset Formula 
\[
Ax=b
\]

\end_inset

代入LU分解可得
\begin_inset Formula 
\[
Ax=LUx=b\quad\Rightarrow\quad Ux=L^{-1}b
\]

\end_inset

另一方面可以令 
\begin_inset Formula $y=L^{-1}b$
\end_inset

，则
\begin_inset Formula 
\[
Ly=b.
\]

\end_inset

 由于
\begin_inset Formula $L$
\end_inset

，
\begin_inset Formula $U$
\end_inset

都是三角矩阵，容易求解
\begin_inset Formula $x$
\end_inset

，
\begin_inset Formula $y$
\end_inset

。综合起来就是
\begin_inset Formula 
\[
Ux=y,\quad Ly=b.
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language=Python,numbers=left,basicstyle={\ttfamily},keywordstyle={\color{blue}}"
inline false
status open

\begin_layout Plain Layout

#追
\end_layout

\begin_layout Plain Layout

for i in range(1,n):
\end_layout

\begin_layout Plain Layout

	A(i,i-1) = A(i,i-1)/A(i-1,i-1)    
\end_layout

\begin_layout Plain Layout

	A(i,i) = A(i,i) - A(i-1,i) * A(i,i-1) 
\end_layout

\begin_layout Plain Layout

	b(i) = b(i) - b(i-1) * A(i,i-1)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Example
\begin_inset Argument 1
status open

\begin_layout Plain Layout
赶的过程：回代
\end_layout

\end_inset

 接着，我们用回代法求解上三角方程组。
\begin_inset Formula 
\[
\left[\begin{array}{ccccc}
U_{11} & U_{12}\\
 & U_{22} & U_{23}\\
 &  & U_{33} & U_{34}\\
 &  & \ddots & \ddots\\
 &  &  & U_{n-1,n-1} & U_{n-1,n}\\
 &  &  &  & U_{n,n}
\end{array}\right]\left[\begin{array}{c}
x_{1}\\
x_{2}\\
\vdots\\
x_{n-1}\\
x_{n}
\end{array}\right]=\left[\begin{array}{c}
y_{1}\\
y_{2}\\
\vdots\\
y_{n-1}\\
y_{n}
\end{array}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language=Python,numbers=left,basicstyle={\ttfamily},keywordstyle={\color{blue}}"
inline false
status open

\begin_layout Plain Layout

#赶
\end_layout

\begin_layout Plain Layout

x(n) = b(n) / A(i,i) 
\end_layout

\begin_layout Plain Layout

for i in range(n-2,-1,-1):
\end_layout

\begin_layout Plain Layout

	x(i) = (b(i) - A(i,i+1) * x(i+1)) / A(i,i)
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
实用程序
\end_layout

\begin_layout Standard
在三对角矩阵中，三对角线以外的元素均为
\begin_inset Formula $0$
\end_inset

，为了提高存储的效率，我们只需存储三对角线上的元素即可.
 因此，对于前面的矩阵
\begin_inset Formula $A$
\end_inset

，我们只存储三个向量：
\begin_inset Formula 
\begin{align*}
 & D=[A(1,1),A(2,2),...,A(n-1,n-1),A(n,n)]\\
 & L=[A(2,1),A(3,2),...,A(n,n-1)]\\
 & U=[A(1,2),A(2,3),...,A(n-1,n)]
\end{align*}

\end_inset

这三个向量分别为矩阵
\begin_inset Formula $A$
\end_inset

三条对角线上的元素。假定常熟向量为
\begin_inset Formula 
\[
b=[b(1),b(2),...,b(n)]
\]

\end_inset

则追赶法的程序可以写成：
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language=Python,numbers=left,basicstyle={\ttfamily},keywordstyle={\color{blue}}"
inline false
status open

\begin_layout Plain Layout

#追
\end_layout

\begin_layout Plain Layout

for i in range(1,n):
\end_layout

\begin_layout Plain Layout

	l[i-1] = l[i-1]/d[i-1]
\end_layout

\begin_layout Plain Layout

	d[i] = d[i]-l[i-1]*u[i-1]
\end_layout

\begin_layout Plain Layout

	# Ly=b 回代
\end_layout

\begin_layout Plain Layout

	b[i] = b[i] - b[i-1]*l[i-1]
\end_layout

\begin_layout Plain Layout

#赶
\end_layout

\begin_layout Plain Layout

x[n-1] = b[n-1] / d[n-1]  
\end_layout

\begin_layout Plain Layout

for i in range(n-2,-1,-1):
\end_layout

\begin_layout Plain Layout

  x[i] = (b[i] - u[i] * x[i+1]) / d[i]
\end_layout

\end_inset


\end_layout

\begin_layout Chapter
求解方程
\end_layout

\begin_layout Standard
(数值分析–Timothy Sauer)
\end_layout

\begin_layout Standard
\begin_inset CommandInset href
LatexCommand href
name "Web content for Sauer: Numerical Analysis, 3e"
target "https://media.pearsoncmg.com/aw/aw_sauer_num_analysis_3/main.html"
literal "false"

\end_inset


\end_layout

\begin_layout Section
二分法
\end_layout

\begin_layout Subsection
把根括住
\end_layout

\begin_layout Definition
如果 
\begin_inset Formula $f(r)=0$
\end_inset

，函数 
\begin_inset Formula $f(x)$
\end_inset

 在 
\begin_inset Formula $x=r$
\end_inset

 时有一个 
\series bold
根
\series default
。
\end_layout

\begin_layout Theorem
令 
\begin_inset Formula $f$
\end_inset

 是区间 
\begin_inset Formula $[a,b]$
\end_inset

 上的连续函数，满足 
\begin_inset Formula $f(a)f(b)<0$
\end_inset

，则 
\begin_inset Formula $f$
\end_inset

 在 
\begin_inset Formula $a$
\end_inset

 和 
\begin_inset Formula $b$
\end_inset

 之间存在一个根，也就是说，存在数字 
\begin_inset Formula $r$
\end_inset

，满足 
\begin_inset Formula $a<r<b$
\end_inset

，以及 
\begin_inset Formula $f(r)=0$
\end_inset

。
\end_layout

\begin_layout Theorem
page23/24：二分法程序。
\end_layout

\begin_layout Definition
如果误差小于 
\begin_inset Formula $0.5\times10^{-p}$
\end_inset

，解精确到小数点后 
\begin_inset Formula $p$
\end_inset

 位。
\end_layout

\begin_layout Section
不动点迭代
\end_layout

\begin_layout Standard
p 27/42
\end_layout

\begin_layout Definition
当 
\begin_inset Formula $g(r)=r$
\end_inset

，实数 
\begin_inset Formula $r$
\end_inset

 是函数 
\begin_inset Formula $g$
\end_inset

 的 
\series bold
不动点
\series default
。
\end_layout

\begin_layout Definition
例如，数字 
\begin_inset Formula $r=0.739\,085\,133\,2$
\end_inset

 是函数 
\begin_inset Formula $g(x)=\cos x$
\end_inset

 的近似不动点。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
不动点迭代
\begin_inset Formula 
\begin{align*}
 & x_{0}=\text{初始估计}\\
 & x_{i+1}=g(x_{i}),\quad\text{其中}i=0,1,2,\cdots
\end{align*}

\end_inset

因此，
\begin_inset Formula 
\begin{align*}
 & x_{1}=g(x_{0})\\
 & x_{2}=g(x_{1})\\
 & x_{3}=g(x_{2})\\
 & \vdots
\end{align*}

\end_inset

根据连续函数的极限定理 (0.5)，
\begin_inset Formula 
\begin{equation}
g(r)=g(\lim_{i\to\infty}x_{i})=\lim_{i\to\infty}g(x_{i})=\lim_{i\to\infty}x_{i+1}=r\label{eq:1.3}
\end{equation}

\end_inset

mat代码，page28。
\end_layout

\begin_layout Definition
不动点迭代的几何图示被称作 cobweb 图
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:t1.4"
plural "false"
caps "false"
noprefix "false"

\end_inset

。产生迭代值和点的代码
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
fpi[f_, x0_, n_] := NestList[f, x0, n]; cobs[f_, x0_, 0] := {{x0, 0}, {x0,
 f@x0}}; cobs[f_, x0_, n_] := Module[{tmp, r1, r2, r3, r4}, tmp = fpi[f,
 x0, n]; r1 = Most@tmp; r2 = ReplacePart[r1, 1 -> 0]; r3 = r1; r4 = Rest@tmp;
 Riffle[Transpose@{r1, r2}, Transpose@{r3, r4}] ];
\end_layout

\end_inset

；cobweb图代码
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
fn = -1/2 # + 3/2 &; pts = cobs[fn, 0, 10]; alist = Table[Arrow[{pts[[i]],
 pts[[i + 1]]}], {i, 1, Length@pts - 1}]; f1 = Plot[{x, fn@x}, {x, 0, 1.5}
 , PlotRange -> Automatic , Frame -> True , ImageSize -> Medium , AspectRatio
 -> Automatic]; f2 = Graphics[ Prepend[alist, Arrowheads[{{.018, 1}}]] ];
 Show[f1, f2]
\end_layout

\end_inset

；迭代回路的水平线和垂直线是等长的，长度为
\begin_inset Formula $\Delta x_{i+1}=x_{i+1}-x_{i}$
\end_inset

。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename inset/cobweb.pdf
	lyxscale 50
	scale 35

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:t1.4"

\end_inset

如果函数（图中黄色）的斜率小于
\begin_inset Formula $1$
\end_inset

，初始接近的猜测会在不动点迭代过程中距离不动点越来越近，最终收敛。反之若斜率绝对值大于
\begin_inset Formula $1$
\end_inset

，则方法会失败。
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Definition
令 
\begin_inset Formula $e_{i}$
\end_inset

 表示迭代过程中第 
\begin_inset Formula $i$
\end_inset

 步时的误差，如果
\begin_inset Formula 
\[
\lim_{i\to\infty}\frac{e_{i+1}}{e_{i}}=S<1,\quad e_{i}=\abs{r-x_{i}}
\]

\end_inset

该方法被称为满足 
\series bold
线性收敛
\series default
，收敛速度为 
\begin_inset Formula $S$
\end_inset

。
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:1.6"

\end_inset

假设函数 
\begin_inset Formula $g$
\end_inset

 是连续可微函数，
\begin_inset Formula $g(r)=r$
\end_inset

，
\begin_inset Formula $S=\abs{g'(r)}<1$
\end_inset

，则不动点迭代对于一个足够接近 
\begin_inset Formula $r$
\end_inset

 的初始估计，以速度 
\begin_inset Formula $S$
\end_inset

 线性收敛到不动点 
\begin_inset Formula $r$
\end_inset

。
\end_layout

\begin_layout Proof
令
\begin_inset Formula $x_{i}$
\end_inset

表示第
\begin_inset Formula $i$
\end_inset

步迭代。根据均值定理，在
\begin_inset Formula $x_{i}$
\end_inset

和
\begin_inset Formula $r$
\end_inset

之间存在
\begin_inset Formula $c_{i}$
\end_inset

，满足
\begin_inset Formula 
\begin{align}
 & g'(c_{i})=\frac{g(x_{i})-g(r)}{x_{i}-r},\nonumber \\
\Rightarrow\quad & x_{i+1}-r=g'(c_{i})(x_{i}-r)\label{eq:t1.9}
\end{align}

\end_inset

其中代入了 
\begin_inset Formula $x_{i+1}=g(x_{i})$
\end_inset

以及
\begin_inset Formula $r=g(r)$
\end_inset

。定义
\begin_inset Formula $e_{i}=\abs{x_{i}-r}$
\end_inset

，式
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:t1.9"
plural "false"
caps "false"
noprefix "false"

\end_inset

可以写为
\begin_inset Formula 
\begin{equation}
e_{i+1}=\abs{g'(c_{i})}e_{i}\label{eq:t1.10}
\end{equation}

\end_inset

如果
\begin_inset Formula $S=\abs{g'(r)}$
\end_inset

小于
\begin_inset Formula $1$
\end_inset

，则通过替换
\begin_inset Formula $g'$
\end_inset

，在
\begin_inset Formula $r$
\end_inset

附近有一个小的区间满足
\begin_inset Formula $\abs{g'(x)}<(S+1)/2$
\end_inset

，这个值比
\begin_inset Formula $S$
\end_inset

大一点，但仍然小于
\begin_inset Formula $1$
\end_inset

。如果
\begin_inset Formula $x_{i}$
\end_inset

恰好出现在该区间，则
\begin_inset Formula $c_{i}$
\end_inset

也在该区间（
\begin_inset Formula $c_{i}$
\end_inset

被限制在
\begin_inset Formula $x_{i}$
\end_inset

和
\begin_inset Formula $r$
\end_inset

之间），因而
\begin_inset Formula 
\[
e_{i+1}\le\frac{S+1}{2}e_{i}
\]

\end_inset

所以，误差以
\begin_inset Formula $(S+1)/2$
\end_inset

的速度下降，在后面各步中也许会比该速度更好。这意味着
\begin_inset Formula $\lim_{i\to\infty}x_{i}=r$
\end_inset

，利用
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:t1.10"
plural "false"
caps "false"
noprefix "false"

\end_inset

中的极限得到
\begin_inset Formula 
\[
\lim_{i\to\infty}\frac{e_{i+1}}{e_{i}}=\lim_{i\to\infty}\abs{g'(c_{i})}=\abs{g'(r)}=S
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
根据定理
\begin_inset CommandInset ref
LatexCommand eqref
reference "thm:1.6"
plural "false"
caps "false"
noprefix "false"

\end_inset

，近似误差之间的关系
\begin_inset Formula 
\[
e_{i+1}\approx S\,e_{i}
\]

\end_inset

 在收敛过程中得到保持，其中
\begin_inset Formula $S=\abs{g'(r)}$
\end_inset

。在习题25中可以看到该定理的一个变体。
\end_layout

\begin_layout Exercise
习题25。证明
\begin_inset CommandInset ref
LatexCommand eqref
reference "thm:1.6"
plural "false"
caps "false"
noprefix "false"

\end_inset

的变体：如果
\begin_inset Formula $g$
\end_inset

是连续可微函数，在包含不动点的区间
\begin_inset Formula $[a,b]$
\end_inset

上，
\begin_inset Formula $\abs{g'(x)}\le B<1$
\end_inset

，则FPI从区间
\begin_inset Formula $[a,b]$
\end_inset

中的任意初始估计都能收敛到
\begin_inset Formula $r$
\end_inset

。
\end_layout

\begin_layout Definition
如果迭代方法对于一个足够接近 
\begin_inset Formula $r$
\end_inset

 的初值能收敛到 
\begin_inset Formula $r$
\end_inset

，该迭代方法被称为 
\series bold
局部收敛
\series default
 到 
\begin_inset Formula $r$
\end_inset

。
\end_layout

\begin_layout Definition
换句话说， 如果存在近邻区间 
\begin_inset Formula $(r-\varepsilon,r+\varepsilon)$
\end_inset

，其中 
\begin_inset Formula $\varepsilon>0$
\end_inset

，使得近邻区间中所有的初始估计都可以收敛到
\begin_inset Formula $r$
\end_inset

，则该方法局部收敛到
\begin_inset Formula $r$
\end_inset

。定理1.6 的结论是当 
\begin_inset Formula $\abs{g'(r)}<1$
\end_inset

 时 不动点迭代 局部收敛。
\end_layout

\begin_layout Example
使用 FPI 计算 
\begin_inset Formula $\sqrt{2}$
\end_inset

。从 
\begin_inset Formula $x^{2}=2$
\end_inset

转化
\begin_inset Formula 
\begin{align*}
 & 2x^{2}=x^{2}+2\\
\Rightarrow & x=\frac{x+2/x}{2}
\end{align*}

\end_inset

令 
\begin_inset Formula $g(x)=\frac{x+\frac{2}{x}}{2}$
\end_inset

，所使用的 FPI 如下：
\begin_inset Formula 
\[
x_{i+1}=\frac{x_{i}+\frac{2}{x_{i}}}{2}
\]

\end_inset


\end_layout

\begin_layout Subsection
改进的FPI
\end_layout

\begin_layout Standard
方程为
\begin_inset Formula $x=g(x)$
\end_inset

，有根
\begin_inset Formula $r$
\end_inset

满足
\begin_inset Formula $r=g(r)$
\end_inset

。改进的不动点迭代
\begin_inset Formula 
\begin{align}
 & x_{0}=\text{初始估计}\nonumber \\
 & x_{i+1}=\lambda_{i}\,g(x_{i})+\overline{\lambda}_{i}\,x_{i},\quad\text{其中}i=0,1,2,\cdots\label{eq:my1}
\end{align}

\end_inset

其中
\begin_inset Formula $0<\lambda_{i}\le1$
\end_inset

，
\begin_inset Formula $\overline{\lambda}_{i}=1-\overline{\lambda}$
\end_inset

。在每一步都引入了组合因子。同样使用中值定理
\begin_inset Formula 
\[
g'(c_{i})=\frac{g(x_{i})-g(r)}{x_{i}-r},
\]

\end_inset

定义
\begin_inset Formula $k=g'(c_{i})$
\end_inset

，并代入
\begin_inset Formula $r=g(r)$
\end_inset

、式
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:my1"
plural "false"
caps "false"
noprefix "false"

\end_inset

化简
\begin_inset Formula 
\begin{align*}
k(x_{i}-r) & =g(x_{i})-g(r)\\
\Rightarrow k(x_{i}-r) & =\frac{x_{i+1}-\overline{\lambda}_{i}x_{i}}{\lambda_{i}}-r\\
\lambda_{i}k(x_{i}-r) & =x_{i+1}-\overline{\lambda}_{i}x_{i}-\lambda_{i}r\\
\lambda_{i}k(x_{i}-r)+\overline{\lambda}_{i}x_{i} & =x_{i+1}-\lambda_{i}r\\
\lambda_{i}k(x_{i}-r)+\overline{\lambda}_{i}(x_{i}-r) & =x_{i+1}-r
\end{align*}

\end_inset

定义
\begin_inset Formula $e_{i}=\abs{x_{i}-r}$
\end_inset

，稍作整理
\begin_inset Formula 
\begin{equation}
e_{i+1}=P_{i}\,e_{i}\label{eq:my5}
\end{equation}

\end_inset

其中
\begin_inset Formula $P=\abs{\lambda_{i}\,g'(c_{i})+\overline{\lambda}_{i}}$
\end_inset

。我们选取的
\begin_inset Formula $\lambda$
\end_inset

满足
\begin_inset Formula $0<\lambda_{i}\le1$
\end_inset

。如果
\begin_inset Formula $S=\abs{g'(r)}$
\end_inset

小于
\begin_inset Formula $1$
\end_inset

，可以证明在
\begin_inset Formula $r$
\end_inset

附近必然存在充分小的区域满足
\begin_inset Formula 
\[
P_{i}=\abs{\lambda_{i}\,g'(c_{i})+\overline{\lambda}_{i}}<1,\quad0<\lambda\le1
\]

\end_inset

因而误差收敛。
\end_layout

\begin_layout Standard
但实际上引入
\begin_inset Formula $\lambda_{i}$
\end_inset

之后，对于
\begin_inset Formula $g'(c_{i})$
\end_inset

可以容许更大的收敛域。图
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:fpi2"
plural "false"
caps "false"
noprefix "false"

\end_inset

给出了误差的收敛域，即满足
\begin_inset Formula $0\le P_{i}<1$
\end_inset

的区域。其中横轴是
\begin_inset Formula $\lambda_{i}$
\end_inset

，取值范围是
\begin_inset Formula $(0,1]$
\end_inset

，纵轴为
\begin_inset Formula $g'(c_{i})$
\end_inset

，取值范围是
\begin_inset Formula $(-\infty,1]$
\end_inset

，当
\begin_inset Formula $g'(c_{i})$
\end_inset

沿着纵轴下降时，
\begin_inset Formula $\lambda$
\end_inset

需要相应缩小，以满足误差收敛条件。也就是说通过在每次迭代中调节
\begin_inset Formula $\lambda_{i}$
\end_inset

，可以使得原本在FPI中发散的求解序列获得更好的收敛性。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename inset/fpi2.pdf
	lyxscale 70
	scale 48

\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
RegionPlot[ 0 <= Abs[
\backslash
[Lambda]*gc + 1 - 
\backslash
[Lambda]] < 1, {
\backslash
[Lambda], 0, 1}, {gc, -5, 1.1} , BoundaryStyle -> Dashed, PlotStyle -> Automatic
 , FrameLabel -> {"
\backslash
[Lambda]", "gc"}, ImageSize -> Medium]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:fpi2"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Remark
牛顿法求解
\begin_inset Formula $f(x)=0$
\end_inset

的迭代公式是
\begin_inset Formula 
\begin{align*}
 & x_{0}=\text{初始估计}\\
 & x_{i+1}=x_{i}-\frac{f(x_{i})}{f'(x_{i})},\quad i=0,1,2,\cdots
\end{align*}

\end_inset

代入
\begin_inset Formula $f(x)=x-g(x)$
\end_inset

得
\begin_inset Formula 
\[
x_{i+1}=g(x_{i})\frac{1}{1-g'(x_{i})}+x_{i}\frac{-g'(x_{i})}{1-g'(x_{i})}
\]

\end_inset


\end_layout

\begin_layout Remark
割线方法求解
\begin_inset Formula $f(x)=0$
\end_inset

的迭代公式是
\begin_inset Formula 
\begin{align*}
 & x_{0},x_{1}=\text{初始估计}\\
 & x_{i+1}=x_{i}-\frac{f(x_{i})(x_{i}-x_{i-1})}{f(x_{i})-f(x_{i-1})},\quad i=1,2,3,\cdots
\end{align*}

\end_inset

代入
\begin_inset Formula $f(x)=x-g(x)$
\end_inset

得
\begin_inset Formula 
\[
x_{i+1}=g_{i}\frac{\Delta x_{i}}{\Delta x_{i}-\Delta g_{i}}+x_{i}\frac{-\Delta g_{i}}{\Delta x_{i}-\Delta g_{i}}
\]

\end_inset

其中
\begin_inset Formula $\Delta x_{i}=x_{i}-x_{i-1}$
\end_inset

，
\begin_inset Formula $\Delta g_{i}=g(x_{i})-g(x_{i-1})$
\end_inset

。
\end_layout

\begin_layout Remark
可以看到，两种方法的迭代公式都可以写成以下形式
\begin_inset Formula 
\[
x_{i+1}=\lambda_{i}\,g(x_{i})+\overline{\lambda}_{i}\,x_{i}
\]

\end_inset

其中
\begin_inset Formula $\lambda_{i}+\overline{\lambda}_{i}=1$
\end_inset

，改进FPI可以看作两种方法的推广。
\end_layout

\begin_layout Example
对于不动点问题
\begin_inset Formula $x=g(x)$
\end_inset

，其中
\begin_inset Formula $g(x)=-3/2x+5/2$
\end_inset

，由于
\begin_inset Formula $\abs{g(c_{i})}=3/2>1$
\end_inset

，使用普通的FPI不会收敛，如图
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:fpi3"
plural "false"
caps "false"
noprefix "false"

\end_inset

a。但使用改进的FPI，并令
\begin_inset Formula $\lambda=0.7$
\end_inset

，此时
\begin_inset Formula $P=0.75$
\end_inset

，则迭代收敛，如图
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:fpi3"
plural "false"
caps "false"
noprefix "false"

\end_inset

b。可以看到对于改进的FPI，迭代点
\begin_inset Formula $x_{i+1}$
\end_inset

并不落在
\begin_inset Formula $y=g(x)$
\end_inset

曲线上，而是落在
\begin_inset Formula $y=x$
\end_inset

 和 
\begin_inset Formula $y=g(x)$
\end_inset

两条曲线之间，即图
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:fpi3"
plural "false"
caps "false"
noprefix "false"

\end_inset

b中的红色曲线，它就是修正曲线。当迭代序列到达根
\begin_inset Formula $r$
\end_inset

附近时，三条曲线是相交的，所以不会影响最终结果的正确性。可以看到，在改进的FPI中，迭代回路的水平或垂直线段长度
\begin_inset Formula $\Delta x_{i+1}=x_{i+1}-x_{i}$
\end_inset

变小，得到了有效的控制。但是
\begin_inset Formula $\lambda$
\end_inset

也不能取得过小，如图
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:fpi3"
plural "false"
caps "false"
noprefix "false"

\end_inset

c，此时虽然收敛性好，但是收敛速率下降，需要更多步才能找到根。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename inset/fpi3a.pdf
	lyxscale 70
	scale 40

\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
fpi[f_, x0_, n_] := NestList[f, x0, n]; cobs[f_, x0_, 0] := {{x0, 0}, {x0,
 f@x0}}; cobs[f_, x0_, n_] := Module[{tmp, r1, r2, r3, r4}, tmp = fpi[f,
 x0, n]; r1 = Most@tmp; r2 = ReplacePart[r1, 1 -> 0]; r3 = r1; r4 = Rest@tmp;
 Riffle[Transpose@{r1, r2}, Transpose@{r3, r4}]];(*figure*)fn = -3/2 # +
 5/2 &; pts = cobs[fn, 0.7, 10]; alist = Table[Arrow[{pts[[i]], pts[[i +
 1]]}], {i, 1, Length@pts - 1}]; f1 = Plot[{x, fn@x}, {x, -7.2, 9.5}, PlotRange
 -> {Automatic, {-8, 14}}, Frame -> True, ImageSize -> Medium, AspectRatio
 -> Automatic , PlotStyle -> {Thickness[.005]}]; f2 = Graphics[Prepend[Thickness@
0.003]@ Prepend[alist, Arrowheads[{{.018, 1}}]]]; Show[f1, f2, ImageSize ->
 500]
\end_layout

\end_inset


\begin_inset space \enskip{}
\end_inset


\begin_inset Graphics
	filename inset/fpi3b.pdf
	lyxscale 70
	scale 40

\end_inset


\begin_inset Note Note
status open

\begin_layout Plain Layout
fpi2[
\backslash
[Lambda]_, f_, x0_, 0] := {x0}; fpi2[
\backslash
[Lambda]_, f_, x0_, n_] := Module[{tmp, last}, tmp = fpi2[
\backslash
[Lambda], f, x0, n - 1]; last = Last@tmp; Append[tmp, 
\backslash
[Lambda]*f@last + (1 - 
\backslash
[Lambda])*last]]; cobs2[
\backslash
[Lambda]_, f_, x0_, 0] := {{x0, 0}, {x0, 
\backslash
[Lambda]*f@x0 + (1 - 
\backslash
[Lambda])*x0}}; cobs2[
\backslash
[Lambda]_, f_, x0_, n_] := Module[{tmp, r1, r2, r3, r4}, tmp = fpi2[
\backslash
[Lambda], f, x0, n]; r1 = Most@tmp; r2 = ReplacePart[r1, 1 -> 0]; r3 = r1;
 r4 = Rest@tmp; Riffle[Transpose@{r1, r2}, Transpose@{r3, r4}]];(*figure*)fn
 = -3/2 # + 5/2 &; 
\backslash
[Lambda] = 0.7;(*回旋路径*)pts = cobs2[
\backslash
[Lambda], fn, 0.7, 12]; cowList = Table[Arrow[{pts[[i]], pts[[i + 1]]}],
 {i, 1, Length@pts - 1}];(*迭代路径*)fpiList = pts[[2 ;; All ;; 2]]; f1 = Plot[{x,
 fn@x}, {x, 0.62, 1.3}, PlotRange -> {Automatic, {0.75, 1.3}}, Frame -> True,
 ImageSize -> Medium, AspectRatio -> Automatic , PlotStyle -> {Thickness[.005]}];
 f2 = Graphics[Prepend[Thickness@0.003]@ Prepend[cowList, Arrowheads[{{.018,
 1}}]]]; f3 = ListLinePlot[fpiList, PlotStyle -> {Red, Thickness[0.005]}];
 Show[f1, f2, f3, ImageSize -> 500]
\end_layout

\end_inset


\begin_inset space \enskip{}
\end_inset


\begin_inset Graphics
	filename inset/fpi3c.pdf
	lyxscale 70
	scale 40

\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
fpi2[
\backslash
[Lambda]_, f_, x0_, 0] := {x0}; fpi2[
\backslash
[Lambda]_, f_, x0_, n_] := Module[{tmp, last}, tmp = fpi2[
\backslash
[Lambda], f, x0, n - 1]; last = Last@tmp; Append[tmp, 
\backslash
[Lambda]*f@last + (1 - 
\backslash
[Lambda])*last] ]; cobs2[
\backslash
[Lambda]_, f_, x0_, 0] := {{x0, 0}, {x0, 
\backslash
[Lambda]*f@x0 + (1 - 
\backslash
[Lambda])*x0}}; cobs2[
\backslash
[Lambda]_, f_, x0_, n_] := Module[{tmp, r1, r2, r3, r4}, tmp = fpi2[
\backslash
[Lambda], f, x0, n]; r1 = Most@tmp; r2 = ReplacePart[r1, 1 -> 0]; r3 = r1;
 r4 = Rest@tmp; Riffle[Transpose@{r1, r2}, Transpose@{r3, r4}]]; (*figure*)
 fn = -3/2 # + 5/2 &; 
\backslash
[Lambda] = 0.1; rnds = 14; (*回旋路径*)pts = cobs2[
\backslash
[Lambda], fn, 0.7, rnds]; cowList = Table[Arrow[{pts[[i]], pts[[i + 1]]}],
 {i, 1, Length@pts - 1}]; (*迭代路径*)fpiList = pts[[2 ;; All ;; 2]]; f1 = Plot[{x,
 fn@x}, {x, 0.65, 1.05} , PlotRange -> {Automatic, {0.6, 1.2}}, Frame -> True
 , ImageSize -> Medium, AspectRatio -> Automatic]; f2 = Graphics[Prepend[cowList
, Arrowheads[{{.018, 1}}]]]; f3 = ListLinePlot[fpiList, PlotStyle -> {Red,
 AbsoluteThickness[1]}]; Show[f1, f2, f3]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:fpi3"

\end_inset

图a：FPI；图b：改进的FPI，
\begin_inset Formula $\lambda=0.7$
\end_inset

；图c：改进的FPI，但
\begin_inset Formula $\lambda=0.1$
\end_inset

取值过小。
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
回溯线搜索
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
Ax=b
\]

\end_inset


\begin_inset Formula 
\begin{align}
 & x_{0}=\text{初始估计}\nonumber \\
 & \Delta x_{i+1}=\lambda_{i}\left[A_{i}^{-1}b_{i}-x_{i}\right],\label{eq:my4}\\
\text{等价于}\quad & A_{i}\,\Delta x_{i+1}=\lambda_{i}\left[b_{i}-A_{i}x_{i}\right],
\end{align}

\end_inset

增量
\begin_inset Formula $\Delta x_{i+1}$
\end_inset

对应的修正激励向量为
\begin_inset Formula $B_{i}=b_{i}-A_{i}x_{i}$
\end_inset

；假设在第
\begin_inset Formula $i$
\end_inset

步骤选择了参数
\begin_inset Formula $\Lambda_{i}$
\end_inset

，则使用莱布尼茨法则
\begin_inset Formula 
\begin{align*}
\Delta B_{i+1} & =\Delta b_{i+1}-\Delta A_{i+1}x_{i+1}-A_{i}\Delta x_{i+1}\\
 & =\Delta b_{i+1}-\Delta A_{i+1}x_{i+1}-\Lambda_{i}\left[b_{i}-A_{i}x_{i}\right]
\end{align*}

\end_inset

其中
\begin_inset Formula $b_{i+1}=b_{i}+\Delta b_{i+1}$
\end_inset

，
\begin_inset Formula $A_{i+1}=A_{i}+\Delta A_{i+1}$
\end_inset

，所以
\begin_inset Formula 
\[
B_{i+1}=\Delta b_{i+1}-\Delta A_{i+1}x_{i+1}+\overline{\Lambda}_{i}\left[b_{i}-A_{i}x_{i}\right]
\]

\end_inset

加入
\begin_inset Formula $b$
\end_inset

不依赖于
\begin_inset Formula $x$
\end_inset

，则
\begin_inset Formula 
\[
B_{i+1}=-\Delta A_{i+1}x_{i+1}+\overline{\Lambda}_{i}\left(b_{i}-A_{i}x_{i}\right)
\]

\end_inset


\end_layout

\begin_layout Subsection
终止条件
\end_layout

\begin_layout Standard
FPI 收敛到给定
\series bold
容差
\series default
（TOL）的步数无法事先预测，必须决定何时终止算法，即
\series bold
终止条件
\series default
。
\end_layout

\begin_layout Standard
绝对 终止条件
\begin_inset Formula 
\begin{equation}
\abs{x_{i+1}-x_{i}}<\mathrm{TOL}\label{eq:1.16}
\end{equation}

\end_inset

或者当解不在 
\begin_inset Formula $0$
\end_inset

 附近，使用相对误差条件
\begin_inset Formula 
\begin{equation}
\frac{\abs{x_{i+1}-x_{i}}}{\abs{x_{i+1}}}<\mathrm{TOL}\label{eq:1.17}
\end{equation}

\end_inset

还有混合 绝对/相对误差 终止条件：
\begin_inset Formula 
\begin{equation}
\frac{\abs{x_{i+1}-x_{i}}}{\max(\abs{x_{i+1}},\theta)}<\mathrm{TOL}\label{eq:1.18}
\end{equation}

\end_inset

其中 
\begin_inset Formula $\theta>0$
\end_inset

，常常用于 
\begin_inset Formula $0$
\end_inset

 附近的解。此外，好的 FPI 代码应当在收敛失败的时候，设置最大迭代步数的限制。终止条件的讨论很重要，并将在
\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:1.3"
plural "false"
caps "false"
noprefix "false"

\end_inset

节中讨论前向和后向误差的时候以更加复杂的形式出现。
\end_layout

\begin_layout Standard
二分法可以保证线性收敛。不动点迭代仅仅是局部收敛，当不动点迭代收敛时，其线性收敛。两种方法在每一步中仅仅需要进行一次函数求值。二分法在每一步中可以去掉
\begin_inset Formula $1/2$
\end_inset

的不确定性，而在FPI中，不确定性每步会乘上
\begin_inset Formula $S=\abs{g'(r)}$
\end_inset

。因而不动点迭代可能比二分法更快或更慢，这依赖于
\begin_inset Formula $S$
\end_inset

比
\begin_inset Formula $1/2$
\end_inset

更大还是小。在
\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:1.4"
plural "false"
caps "false"
noprefix "false"

\end_inset

节中，我们将学习牛顿方法，它是FPI 的一种改善方法，其中 
\begin_inset Formula $S$
\end_inset

 被设计为
\begin_inset Formula $0$
\end_inset

。
\end_layout

\begin_layout Section
精度的极限
\begin_inset CommandInset label
LatexCommand label
name "sec:1.3"

\end_inset


\end_layout

\begin_layout Subsection
前向与后向误差
\end_layout

\begin_layout Example
使用二分法计算函数 
\begin_inset Formula $f(x)=x^{3}-2x^{2}+\frac{4}{3}x-\frac{8}{27}=\left(x-\frac{2}{3}\right)^{3}$
\end_inset

的根，精确到小数点后
\begin_inset Formula $6$
\end_inset

位。
\end_layout

\begin_layout Definition
假设 
\begin_inset Formula $f$
\end_inset

 是一个函数，
\begin_inset Formula $r$
\end_inset

 是一个根，意味着满足 
\begin_inset Formula $f(r)=0$
\end_inset

。假设 
\begin_inset Formula $x_{a}$
\end_inset

 是 
\begin_inset Formula $r$
\end_inset

 的近似值。对于根求值问题，近似 
\begin_inset Formula $x_{a}$
\end_inset

 的 
\series bold
后向误差
\series default
（backwards） 是 
\begin_inset Formula $\abs{f(x_{a})}$
\end_inset

，
\series bold
前向误差
\series default
（forwards）是 
\begin_inset Formula $\abs{r-x_{a}}$
\end_inset

。
\end_layout

\begin_layout Standard
“后向” 和 “前向”的使用可能需要一些解释。我们认为 寻找根 的过程在中间，问题是输入，解是输出：
\begin_inset Formula 
\[
\text{定义问题的数据}\to\left[\text{求解过程}\right]\to\text{解}
\]

\end_inset

在本章中，“问题”是单变量的方程，“求解过程”是求解方程的算法：
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\text{方程}\to\left[\text{方程求解器}\right]\to\text{解}
\]

\end_inset

后向误差在左边或者输入一侧（问题数据）。这是我们需要对于问题（函数
\begin_inset Formula $f$
\end_inset

）改变的量，使得方程平衡并输出近似解 
\begin_inset Formula $x_{a}$
\end_inset

。这个量是 
\begin_inset Formula $\abs{f(x_{a})}$
\end_inset

。前向误差是右边或者输出一侧（问题求解）。这是我们对于近似解要做的修正，该误差是 
\begin_inset Formula $\abs{r-x_{a}}$
\end_inset

。
\end_layout

\begin_layout Standard
例1.7 是一个非常特殊的例子，函数 
\begin_inset Formula $f$
\end_inset

 在 
\begin_inset Formula $r=2/3$
\end_inset

 具有三阶根。注意到
\begin_inset Formula 
\[
f(x)=x^{3}-2x^{2}+\frac{4}{3}x-\frac{8}{27}=\left(x-\frac{2}{3}\right)^{3}
\]

\end_inset

在根的位置具有 重根。后向误差接近 
\begin_inset Formula $\varepsilon_{\text{mach}}\approx2.2\times10^{-16}$
\end_inset

，而前向误差大约 
\begin_inset Formula $10^{-5}$
\end_inset

。双精度数不能在机器精度的相对误差下可靠计算，因为后向误差不能被可靠降低，同时前向误差也不能减小。
\end_layout

\begin_layout Definition
\begin_inset CommandInset label
LatexCommand label
name "def:1.9"

\end_inset

假设 
\begin_inset Formula $r$
\end_inset

 是可微函数 
\begin_inset Formula $f$
\end_inset

 的根；也就是说，假设 
\begin_inset Formula $f(r)=0$
\end_inset

。则如果 
\begin_inset Formula $0=f(r)=f'(r)=f''(r)=\cdots f^{(m-1)}(r)$
\end_inset

，但是 
\begin_inset Formula $f^{(m)}(r)\neq0$
\end_inset

，我们说函数 
\begin_inset Formula $f$
\end_inset

 在点 
\begin_inset Formula $r$
\end_inset

 具有 
\begin_inset Formula $m$
\end_inset

 
\series bold
重根
\series default
。当多重性大于
\begin_inset Formula $1$
\end_inset

，我们说函数 
\begin_inset Formula $f$
\end_inset

 在 
\begin_inset Formula $r$
\end_inset

 点具有 
\series bold
重根
\series default
。当多重性等于 
\begin_inset Formula $1$
\end_inset

时，根被称为 
\series bold
单根
\series default
。
\end_layout

\begin_layout Standard
由于函数在 多根附近 十分平缓，前向和后向 误差之间在 近似解的附近存在很大的不一致。后向误差在垂直方向进行度量，通常比在水平方向度量的前向误差要小得多。
\end_layout

\begin_layout Standard
例如 
\begin_inset Formula $f(x)=\sin x-x$
\end_inset

 在 
\begin_inset Formula $r=0$
\end_inset

 处有三重根，近似根在 
\begin_inset Formula $x_{a}=0.001$
\end_inset

处的前向误差为 
\begin_inset Formula $\text{FE}=\abs{r-x_{a}}=10\textasciicircum-3$
\end_inset

。后向误差是一个常数，需要加到 
\begin_inset Formula $f(x)$
\end_inset

 上，使 
\begin_inset Formula $x_{a}$
\end_inset

 称为根，即 
\begin_inset Formula $\text{BE}=\abs{f(x_{a})}=\abs{\sin(0.001)-0.001}\approx1.6667\times10^{-10}$
\end_inset

。
\end_layout

\begin_layout Standard
多重根问题只是冰山一角。没有多重根问题时也可能会出现问题，正如下一节将要讲述的问题。
\end_layout

\begin_layout Subsection
威尔金森多项式
\end_layout

\begin_layout Standard
一个难以进行数值求解的单根例子在 威尔金森[1994] 的论著中进行了讨论。
\series bold
威尔金森多项式
\series default
 是
\begin_inset Formula 
\begin{equation}
W(x)=(x-1)(x-2)\cdots(x-20)\label{eq:1.19}
\end{equation}

\end_inset

输入 
\begin_inset Formula $x=16$
\end_inset

 作为初始估计，令人惊讶的是，MATLAB 不能返回第二个正确的小数位。
\end_layout

\begin_layout Subsection
根搜索的敏感性
\end_layout

\begin_layout Standard
如果在输入中是一个小误差，在这种情况下对问题进行求解，造成输出中的大问题，这样的问题被称为 
\series bold
敏感性
\series default
 问题。在本节中我们将量化误差，对引入误差放大因子 和 条件数改变。
\end_layout

\begin_layout Standard
假设问题是找到 
\begin_inset Formula $f(x)=0$
\end_inset

 的根
\begin_inset Formula $r$
\end_inset

，但是对输入做了一个小变化 
\begin_inset Formula $\varepsilon g(x)$
\end_inset

，其中 
\begin_inset Formula $\varepsilon$
\end_inset

 很小。令 
\begin_inset Formula $\Delta r$
\end_inset

 是对应根中的变化，因而
\begin_inset Formula 
\[
f(r+\Delta r)+\varepsilon g(r+\Delta r)=0
\]

\end_inset

作泰勒展开得到
\begin_inset Formula 
\[
\Delta r\left[f'(r)+\varepsilon g'(r)\right]\approx-f(r)-\varepsilon g(r)=-\varepsilon g(r)
\]

\end_inset

或者
\begin_inset Formula 
\[
\Delta r\approx\frac{-\varepsilon g(r)}{f'(r)+\varepsilon g'(r)}\approx-\varepsilon\frac{g(r)}{f'(r)}
\]

\end_inset

假设相比于 
\begin_inset Formula $f'(r)$
\end_inset

，
\begin_inset Formula $\varepsilon$
\end_inset

 很小，并且 
\begin_inset Formula $f'(r)\neq0$
\end_inset

。
\end_layout

\begin_layout Standard
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
根的敏感公式
\end_layout

\begin_layout Plain Layout
假设 
\begin_inset Formula $r$
\end_inset

 是函数 
\begin_inset Formula $f(x)$
\end_inset

 的根，并且 
\begin_inset Formula $r+\Delta r$
\end_inset

 是 
\begin_inset Formula $f(x)+\varepsilon g(x)$
\end_inset

 的根，则当
\begin_inset Formula $\varepsilon\ll f'(r)$
\end_inset

时，
\begin_inset Formula 
\begin{equation}
\Delta r\approx-\varepsilon\frac{g(r)}{f'(r)}\label{eq:1.21}
\end{equation}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:1.9"

\end_inset

估计 
\begin_inset Formula $P(x)=(x-1)(x-2)(x-3)(x-4)(x-5)(x-6)-10^{-6}x^{7}$
\end_inset

 的最大根。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
对于一个一般算法生成的近似 
\begin_inset Formula $x_{a}$
\end_inset

，我们定义它的
\begin_inset Formula 
\[
\text{误差放大因子}=\frac{\text{相对前向误差}}{\text{相对后向误差}}
\]

\end_inset

前向误差指的是解的变化，该变化可以使得 
\begin_inset Formula $x_{a}$
\end_inset

 准确，在根求解问题中前向误差对应 
\begin_inset Formula $\abs{x_{a}-r}$
\end_inset

，后向误差指的是输入中的变化，该变化使得 
\begin_inset Formula $x_{a}$
\end_inset

 是正确的解。对于前向误差和后向误差有大量可以选择的方式，这依赖于我们想探索哪一种敏感性。用 
\begin_inset Formula $\abs{f(x_{a})}$
\end_inset

 改变常数项是一种选择，并在这一界的前面使用过，在敏感公式
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.21"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中对应于 
\begin_inset Formula $g(x)=1$
\end_inset

 的项。更一般地，任何输入数据的变化都可以用于后向误差，诸如在例1.9中选择 
\begin_inset Formula $g(x)=x^{7}$
\end_inset

。在求解根过程中的误差放大因子如下
\begin_inset Formula 
\begin{equation}
\text{误差放大因子}=\abs{\frac{\Delta r/r}{\varepsilon g(r)/g(r)}}=\abs{\frac{-\varepsilon g(r)/\left(rf'(r)\right)}{\varepsilon}}=\frac{\abs{g(r)}}{\abs{rf'(r)}}\label{eq:1.22}
\end{equation}

\end_inset

其中在 
\begin_inset CommandInset ref
LatexCommand eqref
reference "exa:1.9"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中为 
\begin_inset Formula $6^{7}/(5!6)=388.8$
\end_inset

。
\end_layout

\begin_layout Standard
用根的敏感公式，研究在威尔金森多项式中，
\begin_inset Formula $x^{15}$
\end_inset

项中的变化对于根 
\begin_inset Formula $r=16$
\end_inset

的影响。并对这个问题找出误差放大因子。
\begin_inset Formula 
\begin{equation}
\Delta r\approx\frac{16^{15}1\,672\,280\,820\varepsilon}{15!4!}\approx6.1432\times10^{13}\varepsilon\label{eq:1.23}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
条件：这是 
\series bold
条件数
\series default
 第一次出现，条件数 也是误差放大度量的一种方式。数值分析是对算法的研究，算法把定义问题的数据作为输入，对应地结果作为输出。条件数指的是理论问题本身所带来的误差
放大部分，和用于求解问题的特定算法无关。
\end_layout

\begin_layout Plain Layout
注意到条件数仅仅度量由于问题本身带来的误差放大，这点很重要。和条件一起，还有一个平行概念，即 
\series bold
稳定
\series default
，稳定指的是由于算法小的输入误差造成的放大，而不是问题本身。如果一个算法在小的后向误差存在的时候，总能给出一个近似解，则称该算法是稳定的。如果问题的条件好，算法
稳定，我们可以期望同时具有小的后向误差和前向误差。
\end_layout

\end_inset


\end_layout

\begin_layout Standard
前面的误差放大例子表明根求解过程对于特定的输入变化的敏感性。问题可能或多或少地敏感，依赖于如何设计输入的变化。问题的 
\series bold
条件数
\series default
 定义为所有输入变化，或者至少规定类型的变化所造成地最大误差放大。条件数高的问题称为 
\series bold
病态
\series default
 问题，条件数在 
\begin_inset Formula $1$
\end_inset

 附近的问题称为 
\series bold
良态
\series default
 问题。在第2章中讨论矩阵问题时，我们将返回这个问题。
\end_layout

\begin_layout Section
牛顿方法
\begin_inset CommandInset label
LatexCommand label
name "sec:1.4"

\end_inset


\end_layout

\begin_layout Standard
牛顿方法，也被称为 牛顿–拉夫逊方法，通常比我们看到的线性收敛方法快得多。
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
f[x_] := -2 (x + 1) (x - 2); tef = Plot[{ f[x], f[-1/2] + (D[f[
\backslash
[Xi]], 
\backslash
[Xi]] /.
 {
\backslash
[Xi] -> -1/2}) (x + 1/2) }, {x, -2, 2} , PlotRange -> {{-1.5, 0.2}, {-1.5,
 5}}, AxesOrigin -> {0, 0}, AxesLabel -> {"x", "y"}, ImageSize -> Small];
 Show[{tef, Graphics[{ PointSize -> 0.05, Point[{-0.5, f[-0.5]}], Text["
\backslash
!
\backslash
(
\backslash
*SubscriptBox[
\backslash
(x
\backslash
), 
\backslash
(0
\backslash
)]
\backslash
)", {-0.5, 0.5}], Text["
\backslash
!
\backslash
(
\backslash
*SubscriptBox[
\backslash
(x
\backslash
), 
\backslash
(1
\backslash
)]
\backslash
)", {-1.1, 0.8}] }] }]
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename inset/cs-f1.8.pdf
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
牛顿方法中的第一步，从 
\begin_inset Formula $x_{0}$
\end_inset

开始，画出函数 
\begin_inset Formula $y=f(x)$
\end_inset

的切线。和 
\begin_inset Formula $x$
\end_inset

 轴的交点记作 
\begin_inset Formula $x_{1}$
\end_inset

，这是对于函数根的下一个近似。
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
从几何图像中可以推导出牛顿方法的公式。切线的斜率方程是
\begin_inset Formula 
\[
y-f(x_{0})=f'(x_{0})\left(x-x_{0}\right),
\]

\end_inset

因而它与
\begin_inset Formula $x$
\end_inset

 轴的交点为：
\begin_inset Formula 
\[
x=x_{0}-\frac{f(x_{0})}{f'(x_{0})}.
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
牛顿方法
\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{align*}
 & x_{0}=\text{初始估计}\\
 & x_{i+1}=x_{i}-\frac{f(x_{i})}{f'(x_{i})},\quad i=0,1,2,\cdots
\end{align*}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:1.11"

\end_inset

找出用于方程 
\begin_inset Formula $x^{3}+x-1=0$
\end_inset

 的牛顿方法公式。
\begin_inset Formula 
\[
x_{i+1}=x_{i}-\frac{x_{i}^{3}+x_{i}-1}{3x_{i}^{2}+1}=\frac{2x_{i}^{3}+1}{3x_{i}^{2}+1}
\]

\end_inset


\end_layout

\begin_layout Example
一旦确定收敛，
\begin_inset Formula $x_{i}$
\end_inset

中正确的数位在每一步中近似翻倍。我们在后面会看到，这就是“二次收敛”方法的一个特征。
\end_layout

\begin_layout Subsection
牛顿方法的二次收敛
\end_layout

\begin_layout Standard
\begin_inset CommandInset ref
LatexCommand eqref
reference "exa:1.11"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中的二次收敛，比我们前面在二分法和不动点迭代中看到的线性收敛速度要快。现在需要如下一个新的定义。
\end_layout

\begin_layout Definition
\begin_inset CommandInset label
LatexCommand label
name "def:1.10"

\end_inset

令 
\begin_inset Formula $e_{i}$
\end_inset

表示一个迭代方法第
\begin_inset Formula $i$
\end_inset

步后得到的误差。该迭代是 
\series bold
二次收敛
\series default
，如果满足下式
\begin_inset Formula 
\[
M=\lim_{i\to\infty}\frac{e_{i+1}}{e_{i}^{2}}<\infty
\]

\end_inset


\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:1.11"

\end_inset

令 
\begin_inset Formula $f$
\end_inset

 是二阶连续可微函数，
\begin_inset Formula $f(r)=0$
\end_inset

。如果 
\begin_inset Formula $f'(r)\neq0$
\end_inset

，则牛顿方法局部二次收敛到
\begin_inset Formula $r$
\end_inset

。第
\begin_inset Formula $i$
\end_inset

步的误差
\begin_inset Formula $e_{i}$
\end_inset

满足
\begin_inset Formula 
\[
\lim_{i\to\infty}\frac{e_{i+1}}{e_{i}^{2}}=M=\frac{f''(r)}{2f'(r)}.
\]

\end_inset


\end_layout

\begin_layout Standard
使用泰勒展开可以证明，
\begin_inset Formula 
\begin{equation}
e_{i+1}=e_{i}^{2}\abs{\frac{f''(c_{i})}{2f'(x_{i})}}\label{eq:1.24}
\end{equation}

\end_inset

或者写成
\begin_inset Formula 
\begin{equation}
e_{i+1}\approx e_{i}^{2}M\label{eq:1.25}
\end{equation}

\end_inset

而线性误差的收敛行为是
\begin_inset Formula 
\[
e_{i+1}=e_{i}S
\]

\end_inset

FPI方法中 
\begin_inset Formula $S=\abs{g'(r)}$
\end_inset

，二分法中 
\begin_inset Formula $S=1/2$
\end_inset

。尽管 
\begin_inset Formula $S$
\end_inset

 的值对于线性收敛方法很关键，但是 
\begin_inset Formula $M$
\end_inset

 的值并不是那么重要，这是由于误差公式中包含了上一步误差的平方。一旦误差远小于
\begin_inset Formula $1$
\end_inset

，平方会带来进一步的减小；只要
\begin_inset Formula $M$
\end_inset

不是太大，根据
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.25"
plural "false"
caps "false"
noprefix "false"

\end_inset

 可知，误差也会进一步下降。
\end_layout

\begin_layout Standard
例如对于平方根计算，令 
\begin_inset Formula $f(x)=x^{2}-a$
\end_inset

。对于任意
\begin_inset Formula $a$
\end_inset

，迭代如下
\begin_inset Formula 
\begin{equation}
x_{i+1}=x_{i}-\frac{f(x_{i})}{f'(x_{i})}=x_{i}-\frac{x_{i}^{2}-a}{2x_{i}}=\frac{x_{i}+\frac{a}{x_{i}}}{2}.\label{eq:1.26}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
牛顿方法的线性收敛
\end_layout

\begin_layout Standard
定理
\begin_inset CommandInset ref
LatexCommand eqref
reference "thm:1.11"
plural "false"
caps "false"
noprefix "false"

\end_inset

 并不意味着牛顿方法总能二次收敛。因为公式中需要除去 
\begin_inset Formula $f'(x)$
\end_inset

 得到二次收敛。这个假设十分重要。下面的例子展示了牛顿法不能二次收敛的例子。
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:1.12"

\end_inset

使用牛顿方法找到 
\begin_inset Formula $f(x)=x^{2}$
\end_inset

的实根。
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
x_{i+1}=x_{i}-\frac{f(x_{i})}{f'(x_{i})}=x_{i}-\frac{x_{i}^{2}}{2x_{i}}=\frac{x_{i}}{2}
\]

\end_inset

令人惊讶的是，牛顿法被简化到仅仅每步除以
\begin_inset Formula $2$
\end_inset

。线性收敛到
\begin_inset Formula $r=0$
\end_inset

，收敛速度和常数 
\begin_inset Formula $S=1/2$
\end_inset

 成比例。
\end_layout

\begin_layout Standard
对于 
\begin_inset Formula $x^{m}$
\end_inset

也有类似地结果，其中 
\begin_inset Formula $m$
\end_inset

 是正整数，如下面例子所示。
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:1.13"

\end_inset

使用牛顿法寻找 
\begin_inset Formula $f(x)=x^{m}$
\end_inset

 的一个根。
\end_layout

\begin_layout Example
牛顿公式如下：
\begin_inset Formula 
\[
x_{i+1}=x_{i}-\frac{x_{i}^{m}}{mx_{i}^{m-1}}=\frac{m-1}{m}x_{i}
\]

\end_inset

唯一根为 
\begin_inset Formula $r=0$
\end_inset

，因而定义 
\begin_inset Formula $e_{i}=\abs{x_{i}-r}=x_{i}$
\end_inset

得到
\begin_inset Formula 
\[
e_{i+1}=Se_{i}
\]

\end_inset

其中 
\begin_inset Formula $S=(m-1)/m$
\end_inset

。
\end_layout

\begin_layout Example
这是 牛顿法在多重根上一般情形的例子。注意到多重根定义
\begin_inset CommandInset ref
LatexCommand eqref
reference "def:1.9"
plural "false"
caps "false"
noprefix "false"

\end_inset

 和 
\begin_inset Formula $f(r)=f'(r)=0$
\end_inset

 等价。正好在这种情况下，牛顿法的误差公式中的导数失去了效力。对于多重根有不同的误差公式，我们已经见到的单项式的多重根模式代表了一般情况，下面的定理
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "thm:1.12"
plural "false"
caps "false"
noprefix "false"

\end_inset

 对此进行总结。
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:1.12"

\end_inset

假设在区间 
\begin_inset Formula $[a,b]$
\end_inset

 上，
\begin_inset Formula $(m+1)$
\end_inset

 阶连续可微函数 
\begin_inset Formula $f$
\end_inset

 在
\begin_inset Formula $r$
\end_inset

 点有一个
\begin_inset Formula $m$
\end_inset

阶多重根，则牛顿方法局部收敛到
\begin_inset Formula $r$
\end_inset

，第
\begin_inset Formula $i$
\end_inset

步误差
\begin_inset Formula $e_{i}$
\end_inset

满足
\begin_inset Formula 
\begin{equation}
\lim_{i\to\infty}\frac{e_{i+1}}{e_{i}}=S=\frac{m-1}{m}\label{eq:1.29}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:1.13"

\end_inset

如果在 
\begin_inset Formula $[a,b]$
\end_inset

 区间上 
\begin_inset Formula $f$
\end_inset

 是 
\begin_inset Formula $(m+1)$
\end_inset

 阶连续函数，包含 
\begin_inset Formula $m>1$
\end_inset

 的多重根，则 
\series bold
改进的牛顿方法
\series default

\begin_inset Formula 
\begin{equation}
x_{i+1}=x_{i}-\frac{mf(x_{i})}{f'(x_{i})}\label{eq:1.32}
\end{equation}

\end_inset

收敛到
\begin_inset Formula $r$
\end_inset

，并具有二次收敛速度。
\end_layout

\begin_layout Standard
之前的迭代公式为
\begin_inset Formula 
\[
x_{i+1}=x_{i}-\frac{x_{i}^{m}}{mx_{i}^{m-1}}=\frac{m-1}{m}x_{i}
\]

\end_inset


\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:1.15"

\end_inset

牛顿方法如同 FPI，可能不会收敛到根。例如，对函数 
\begin_inset Formula $f(x)=4x^{4}-6x^{2}-11/4$
\end_inset

 使用牛顿方法，初始估计 
\begin_inset Formula $x_{0}=1/2$
\end_inset

。
\end_layout

\begin_layout Standard
由于函数是连续函数，在 
\begin_inset Formula $x=0$
\end_inset

 时取负值，并且对于 
\begin_inset Formula $x$
\end_inset

 的大正数和大负数则取无穷大的正值，因此一定存在根。但是如图1.10所示，对于初始估计 
\begin_inset Formula $x_{0}=1/2$
\end_inset

 则找不到根。牛顿公式
\begin_inset Formula 
\begin{equation}
x_{i+1}=x_{i}-\frac{4x_{i}^{4}-6x_{i}^{2}-\frac{11}{4}}{16x_{i}^{3}-12x_{i}}\label{eq:1.33}
\end{equation}

\end_inset

 通过迭代得到 
\begin_inset Formula $x_{1}=-1/2$
\end_inset

，进一步 
\begin_inset Formula $x_{2}=1/2$
\end_inset

。牛顿法在这个例子中，迭代的结果在 
\begin_inset Formula $1/2$
\end_inset

 和 
\begin_inset Formula $-1/2$
\end_inset

 之间变化，但二者都不是根，所以求解根的过程失败。
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
f[x_] := 4 x^4 - 6 x^2 - 11/4; line[f_, x0_][x_] := f[x0] + Derivative[1][f]@x0*
(x - x0); tef = Plot[{ f[x], line[f, 1/2][x], line[f, -1/2][x] } , {x, -3,
 3} , AxesOrigin -> {0, 0} , AxesLabel -> {"x", "y"} , AspectRatio -> Automatic
 , PlotRange -> {Automatic, {-5, 1}} , PlotStyle -> {Dashing[{}], Dashed,
 Dashed} , ImageSize -> Small ]
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename inset/cs-f1.10.pdf
	lyxscale 50
	scale 45

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
例
\begin_inset CommandInset ref
LatexCommand eqref
reference "exa:1.15"
plural "false"
caps "false"
noprefix "false"

\end_inset

中牛顿法求解失败。迭代在
\begin_inset Formula $1/2$
\end_inset

和
\begin_inset Formula $-1/2$
\end_inset

之间变化，并不能收敛到根。
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
牛顿法还有其他可能失败的方式。如果在任何迭代中出现 
\begin_inset Formula $f'(x_{i})=0$
\end_inset

，显然该方法就不能继续。还有其他的例子中迭代会发散到无穷（习题6）或者模仿随机数生成（编程问题13）。尽管不是所有的初始值都会收敛到根，Thm
\begin_inset CommandInset ref
LatexCommand eqref
reference "thm:1.11"
plural "false"
caps "false"
noprefix "false"

\end_inset

 和 Thm
\begin_inset CommandInset ref
LatexCommand eqref
reference "thm:1.12"
plural "false"
caps "false"
noprefix "false"

\end_inset

 保证在每个根近邻中的初始估计收敛到根。
\end_layout

\begin_layout Section
不需要导数的根求解
\end_layout

\begin_layout Subsection
割线方法及其变体
\end_layout

\begin_layout Subsection
Brent方法
\end_layout

\begin_layout Standard
给定 
\begin_inset Formula $a,b,c$
\end_inset

，对下一个点的估计是：
\begin_inset Formula 
\[
x=b+\frac{P}{Q}
\]

\end_inset

其中
\begin_inset Formula 
\begin{align*}
 & P=s\,t(r-t)(c-b)-s(1-r)(b-a)\\
 & Q=(t-1)(r-1)(s-1)
\end{align*}

\end_inset

其中 
\begin_inset Formula 
\[
r\equiv\frac{f(b)}{f(c)},\quad s\equiv\frac{f(b)}{f(a)},\quad t\equiv\frac{f(a)}{f(c)}
\]

\end_inset

当 
\begin_inset Formula $a\to c$
\end_inset

 时，公式退化成割线方法
\begin_inset Formula 
\begin{align*}
 & P=s(b-a),\quad Q=1-s\\
 & x=b+\frac{s(b-a)}{1-s}=b-\frac{f_{b}(b-a)}{f_{b}-f_{a}}
\end{align*}

\end_inset


\begin_inset Formula 
\[
P=\frac{\left(c-b\right)\left[f_{a}\left(f_{b}-f_{a}\right)\right]-\left(b-a\right)\left[f_{c}\left(f_{c}-f_{b}\right)\right]}{f_{c}^{2}}
\]

\end_inset

其中
\end_layout

\begin_layout Itemize
区间左右边界是 
\begin_inset Formula $[b,c]$
\end_inset

 or 
\begin_inset Formula $[c,b]$
\end_inset

。
\end_layout

\begin_layout Itemize
\begin_inset Formula $b$
\end_inset

 是最新且最优估计，
\begin_inset Formula $a$
\end_inset

 是上次最优估计，
\begin_inset Formula $c$
\end_inset

 是之前某次的估计值；
\begin_inset Formula $c$
\end_inset

的缩减不会优于
\begin_inset Formula $a$
\end_inset

。
\end_layout

\begin_layout Itemize
如果
\begin_inset Formula $b$
\end_inset

跳到和
\begin_inset Formula $c$
\end_inset

同侧，则令
\begin_inset Formula $c$
\end_inset

跳到
\begin_inset Formula $b$
\end_inset

原先的位置，区间收缩。
\begin_inset Formula $a,c$
\end_inset

 重合，退化到截线。
\end_layout

\begin_layout Itemize
如果 
\begin_inset Formula $b$
\end_inset

 的BackErr 增大，则令
\begin_inset Formula $b$
\end_inset

回溯到
\begin_inset Formula $c$
\end_inset

；
\begin_inset Formula $a$
\end_inset

，
\begin_inset Formula $c$
\end_inset

 使用新的
\begin_inset Formula $b$
\end_inset

位置，区间收缩。
\begin_inset Formula $a,c$
\end_inset

 重合，退化到截线。
\end_layout

\begin_layout Standard
综上所述，
\begin_inset Formula $\abs{b-a}\le\abs{c-b}$
\end_inset

，因为
\begin_inset Formula $a$
\end_inset

位于
\begin_inset Formula $[b,c]$
\end_inset

之间，顶多和
\begin_inset Formula $c$
\end_inset

重合。类似地，
\begin_inset Formula $\abs{f_{c}}$
\end_inset

 不会优于
\begin_inset Formula $\abs{f_{a}}$
\end_inset

，最多相等。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename inset/IOI1.pdf
	lyxscale 80
	scale 45

\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
fn1[x_] := Sqrt[x - 1]; fn2[x_] := -Sqrt[x - 1]; p1 = {x1 = 1.5, fn2[x1]};
 p2 = {x2 = 1.2, fn1[x2]}; p3 = {x3 = 1.33, fn1[x3]}; p4 = {1, 0}; fig1 =
 Graphics[{ PointSize[Large], Red, Point[{p1, p2, p3}], Text[Style["c",
 Large, Bold, Blue], p1 + 0.04], Text[Style["b", Large, Bold, Blue], p2 -
 0.04], Text[Style["a", Large, Bold, Blue], p3 + 0.03], Text[Style["b
\backslash
[Prime]", Large, Bold, Blue], p4 + {-0.03, 0.08}] } , Frame -> All]; fig2
 = Plot[{Sqrt[x - 1], -Sqrt[x - 1]}, {x, 0, 1.6}, PlotRange -> {{0.9, 1.6},
 Automatic}]; Show[fig2, fig1, PlotRange -> All, ImageSize -> Medium]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
IOI 失效示例
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
在一些特殊情况下，IOI可能给出失败的估计。如图所示，设根所在的区间为 
\begin_inset Formula $b$
\end_inset

，
\begin_inset Formula $c$
\end_inset

；令IOI的初始点为 
\begin_inset Formula $a,b,c$
\end_inset

，其中
\begin_inset Formula $a$
\end_inset

是上上次估计；然而下一步的估计
\begin_inset Formula $b'$
\end_inset

 位于
\begin_inset Formula $(1,0)$
\end_inset

，跳到了根区间之外。 
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset listings
lstparams "language={[GNU]C++},basicstyle={\ttfamily},tabsize=4,keywordstyle={\bfseries\color{Blue}}"
inline false
status open

\begin_layout Plain Layout

if (P>0)
\end_layout

\begin_layout Plain Layout

{
\end_layout

\begin_layout Plain Layout

	Q=-Q;
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

P=std::fabs(P);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

min1=1.5*(c-b)*Q-std::fabs(tol1*q);
\end_layout

\begin_layout Plain Layout

min2=std::fabs(sect_old*Q);
\end_layout

\begin_layout Plain Layout

min=min1<min2?min1:min2;
\end_layout

\begin_layout Plain Layout

...
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

if(2.0 * P < min)
\end_layout

\begin_layout Plain Layout

//Accept interpolation
\end_layout

\begin_layout Plain Layout

{
\end_layout

\begin_layout Plain Layout

...
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

else
\end_layout

\begin_layout Plain Layout

//Interpolation failed, use bisection
\end_layout

\begin_layout Plain Layout

{
\end_layout

\begin_layout Plain Layout

...
\end_layout

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
考察修正的符号
\begin_inset CommandInset label
LatexCommand label
name "alg:alg1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
由于
\begin_inset Formula $b=b+P/Q$
\end_inset

，正常情况下，我们期望
\begin_inset Formula $b$
\end_inset

朝
\begin_inset Formula $c$
\end_inset

前进，也就是
\begin_inset Formula $\Delta b$
\end_inset

与
\begin_inset Formula $c-b$
\end_inset

 同号。程序
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:alg1"
plural "false"
caps "false"
noprefix "false"

\end_inset

中，通过符号转移算法把
\begin_inset Formula $P/Q$
\end_inset

的符号转移到
\begin_inset Formula $Q$
\end_inset

上，然后设定区间收敛阈值为
\begin_inset Formula 
\[
\mathrm{min1}=\frac{3}{2}\left(c-b\right)*Q-\mathrm{tol}_{1}
\]

\end_inset

如果
\begin_inset Formula $(c-b)$
\end_inset

 和 
\begin_inset Formula $Q$
\end_inset

 符号一致，则
\begin_inset Formula $\mathrm{min1}>0$
\end_inset

，if 语句可能通过。如果
\begin_inset Formula $(c-b)$
\end_inset

 和 
\begin_inset Formula $Q$
\end_inset

 符号不一致，则由于
\begin_inset Formula $P>0$
\end_inset

，if 语句一定失败，进入BiSection 分支。如此也就避免了
\begin_inset Formula $b$
\end_inset

跳出根区间。
\end_layout

\begin_layout Chapter
方程组
\end_layout

\begin_layout Section
高斯消去法
\end_layout

\begin_layout Section
LU分解
\end_layout

\begin_layout Section
误差来源
\end_layout

\begin_layout Subsection
误差放大和条件数
\end_layout

\begin_layout Definition
令
\begin_inset Formula $x_{a}$
\end_inset

是线性方程组
\begin_inset Formula $Ax=b$
\end_inset

的近似解。
\series bold
余项
\series default
 是向量
\begin_inset Formula $r=b-Ax_{a}$
\end_inset

，
\series bold
后向误差
\series default
 是余项的范数 
\begin_inset Formula $\left\Vert b-Ax_{a}\right\Vert _{\infty}$
\end_inset

，
\series bold
前向误差
\series default
 是 
\begin_inset Formula $\left\Vert x-x_{a}\right\Vert _{\infty}$
\end_inset

。
\end_layout

\begin_layout Definition
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Definition
\begin_inset Argument 1
status open

\begin_layout Plain Layout
条件
\end_layout

\end_inset

 条件数的概念贯穿整个数值分析。在第1章讨论威尔金森多项式时，我们知道当给方程 
\begin_inset Formula $f(x)=0$
\end_inset

 一个小的扰动，如何求 “解根过程” 的误差放大因子。对于矩阵方程 
\begin_inset Formula $Ax=b$
\end_inset

，也有相似的误差放大因子，最大可能的放大因子是 
\begin_inset Formula $\text{cond}(A)=\lVert A\rVert\,\lVert A^{-1}\rVert$
\end_inset

。
\end_layout

\end_inset


\end_layout

\begin_layout Standard
方程 
\begin_inset Formula $Ax=b$
\end_inset

 的误差放大因子是二者的比率，或者
\begin_inset Formula 
\begin{equation}
\text{误差放大因子}=\frac{\text{相对前向误差}}{\text{相\text{对后向误差}}}=\frac{\frac{\left\Vert x-x_{a}\right\Vert _{\infty}}{\left\Vert x\right\Vert _{\infty}}}{\frac{\left\Vert r\right\Vert _{\infty}}{\left\Vert b\right\Vert _{\infty}}}\label{eq:2.18}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
在第1章中，我们定义条件数的概念，条件数对应在预先定义的输入误差范围中最大的误差放大倍数。“与定义范围”依赖于上下文。现在我们对于求解线性方程组系统将更精确定义
这个概念。对于一个固定的矩阵
\begin_inset Formula $A$
\end_inset

，考虑对不同向量
\begin_inset Formula $b$
\end_inset

求解
\begin_inset Formula $Ax=b$
\end_inset

。在这个上下文中，
\begin_inset Formula $b$
\end_inset

是输入，对应的解
\begin_inset Formula $x$
\end_inset

是输出。输入中小的变化对应
\begin_inset Formula $b$
\end_inset

的小变化，这对应一个误差放大因子。我们做如下定义：
\end_layout

\begin_layout Definition
方阵
\begin_inset Formula $A$
\end_inset

的 
\series bold
条件数
\series default
 
\begin_inset Formula $\text{cond}(A)$
\end_inset

为求解
\begin_inset Formula $Ax=b$
\end_inset

时，对于所有右侧向量
\begin_inset Formula $b$
\end_inset

，可能出现的最大误差放大因子。
\end_layout

\begin_layout Definition
令人惊讶的是，对于矩阵有一个关于条件数的紧致的公式。和向量范数类似，定义
\begin_inset Formula $n\times n$
\end_inset

矩阵
\begin_inset Formula $A$
\end_inset

的 
\series bold
矩阵范数
\series default
 为
\begin_inset Formula 
\begin{equation}
\lVert A\rVert_{\infty}=\text{每行元素绝对值之和的最大值}\label{eq:2.19}
\end{equation}

\end_inset


\end_layout

\begin_layout Theorem
\begin_inset Formula $n\times n$
\end_inset

矩阵
\begin_inset Formula $A$
\end_inset

 的条件数是
\begin_inset Formula 
\[
\text{cond}(A)=\lVert A\rVert\cdot\lVert A^{-1}\rVert
\]

\end_inset

 
\end_layout

\begin_layout Section
PA=LU分解
\end_layout

\begin_layout Section
迭代方法
\end_layout

\begin_layout Standard
p94/109; page 27/42
\end_layout

\begin_layout Subsection
雅可比方法
\end_layout

\begin_layout Definition
\begin_inset Argument 1
status open

\begin_layout Plain Layout
2.9
\end_layout

\end_inset


\begin_inset Formula $n\times n$
\end_inset

的矩阵
\begin_inset Formula $A=(a_{ij})$
\end_inset

 是
\series bold
严格对角占优矩阵
\series default
，要求对于每个
\begin_inset Formula $1\le i\le n$
\end_inset

，
\begin_inset Formula $\abs{a_{ii}}>\sum_{j\neq i}\abs{a_{ij}}$
\end_inset

。换句话说，对角线元素在对应行占优，其对应值在数量上比该行其他元素的和还要大。
\end_layout

\begin_layout Theorem
\begin_inset Argument 1
status open

\begin_layout Plain Layout
2.10
\end_layout

\end_inset

如果
\begin_inset Formula $n\times n$
\end_inset

矩阵
\begin_inset Formula $A$
\end_inset

是严格对角占优矩阵，则（1）
\begin_inset Formula $A$
\end_inset

是非奇异矩阵，（2）对于所有向量
\begin_inset Formula $b$
\end_inset

和初始估计，对
\begin_inset Formula $Ax=b$
\end_inset

应用雅可比方法都会收敛到（唯一）解。
\end_layout

\begin_layout Section
用于对称正定矩阵的方法
\end_layout

\begin_layout Subsection
对称正定矩阵
\end_layout

\begin_layout Definition
如果 
\begin_inset Formula $A^{T}=A$
\end_inset

，则
\begin_inset Formula $n\times n$
\end_inset

 矩阵
\begin_inset Formula $A$
\end_inset

是 
\series bold
对称矩阵
\series default
。如果对于所有向量
\begin_inset Formula $x\neq0$
\end_inset

，
\begin_inset Formula $x^{T}Ax>0$
\end_inset

，则矩阵
\begin_inset Formula $A$
\end_inset

是 
\series bold
正定矩阵
\series default
。 
\end_layout

\begin_layout Corollary
如果
\begin_inset Formula $n\times n$
\end_inset

矩阵
\begin_inset Formula $A$
\end_inset

是对称矩阵，则
\begin_inset Formula $A$
\end_inset

是正定矩阵，当且仅当所有特征值是正数。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Corollary
如果
\begin_inset Formula $n\times n$
\end_inset

矩阵
\begin_inset Formula $A$
\end_inset

是对称矩阵，
\begin_inset Formula $X$
\end_inset

是一个满秩
\begin_inset Formula $n\times m$
\end_inset

矩阵，
\begin_inset Formula $n\ge m$
\end_inset

，则
\begin_inset Formula $X^{T}AX$
\end_inset

是
\begin_inset Formula $m\times m$
\end_inset

对称正定矩阵。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Definition
方阵
\begin_inset Formula $A$
\end_inset

 的主子矩阵是一个方的子矩阵，其对角线元素是矩阵
\begin_inset Formula $A$
\end_inset

的对角线元素。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Corollary
任何对称正定矩阵的主子矩阵也是对称正定矩阵。
\end_layout

\begin_layout Standard
这说明对称正定矩阵的 对角线元素都是正数。
\end_layout

\begin_layout Subsection
楚列斯基分解
\end_layout

\begin_layout Subsection
共轭梯度方法
\end_layout

\begin_layout Standard
数值分析 page112。
\begin_inset Formula 
\begin{align*}
 & x_{0}=\text{初始估计}\\
 & d_{0}=r_{0}=b-A.x_{0}
\end{align*}

\end_inset

对于
\begin_inset Formula $k=0,1,2,\cdots,n-1$
\end_inset

：
\begin_inset Formula 
\begin{align}
 & \alpha_{k}=\frac{r_{k}^{T}\,r_{k}}{d_{k}^{T}Ad_{k}}\label{eq:t2.16a}\\
 & \sbf x_{k+1}=\sbf x_{k}+\alpha_{k}\,\sbf d_{k}\label{eq:t2.16b}\\
 & \sbf r_{k+1}=\sbf r_{k}-\alpha_{k}A\,\sbf d_{k}\label{eq:t2.16c}\\
 & \beta_{k}=\frac{r_{k+1}^{T}\,r_{k+1}}{r_{k}^{T}\,r_{k}}\label{eq:t2.16d}\\
 & \sbf d_{k+1}=\sbf r_{k+1}+\beta_{k}\sbf d_{k}\label{eq:t2.16e}
\end{align}

\end_inset

其中 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:t2.16b"
plural "false"
caps "false"
noprefix "false"

\end_inset

 通过选定的方向 
\begin_inset Formula $\sbf d_{k}$
\end_inset

 更新近似解 
\begin_inset Formula $x$
\end_inset

；
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:t2.16e"
plural "false"
caps "false"
noprefix "false"

\end_inset

 通过 残差 
\begin_inset Formula $\sbf r_{k+1}$
\end_inset

和旧方向
\begin_inset Formula $\sbf d_{k}$
\end_inset

构造新的下降方向 
\begin_inset Formula $\sbf d_{k+1}$
\end_inset

。为了保证新余项 
\begin_inset Formula $\sbf r_{k+1}$
\end_inset

和外面的所有余项向量都正交，需要精确选择 
\begin_inset Formula $\alpha_{k}$
\end_inset

 使得 
\color blue
新余项 
\begin_inset Formula $\sbf r_{k+1}$
\end_inset

和方向
\begin_inset Formula $\sbf d_{k}$
\end_inset


\color inherit
 正交。
\end_layout

\begin_layout Standard
在构造
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:t2.16e"
plural "false"
caps "false"
noprefix "false"

\end_inset

时是递归的；
\end_layout

\begin_layout Enumerate
朝新的方向
\begin_inset Formula $\sbf d_{k+1}$
\end_inset

下降引入新的残差
\begin_inset Formula $\sbf r_{k+1}$
\end_inset

，也就是说 
\begin_inset Formula $\sbf d_{k+1}$
\end_inset

 和 
\begin_inset Formula $\sbf r_{k+1}$
\end_inset

是相关的，
\begin_inset Formula 
\[
\sbf d_{k+1}=\theta\,\sbf r_{k+1}+\cdots
\]

\end_inset


\end_layout

\begin_layout Enumerate
然后假设
\begin_inset Formula $\{\sbf d_{0},\cdots,\sbf d_{k}\}$
\end_inset

 已经是两两
\begin_inset Formula $A$
\end_inset

共轭的：
\end_layout

\begin_deeper
\begin_layout Itemize
则
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:t2.16e"
plural "false"
caps "false"
noprefix "false"

\end_inset

中的 
\begin_inset Formula $\sbf d_{k}$
\end_inset

 项是和 
\begin_inset Formula $\sbf d_{j}$
\end_inset

（
\begin_inset Formula $j\le k-1$
\end_inset

） A 共轭的；
\end_layout

\begin_layout Itemize
\begin_inset Formula $\sbf r_{k+1}$
\end_inset

 和 
\begin_inset Formula $\sbf d_{j}$
\end_inset

（
\begin_inset Formula $j\le k-1$
\end_inset

）的
\begin_inset Formula $A$
\end_inset

 共轭性 通过
\begin_inset Formula $\{\sbf r\}$
\end_inset

的正交性保证，代入
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:t2.16c"
plural "false"
caps "false"
noprefix "false"

\end_inset


\begin_inset Formula 
\[
\sbf r_{k+1}A\sbf d_{j}=\sbf r_{k+1}\,\frac{\sbf r_{j}-\sbf r_{j+1}}{\alpha_{j}}
\]

\end_inset


\end_layout

\begin_layout Itemize
然后要保证 
\begin_inset Formula $\sbf d_{k+1}$
\end_inset

，
\begin_inset Formula $\sbf d_{k}$
\end_inset

是A 共轭的，这通过恰当选择 
\begin_inset Formula $\beta_{k}$
\end_inset

的值来实现（计算表明只需要一个参数
\begin_inset Formula $\beta_{k}$
\end_inset

）。
\begin_inset Formula 
\[
\sbf d_{k}\,A\,\sbf d_{k+1}=\frac{\sbf r_{k}^{T}-\sbf r_{k+1}^{T}}{\alpha_{k}}\,\sbf r_{k+1}+\beta_{k}\sbf d_{k}\,A\,\sbf d_{k}
\]

\end_inset

其中已知 
\begin_inset Formula $\sbf r_{k}^{T}\sbf r_{k+1}=0$
\end_inset

，若 
\begin_inset Formula $\sbf r_{k+1}^{T}\sbf r_{k+1}\neq0$
\end_inset

，则 
\begin_inset Formula $\beta_{k}$
\end_inset

 唯一确定；若
\begin_inset Formula $\sbf r_{k+1}^{T}\sbf r_{k+1}=0$
\end_inset

，则已经找到精确解。
\end_layout

\end_deeper
\begin_layout Theorem
\begin_inset Argument 1
status open

\begin_layout Plain Layout
定理2.16
\end_layout

\end_inset

令
\begin_inset Formula $A$
\end_inset

 为对称正定的
\begin_inset Formula $n\times n$
\end_inset

矩阵，
\begin_inset Formula $b\neq0$
\end_inset

是一个向量。在共轭梯度方法中，假设
\begin_inset Formula $r_{k}\neq0$
\end_inset

，其中
\begin_inset Formula $k<n$
\end_inset

（如果
\begin_inset Formula $r_{k}=0$
\end_inset

，方程已经求解）。则对于每个
\begin_inset Formula $k\in[1,n]$
\end_inset

：
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $R^{n}$
\end_inset

的下列三个子空间等价：
\begin_inset Formula 
\[
\langle x_{1},\cdots,x_{k}\rangle=\langle r_{0},\cdots,r_{k-1}\rangle=\langle d_{0},\cdots,d_{k-1}\rangle.
\]

\end_inset


\end_layout

\begin_layout Enumerate
余项
\begin_inset Formula $r_{k}$
\end_inset

两两正交 
\begin_inset Formula $r_{k}^{T}\,r_{j}=0$
\end_inset

，其中
\begin_inset Formula $j<k$
\end_inset

。
\end_layout

\begin_layout Enumerate
方向
\begin_inset Formula $d_{k}$
\end_inset

两两 A共轭 
\begin_inset Formula $d_{k}^{T}Ad_{j}=0$
\end_inset

，其中
\begin_inset Formula $j<k$
\end_inset

。
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Formula $x$
\end_inset

为近似解，
\begin_inset Formula $d$
\end_inset

为下降方向，
\begin_inset Formula $r$
\end_inset

为残差。对于
\begin_inset Formula $k=1$
\end_inset

，因为
\begin_inset Formula $x_{0}=0$
\end_inset

，所以到
\begin_inset Formula $\langle x_{1}\rangle=\langle d_{0}\rangle=\langle r_{0}\rangle$
\end_inset

。由定义知 
\begin_inset Formula $x_{k}=x_{k-1}+\alpha_{k-1}d_{k-1}$
\end_inset

，这意味着通过归纳
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\langle x_{1},\cdots,x_{k}\rangle=\langle d_{0},\cdots,d_{k-1}\rangle.
\]

\end_inset

相似地，利用 
\begin_inset Formula $d_{k}=r_{k}+\beta_{k-1}d_{k-1}$
\end_inset

，表明
\begin_inset Formula 
\[
\langle r_{0},\cdots,r_{k-1}\rangle=\langle d_{0},\cdots,d_{k-1}\rangle.
\]

\end_inset

这三个
\begin_inset Formula $R^{n}$
\end_inset

的子空间等价。
\end_layout

\begin_layout Standard
共轭梯度法的名字来自于共轭梯度法实际进行的操作：在
\begin_inset Formula $n$
\end_inset

维空间的二次抛物面的斜面上滑下来。名字中“梯度”表示通过微积分寻找最速下降的方向，“共轭”不是表示单个步骤和其他步正交，而是表示余项之间的正交性质。
\end_layout

\begin_layout Section
非线性方程组
\end_layout

\begin_layout Standard
本节中将描述牛顿方法及其变体，并用于求解非线性方程组。
\end_layout

\begin_layout Subsection
多元牛顿方法
\end_layout

\begin_layout Standard
单变量的牛顿方法
\begin_inset Formula 
\[
x_{k+1}=x_{k}-\frac{f(x_{k})}{f'(x_{k})}
\]

\end_inset

提供了多元牛顿方法的主要轮廓。两种方法都是根据泰勒展开的线性近似推导得到，例如令
\begin_inset Formula 
\begin{align}
 & f_{1}\left(u,v,w\right)=0\nonumber \\
 & f_{2}\left(u,v,w\right)=0\nonumber \\
 & f_{3}\left(u,v,w\right)=0\label{eq:2.49}
\end{align}

\end_inset

是三个非线性方程，具有三个未知变量
\begin_inset Formula $u$
\end_inset

、
\begin_inset Formula $v$
\end_inset

、
\begin_inset Formula $w$
\end_inset

 。定义向量值函数 
\begin_inset Formula 
\[
F(u,v,w)=\left(f_{1},f_{2},f_{3}\right),
\]

\end_inset

将
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:2.49"
plural "false"
caps "false"
noprefix "false"

\end_inset

中的问题表示为
\begin_inset Formula $F(x)=0$
\end_inset

，其中
\begin_inset Formula $x=(u,v,w)$
\end_inset

。
\end_layout

\begin_layout Standard
单变量情况下函数导数
\begin_inset Formula $f'$
\end_inset

 现在对应的是 
\series bold
雅可比矩阵
\series default
，定义为
\begin_inset Formula 
\[
D_{F}(x)=\left[\begin{array}{ccc}
\frac{\partial f_{1}}{\partial u} & \frac{\partial f_{1}}{\partial v} & \frac{\partial f_{1}}{\partial w}\\
\frac{\partial f_{2}}{\partial u} & \frac{\partial f_{2}}{\partial v} & \frac{\partial f_{2}}{\partial w}\\
\frac{\partial f_{3}}{\partial u} & \frac{\partial f_{3}}{\partial v} & \frac{\partial f_{3}}{\partial w}
\end{array}\right]
\]

\end_inset

在点
\begin_inset Formula $x_{0}$
\end_inset

附近的向量值函数的泰勒展开是
\begin_inset Formula 
\[
F(x)=F(x_{0})+D_{F}(x_{0})\cdot\left(x-x_{0}\right)+\order{x-x_{0}}^{2}
\]

\end_inset

例如在
\begin_inset Formula $x_{0}=(0,0)$
\end_inset

 附近的函数
\begin_inset Formula $F(u,v)=(e^{u+v},\sin u)$
\end_inset

 的线性展开是
\begin_inset Formula 
\[
F(x)=\left[\begin{array}{c}
1\\
0
\end{array}\right]+\left[\begin{array}{cc}
e^{0} & e^{0}\\
\cos0 & 0
\end{array}\right]\left[\begin{array}{c}
u\\
v
\end{array}\right]+\order{x^{2}}=\left[\begin{array}{c}
1\\
0
\end{array}\right]+\left[\begin{array}{c}
u+v\\
u
\end{array}\right]+\order{x^{2}}
\]

\end_inset

牛顿方法基于线性近似，忽略 
\begin_inset Formula $\order{x^{2}}$
\end_inset

项。正如在一维情况下，令
\begin_inset Formula $x=r$
\end_inset

是根，令
\begin_inset Formula $x_{0}$
\end_inset

是当前估计，则
\begin_inset Formula 
\[
0=F(r)\approx F(x_{0})+D_{F}(x_{0})\cdot(r-x_{0})
\]

\end_inset

 或者
\begin_inset Formula 
\begin{equation}
r-x_{0}\approx-D_{F}(x_{0})^{-1}F(x_{0})\label{eq:2.50}
\end{equation}

\end_inset

因而通过求解
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:2.50"
plural "false"
caps "false"
noprefix "false"

\end_inset

得到
\begin_inset Formula $r$
\end_inset

，可以对根进行更好的近似。（不动点迭代）。
\end_layout

\begin_layout Standard
\begin_inset Box ovalbox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
多变量牛顿方法
\begin_inset Formula 
\begin{align*}
x_{0} & =\text{初始向量}\\
x_{k+1} & =x_{k}-D_{F}(x_{k})^{-1}F(x_{k}),\quad k=0,1,2,\cdots
\end{align*}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
由于计算逆矩阵的代价很大，我们使用技巧避免该计算（通过计算
\begin_inset Formula $D_{F}(x_{k})^{-1}F(x_{k})$
\end_inset

 整体）。在每一步中，不是按上面描述的过程，而是令 
\begin_inset Formula $x_{k+1}=x_{k}-s$
\end_inset

，即令
\begin_inset Formula $s=D_{F}(x_{k})^{-1}F(x_{k})$
\end_inset

，因此
\begin_inset Formula $s$
\end_inset

是
\begin_inset Formula $D_{F}(x_{k})\,s=F(x_{k})$
\end_inset

 的解。现在，仅仅需要在每步中使用高斯消去（
\begin_inset Formula $n^{3}/3$
\end_inset

次的乘法），而不是计算矩阵的逆（相对于高斯消去大约
\begin_inset Formula $3$
\end_inset

倍的计算次数）。因而，对于多元牛顿方法的迭代步骤如下
\begin_inset Formula 
\begin{equation}
\begin{cases}
D_{F}(x_{k})\,s=-F(x_{k})\\
x_{k+1}=x_{k}+s
\end{cases}\label{eq:2.51}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
12.2 QR算法
\end_layout

\begin_layout Standard
Normalized Simultaneous Iteration（NSI）：不断地对 正交向量基作QR分解，每步中
\begin_inset Formula $Q$
\end_inset

的列向量都会被归一化。令
\begin_inset Formula $\overline{Q}_{0}=I$
\end_inset

，
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
A\overline{Q}_{0} & =\overline{Q}_{1}R_{1}\\
A\overline{Q}_{1} & =\overline{Q}_{2}R_{2}\\
A\overline{Q}_{2} & =\overline{Q}_{3}R_{3}\\
 & \vdots
\end{align*}

\end_inset

考虑相似的迭代 
\series bold
unshifted QR algorithm
\series default
：令
\begin_inset Formula $Q_{0}=I$
\end_inset

，
\begin_inset Formula 
\begin{align}
A_{0}\equiv AQ_{0} & =Q_{1}T_{1}\label{eq:12.8.0}\\
A_{1}\equiv T_{1}Q_{1} & =Q_{2}T_{2}\nonumber \\
A_{2}\equiv T_{2}Q_{2} & =Q_{3}T_{3}\nonumber \\
 & \vdots\nonumber 
\end{align}

\end_inset

基本的思想是，由于
\begin_inset Formula $Q$
\end_inset

矩阵为正交矩阵，是可逆的。
\begin_inset Formula $A=QR$
\end_inset

，所以
\begin_inset Formula $A$
\end_inset

和
\begin_inset Formula $R$
\end_inset

之间差一个可逆变换，因此用
\begin_inset Formula $R$
\end_inset

替代
\begin_inset Formula $A$
\end_inset

去迭代。对
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.8.0"
plural "false"
caps "false"
noprefix "false"

\end_inset

同乘系数得
\begin_inset Formula 
\begin{align}
AQ_{0} & =Q_{1}T_{1}\label{eq:12.8.1}\\
{\color{blue}Q_{1}}T_{1}\;Q_{1} & ={\color{blue}Q_{1}}Q_{2}T_{2}\label{eq:12.8.2}\\
{\color{blue}Q_{1}Q_{2}}T_{2}\;Q_{2} & ={\color{blue}Q_{1}Q_{2}}Q_{3}T_{3}\label{eq:12.8.3}\\
 & \vdots\nonumber 
\end{align}

\end_inset

注意观察第
\begin_inset Formula $j$
\end_inset

步的右侧式和第
\begin_inset Formula $j+1$
\end_inset

步的左侧式。将
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.8.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

代入
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.8.2"
plural "false"
caps "false"
noprefix "false"

\end_inset

的左侧式，得到
\begin_inset Formula 
\begin{equation}
AQ_{0}Q_{1}={\color{blue}Q_{1}}Q_{2}T_{2}\label{eq:12.8.4}
\end{equation}

\end_inset

将
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.8.4"
plural "false"
caps "false"
noprefix "false"

\end_inset

代入
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.8.3"
plural "false"
caps "false"
noprefix "false"

\end_inset

的左侧式，得到
\begin_inset Formula 
\[
AQ_{0}Q_{1}Q_{2}={\color{blue}Q_{1}Q_{2}}Q_{3}T_{3}
\]

\end_inset

类似地替换可以一直持续下去，得到
\begin_inset Formula 
\[
AQ_{0}\;{\color{blue}Q_{1}\cdots Q_{j-1}}={\color{blue}Q_{1}Q_{2}\cdots Q_{j-1}}\;Q_{j}T_{j}
\]

\end_inset

比较NSI的表达式
\begin_inset Formula $A\overline{Q}_{j-1}=\overline{Q}_{j}R_{j}$
\end_inset

 发现，可以选取
\begin_inset Formula 
\begin{align*}
\overline{Q}_{j-1} & =Q_{0}Q_{1}\cdots Q_{j-1}\\
\overline{Q}_{j} & =Q_{1}Q_{2}\cdots Q_{j}=Q_{0}^{-1}\,\overline{Q}_{j-1}\,Q_{j}
\end{align*}

\end_inset

因为通常选取
\begin_inset Formula $Q_{0}=I$
\end_inset

，则 
\begin_inset Formula $\overline{Q}_{j}=\overline{Q}_{j-1}\,Q_{j}$
\end_inset

。也就是说两种迭代的
\begin_inset Formula $Q$
\end_inset

矩阵，只相差累乘操作。无移动的QR算法和归一化同步迭代所进行的计算相同，只是在标记上略有不同。
\end_layout

\begin_layout Subsection
12.2.2 实数舒尔形式和QR算法
\end_layout

\begin_layout Definition
\begin_inset Argument 1
status open

\begin_layout Plain Layout
12.5
\end_layout

\end_inset

如果矩阵
\begin_inset Formula $T$
\end_inset

为上三角矩阵，除了在主对角线上可以出现
\begin_inset Formula $2\times2$
\end_inset

的块，该矩阵具有
\series bold
实数舒尔形式
\series default
。
\end_layout

\begin_layout Standard
例如，矩阵形式
\begin_inset Formula 
\[
\left[\begin{array}{ccccc}
x & x & x & x & x\\
 & x & x & x & x\\
 &  & x & x & x\\
 &  & x & x & x\\
 &  &  &  & x
\end{array}\right]
\]

\end_inset

是实舒尔形式。根据习题6，这种形式的矩阵特征值为对角块矩阵的特征值，这对应对角线元素（其对应的块为
\begin_inset Formula $1\times1$
\end_inset

），或者
\begin_inset Formula $2\times2$
\end_inset

块矩阵的特征值。不管是哪种形式，都可以快速计算矩阵的特征值。
\end_layout

\begin_layout Standard
矩阵的行列式为（对所有列指标求和）
\begin_inset Formula 
\[
\det[A]=\sum_{\{i,j,k,\cdots\}}A_{1i}\,A_{2j}\,A_{3k}\cdots
\]

\end_inset

上三角矩阵相当于要求元素
\begin_inset Formula $A_{ij}$
\end_inset

的下标
\begin_inset Formula $j\ge i$
\end_inset

，指标
\begin_inset Formula $\{i,j,k,\cdots\}$
\end_inset

 全部相同，从
\begin_inset Formula $A_{nn}$
\end_inset

开始逆序决定，指标唯一不为零的排列是
\begin_inset Formula $\{1,2,3,\cdots,n\}$
\end_inset

，对应对角线元素的乘积。
\end_layout

\begin_layout Standard
舒尔形式的矩阵，例如
\begin_inset Formula $2\times2$
\end_inset

块出现在
\begin_inset Formula $[a-1,a]$
\end_inset

的位置，相当于允许下列排列
\begin_inset Formula 
\begin{align}
\text{行指标：} & 1\cdots a-1,a\cdots n\nonumber \\
\text{列排序1：} & 1\cdots a-1,a\cdots n\label{eq:my20}\\
\text{列排序2：} & 1\cdots a,a-1\cdots n\label{eq:my21}
\end{align}

\end_inset

其中
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:my20"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:my21"
plural "false"
caps "false"
noprefix "false"

\end_inset

对应
\begin_inset Formula 
\[
\cdots A_{a-1,a-1}A_{a,a}\cdots-\cdots A_{a-1,a}A_{a,a-1}\cdots
\]

\end_inset

构成关于
\begin_inset Formula $[a-1,a]$
\end_inset

子矩阵的局部行列式，其他系数相同。所以实数舒尔形式矩阵的行列式是
\series bold
主对角块
\series default
行列式的乘积。如果
\begin_inset Formula $A$
\end_inset

是实舒尔形式，则
\begin_inset Formula $A-\lambda I$
\end_inset

 仍然是实舒尔形式，所以
\begin_inset Formula 
\[
\det\left[A-\lambda I\right]=\prod\det\left[\text{主对角块}\right]
\]

\end_inset

因此，实舒尔形式矩阵的特征值等价于主对角块的特征值。
\end_layout

\begin_layout Subsection
12.2.3上海森伯格形式(Upper Hessenberg from)
\end_layout

\begin_layout Theorem
\begin_inset Argument 1
status open

\begin_layout Plain Layout
12.8
\end_layout

\end_inset

令
\begin_inset Formula $A$
\end_inset

是一个仿真，存在正交矩阵
\begin_inset Formula $Q$
\end_inset

，满足
\begin_inset Formula $A=QBQ^{T}$
\end_inset

，并且
\begin_inset Formula $B$
\end_inset

是上海森伯格形式。
\end_layout

\begin_layout Standard
每部中对矩阵进行相似变换， 
\begin_inset Formula 
\begin{align*}
\left[\begin{array}{cc}
1 & 0\\
0 & H
\end{array}\right]\cdot\left[\begin{array}{cc}
A_{1} & A_{2}\\
{\color{blue}A_{4}} & {\color{blue}A_{3}}
\end{array}\right] & \Rightarrow\left[\begin{array}{cc}
A_{1} & A_{2}\\
{\color{blue}HA_{4}} & {\color{blue}HA_{3}}
\end{array}\right]\\
\left[\begin{array}{cc}
A_{1} & {\color{blue}A_{2}}\\
HA_{4} & {\color{blue}HA_{3}}
\end{array}\right]\cdot\left[\begin{array}{cc}
1 & 0\\
0 & H
\end{array}\right] & \Rightarrow\left[\begin{array}{cc}
A_{1} & {\color{blue}A_{2}H}\\
HA_{4} & {\color{blue}HA_{3}H}
\end{array}\right]
\end{align*}

\end_inset

其中
\begin_inset Formula $H$
\end_inset

是 House–Holder 矩阵。令
\begin_inset Formula $x$
\end_inset

和
\begin_inset Formula $w$
\end_inset

是向量，
\begin_inset Formula $\left\Vert x\right\Vert _{2}=\left\Vert w\right\Vert _{2}$
\end_inset

，并定义
\begin_inset Formula $v=w-x$
\end_inset

，则
\begin_inset Formula $H=I-2v\cdot v^{T}/(v^{T}\cdot v)$
\end_inset

 是对称正交矩阵，并且
\begin_inset Formula $Hx=w$
\end_inset

。
\begin_inset Formula 
\[
H^{-1}=H^{T}=H.
\]

\end_inset


\end_layout

\begin_layout Standard
对于
\begin_inset Formula $x$
\end_inset

，如果其目标向量为 
\begin_inset Formula $w=\left\Vert x\right\Vert _{2}(\pm1,0,\cdots)=N\,q_{1}$
\end_inset

，则
\begin_inset Formula 
\begin{align*}
 & v=N\,q_{1}-x=\left(-\sign(x_{1})N-x_{1},0,0,\cdots\right)\\
\end{align*}

\end_inset


\end_layout

\begin_layout Section
12.3 奇异值分解
\end_layout

\begin_layout Theorem
12.11 令
\begin_inset Formula $A$
\end_inset

是
\begin_inset Formula $m\times n$
\end_inset

矩阵，则存在两个正交基：
\begin_inset Formula $R^{n}$
\end_inset

的
\begin_inset Formula $\{v_{1},\cdots,v_{n}\}$
\end_inset

，与
\begin_inset Formula $R^{m}$
\end_inset

的
\begin_inset Formula $\{u_{1},\cdots,u_{m}\}$
\end_inset

，以及实数
\begin_inset Formula $s_{1}\ge s_{n}\ge0$
\end_inset

，满足
\begin_inset Formula $Av_{i}=s_{i}\,u_{i}$
\end_inset

，
\begin_inset Formula $1\le i\le\mathrm{min}\{m,n\}$
\end_inset

。
\begin_inset Formula $V=[v_{1}|\cdots|v_{n}]$
\end_inset

的列是右奇异向量，并构成
\begin_inset Formula $A^{\mathrm{T}}A$
\end_inset

的单位正交向量；
\begin_inset Formula $U=[u_{1}|\cdots|u_{m}]$
\end_inset

的列是左奇异向量，并构成
\begin_inset Formula $AA^{\mathrm{T}}$
\end_inset

的单位正交向量；
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
A & =U\,S\,V^{\mathrm{T}}\\{}
[m\times n] & =[m\times m]\,[m\times n]\,[n\times n]\\
V & \leftrightarrow A^{\mathrm{T}}A,\quad U\leftrightarrow AA^{\mathrm{T}}
\end{align*}

\end_inset


\end_layout

\begin_layout Chapter
插值
\end_layout

\begin_layout Section
数据和插值函数
\end_layout

\begin_layout Section
插值误差
\end_layout

\begin_layout Section
切比雪夫插值
\end_layout

\begin_layout Section
三次样条
\end_layout

\begin_layout Section
三次样条c-recipe
\end_layout

\begin_layout Standard
给定列表函数 
\begin_inset Formula $y_{i}=y(x_{i})$
\end_inset

，
\begin_inset Formula $i=1\cdots N$
\end_inset

。
\series bold

\begin_inset Formula $N$
\end_inset

个点，
\begin_inset Formula $N-1$
\end_inset

段区间，
\begin_inset Formula $N-1$
\end_inset

个函数。
\series default
在区间 
\begin_inset Formula $[x_{j},x_{j+1}]$
\end_inset

上的线性插值为
\begin_inset Formula 
\begin{equation}
y=A\,y_{j}+B\,y_{j+1},\quad j=1,2,\cdots N-1\label{eq:c3.3.1}
\end{equation}

\end_inset

其中
\begin_inset Formula 
\begin{equation}
A\equiv\frac{x_{j+1}-x}{x_{j+1}-x_{j}},\quad B=1-A\equiv\frac{x-x_{j}}{x_{j+1}-x_{j}},\label{eq:c3.3.2}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
三次样条插值表达式为
\begin_inset Formula 
\[
y=A\,y_{j}+B\,y_{j+1}+C\,y_{j}^{\prime\prime}+D\,y_{j+1}^{\prime\prime},\quad j=1,2,\cdots N-1
\]

\end_inset


\begin_inset Formula 
\begin{equation}
C\equiv\frac{1}{6}\left(A^{3}-A\right)\delta_{j}^{2},\quad D\equiv\frac{1}{6}\left(B^{3}-B\right)\delta_{j}^{2}\label{eq:c3.3.4}
\end{equation}

\end_inset

为了简便，定义 
\begin_inset Formula $\delta_{j}=x_{j+1}-x_{j}$
\end_inset

，
\begin_inset Formula $\Delta_{j}=y_{j+1}-y_{j}$
\end_inset

。
\end_layout

\begin_layout Standard
插值表达式的导数为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\dd{y}}{\dd{x}}=\frac{\Delta_{j}}{\delta_{j}}-\frac{3A^{2}-1}{6}\delta_{j}\,y_{j}^{\prime\prime}+\frac{3B^{2}-1}{6}\delta_{j}\,y_{j+1}^{\prime\prime},\quad j=1,2,\cdots N-1\label{eq:c3.3.5}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\frac{\dd[2]{y}}{\dd{x^{2}}}=A\,y_{j}^{\prime\prime}+B\,y_{j+1}^{\prime\prime},\quad j=1,2,\cdots N-1\label{eq:c3.3.6}
\end{equation}

\end_inset

其中
\begin_inset Formula $A=1$
\end_inset

 at 
\begin_inset Formula $x_{j}$
\end_inset

，
\begin_inset Formula $A=0$
\end_inset

 at 
\begin_inset Formula $x_{j+1}$
\end_inset

，
\begin_inset Formula $B$
\end_inset

 刚好反过来。所以
\begin_inset Formula $y_{j}^{\prime\prime}$
\end_inset

 刚好是二阶导数，二阶导数在区间
\begin_inset Formula $(x_{j-1},x_{j})$
\end_inset

 和 
\begin_inset Formula $(x_{j},x_{j+1})$
\end_inset

 上连续。 
\end_layout

\begin_layout Standard
要求一阶导数在相邻区间连续给出，for 
\begin_inset Formula $j=2,\cdots,N-1$
\end_inset


\begin_inset Formula 
\begin{equation}
{\color{blue}\frac{\delta_{j-1}}{6}y_{j-1}^{\prime\prime}}+\frac{\delta_{j}+\delta_{j-1}}{3}y_{j}^{\prime\prime}+{\color{red}\frac{\delta_{j}}{6}y_{j+1}^{\prime\prime}}=\frac{\Delta_{j}}{\delta_{j}}-\frac{\Delta_{j-1}}{\delta_{j-1}}\label{eq:c3.3.7}
\end{equation}

\end_inset

方程一共有 
\begin_inset Formula $N-2$
\end_inset

个，
\series bold
使用
\begin_inset Formula $y_{j}^{\prime\prime}$
\end_inset

作为待求变量， 一共
\begin_inset Formula $N$
\end_inset

个
\series default
，所以还需要补充两个边界条件。
\end_layout

\begin_layout Remark
自然边界条件: 
\begin_inset Formula $y_{1}^{\prime\prime}=y_{N}^{\prime\prime}=0$
\end_inset

，相当于
\begin_inset Formula 
\begin{align}
2y_{1}^{\prime}+y_{2}^{\prime} & =3\frac{\Delta_{1}}{\delta_{1}}\nonumber \\
y_{N-1}^{\prime}+2y_{N}^{\prime} & =3\frac{\Delta_{N-1}}{\delta_{N-1}}\label{eq:my3.3.6}
\end{align}

\end_inset

如果以 
\begin_inset Formula $y_{i}^{\prime}$
\end_inset

 为待求变量，
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:my3.3.6"
plural "false"
caps "false"
noprefix "false"

\end_inset

给出了矩阵的首末两行。
\end_layout

\begin_layout Subsection
换元表示
\end_layout

\begin_layout Standard
边界条件可以通过规定 
\begin_inset Formula $y_{0}^{\prime}$
\end_inset

，
\begin_inset Formula $y_{N}^{\prime}$
\end_inset

 施加，可以把方程用 
\begin_inset Formula $y_{i}^{\prime}$
\end_inset

 重新表示。代入
\begin_inset Formula $x_{i}$
\end_inset

，
\begin_inset Formula $x_{i+1}$
\end_inset

到
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:c3.3.5"
plural "false"
caps "false"
noprefix "false"

\end_inset

得到
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
y_{j}^{\prime} & =\frac{\Delta_{j}}{\delta_{j}}-\frac{1}{3}\delta_{j}\,y_{j}^{\prime\prime}-\frac{1}{6}\delta_{j}\,y_{j+1}^{\prime\prime},\\
y_{j+1}^{\prime} & =\frac{\Delta_{j}}{\delta_{j}}+\frac{1}{6}\delta_{j}\,y_{j}^{\prime\prime}+\frac{1}{3}\delta_{j}\,y_{j+1}^{\prime\prime},\quad j=1,2,\cdots N-1
\end{align*}

\end_inset

可以反解出 
\begin_inset Formula $y_{j}^{\prime\prime}$
\end_inset

，
\begin_inset Formula $y_{j+1}^{\prime\prime}$
\end_inset


\begin_inset Formula 
\begin{align}
\delta_{j}\,y_{j}^{\prime\prime} & =\frac{6\Delta_{j}}{\delta_{j}}-4y_{j}^{\prime}-2y_{j+1}^{\prime}\label{eq:my3.3.7}\\
\delta_{j}\,y_{j+1}^{\prime\prime} & =-(\frac{6\Delta_{j}}{\delta_{j}}-2y_{j}^{\prime}-4y_{j+1}^{\prime})\nonumber 
\end{align}

\end_inset

方程 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:c3.3.7"
plural "false"
caps "false"
noprefix "false"

\end_inset

可以重新为
\begin_inset Formula 
\begin{align*}
 & {\color{blue}\frac{\Delta_{j-1}}{\delta_{j-1}}-\frac{2}{3}y_{j-1}^{\prime}-\frac{1}{3}y_{j}^{\prime}}+\frac{\delta_{j}+\delta_{j-1}}{\delta_{j}}\left(\frac{2\Delta_{j}}{\delta_{j}}-\frac{4}{3}y_{j}^{\prime}-\frac{2}{3}y_{j+1}^{\prime}\right)\\
 & {\color{red}-(\frac{\Delta_{j}}{\delta_{j}}-\frac{1}{3}y_{j}^{\prime}-\frac{2}{3}y_{j+1}^{\prime})}=\frac{\Delta_{j}}{\delta_{j}}-\frac{\Delta_{j-1}}{\delta_{j-1}}
\end{align*}

\end_inset

整理各项
\begin_inset Formula 
\begin{align*}
 & -\frac{2}{3}y_{j-1}^{\prime}+y_{j}^{\prime}\left(-\frac{4}{3}\frac{\delta_{j}+\delta_{j-1}}{\delta_{j}}\right)+y_{j+1}^{\prime}\left(-\frac{2}{3}\frac{\delta_{j}+\delta_{j-1}}{\delta_{j}}+\frac{2}{3}\right)\\
= & \frac{\Delta_{j}}{\delta_{j}}-2\frac{\Delta_{j-1}}{\delta_{j-1}}-\frac{\delta_{j}+2\delta_{j-1}}{\delta_{j}}\frac{\Delta_{j}}{\delta_{j}}
\end{align*}

\end_inset

最后得到，for 
\begin_inset Formula $j=2,\cdots,N-1$
\end_inset


\begin_inset Formula 
\[
{\color{blue}\frac{1}{\delta_{j-1}}y_{j-1}^{\prime}}+2y_{j}^{\prime}(\frac{1}{\delta_{j-1}}+\frac{1}{\delta_{j}})+{\color{red}\frac{1}{\delta_{j}}y_{j+1}^{\prime}}=3(\frac{\Delta_{j-1}}{\delta_{j-1}^{2}}+\frac{\Delta_{j}}{\delta_{j}^{2}})
\]

\end_inset

以
\begin_inset Formula $y_{i}^{\prime}$
\end_inset

 作为列向量，方程对应的三对角矩阵的系数是
\begin_inset Formula 
\begin{align*}
 & \ell_{j}=\frac{1}{\delta_{j-1}},\quad u_{j}=\frac{1}{\delta_{j}},\quad d_{j}=2(\ell_{j}+u_{j})\\
 & b_{j}=3(\frac{\Delta_{j-1}}{\delta_{j-1}^{2}}+\frac{\Delta_{j}}{\delta_{j}^{2}})
\end{align*}

\end_inset

参考
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:my3.3.6"
plural "false"
caps "false"
noprefix "false"

\end_inset

，矩阵的首尾两行是
\begin_inset Formula 
\[
\left[\begin{array}{cccc}
2 & 1\\
 & \cdots\\
 &  & 1 & 2
\end{array}\right]\left[\begin{array}{c}
y_{0}^{\prime}\\
\vdots\\
y_{N}^{\prime}
\end{array}\right]=\left[\begin{array}{c}
3\Delta_{1}/\delta_{1}\\
\vdots\\
3\Delta_{N-1}/\delta_{N-1}
\end{array}\right]
\]

\end_inset


\end_layout

\begin_layout Remark
计算出
\begin_inset Formula $y_{i}^{\prime}$
\end_inset

之后，可以求出
\begin_inset Formula $y$
\end_inset

 的各阶导数（计算过程见下文）
\begin_inset Formula 
\begin{align*}
y(x) & =A\,y_{j}+B\,y_{j+1}+\frac{6\Delta_{j}}{\delta_{j}^{2}}\left(C-D\right)+\frac{y_{j}^{\prime}}{\delta_{j}}\left(2D-4C\right)+\frac{y_{j+1}^{\prime}}{\delta_{j}}\left(4D-2C\right)\\
y^{\prime}(x) & =3\frac{\Delta_{j}}{\delta_{j}}\left[1-A^{2}-B^{2}\right]+\left(2A^{2}+B^{2}-1\right)y_{j}^{\prime}+\left(A^{2}+2B^{2}-1\right)y_{j+1}^{\prime}\\
y_{j}^{\prime\prime}(x) & =\frac{6\Delta_{j}}{\delta_{j}^{2}}-\frac{4y_{j}^{\prime}+2y_{j+1}^{\prime}}{\delta_{j}}
\end{align*}

\end_inset

其中
\begin_inset Formula 
\begin{align*}
 & \delta_{j}=x_{j+1}-x_{j},\quad\Delta_{j}=y_{j+1}-y_{j}\\
 & A\equiv\frac{x_{j+1}-x}{\delta_{j}},\quad B=1-A\equiv\frac{x-x_{j}}{\delta_{j}},\\
 & C\equiv\frac{1}{6}\left(A^{3}-A\right)\delta_{j}^{2},\quad D\equiv\frac{1}{6}\left(B^{3}-B\right)\delta_{j}^{2}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $A$
\end_inset

和
\begin_inset Formula $B$
\end_inset

都是
\begin_inset Formula $x$
\end_inset

的线性函数，如果使用它们作为基本单元，插值函数也可以写成
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
iB[x_] := 1 - iA; iC[x_] := 1/6 (iA^3 - iA) 
\backslash
[Delta]j^2; iD[x_] := 1/6 (iB[x]^3 - iB[x]) 
\backslash
[Delta]j^2; y[x_] := iA yj + iB[x] (yj + 
\backslash
[CapitalDelta]j) + ( 6 
\backslash
[CapitalDelta]j)/
\backslash
[Delta]j^2 (iC[x] - iD[x]) + dyj/
\backslash
[Delta]j (2 iD[x] - 4 iC[x]) + dyj1/
\backslash
[Delta]j (4 iD[x] - 2 iC[x]) CoefficientList[y[x] // Simplify, iA]
\end_layout

\end_inset

 
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
iA[x_] := 1 - iB; iC[x_] := 1/6 (iA[x]^3 - iA[x]) 
\backslash
[Delta]j^2; iD[x_] := 1/6 (iB^3 - iB) 
\backslash
[Delta]j^2; y[x_] := iA [x] yj + iB (yj + 
\backslash
[CapitalDelta]j) + ( 6 
\backslash
[CapitalDelta]j)/
\backslash
[Delta]j^2 (iC[x] - iD[x]) + dyj/
\backslash
[Delta]j (2 iD[x] - 4 iC[x]) + dyj1/
\backslash
[Delta]j (4 iD[x] - 2 iC[x]) CoefficientList[y[x] // Simplify, iB]
\end_layout

\end_inset


\begin_inset Formula 
\begin{align*}
y(x) & =y_{j+1}+{\color{blue}A}\left[\delta_{j}\,y_{j+1}^{\prime}\right]+{\color{blue}A^{2}}\left[-3\Delta_{j}+\delta_{j}\,y_{j}^{\prime}+2\delta_{j}\,y_{j+1}^{\prime}\right]+{\color{blue}A^{3}}\left[2\Delta_{j}-\delta_{j}\,y_{j}^{\prime}-\delta_{j}\,y_{j+1}^{\prime}\right]\\
 & =y_{j}+{\color{red}B}\left[\delta_{j}\,y_{j}^{\prime}\right]+{\color{red}B^{2}}\left[3\Delta_{j}-2\delta_{j}\,y_{j}^{\prime}-\delta_{j}\,y_{j+1}^{\prime}\right]+{\color{red}B^{3}}\left[-2\Delta_{j}+\delta_{j}\,y_{j}^{\prime}+\delta_{j}\,y_{j+1}^{\prime}\right]
\end{align*}

\end_inset


\end_layout

\begin_layout Example
经过样条插值，对应区间
\begin_inset Formula $[x_{0},x_{N}]$
\end_inset

内任意点
\begin_inset Formula $x$
\end_inset

的
\begin_inset Formula $y$
\end_inset

是
\begin_inset Formula 
\[
y=A\,y_{j}+B\,y_{j+1}+C\,y_{j}^{\prime\prime}+D\,y_{j+1}^{\prime\prime}
\]

\end_inset

代入
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:my3.3.7"
plural "false"
caps "false"
noprefix "false"

\end_inset

得到
\begin_inset Formula 
\[
y=A\,y_{j}+B\,y_{j+1}+C\frac{1}{\delta_{j}}\left(\frac{6\Delta_{j}}{\delta_{j}}-4y_{j}^{\prime}-2y_{j+1}^{\prime}\right)-D\frac{1}{\delta_{j}}\left(\frac{6\Delta_{j}}{\delta_{j}}-2y_{j}^{\prime}-4y_{j+1}^{\prime}\right)
\]

\end_inset

整理得
\begin_inset Formula 
\[
y=A\,y_{j}+B\,y_{j+1}+\frac{6\Delta_{j}}{\delta_{j}^{2}}\left(C-D\right)+\frac{y_{j}^{\prime}}{\delta_{j}}\left(2D-4C\right)+\frac{y_{j+1}^{\prime}}{\delta_{j}}\left(4D-2C\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Example
计算 
\begin_inset Formula $y^{\prime}(x)$
\end_inset


\begin_inset Formula 
\begin{align*}
y^{\prime} & =\frac{\Delta_{j}}{\delta_{j}}-\frac{3A^{2}-1}{6}\left(\frac{6\Delta_{j}}{\delta_{j}}-4y_{j}^{\prime}-2y_{j+1}^{\prime}\right)+\frac{3B^{2}-1}{6}\left(-(\frac{6\Delta_{j}}{\delta_{j}}-2y_{j}^{\prime}-4y_{j+1}^{\prime})\right)\\
 & =\frac{\Delta_{j}}{\delta_{j}}-\frac{3A^{2}-1}{6}\frac{6\Delta_{j}}{\delta_{j}}-\frac{3B^{2}-1}{6}\frac{6\Delta_{j}}{\delta_{j}}\\
 & +\frac{3A^{2}-1}{6}4y_{j}^{\prime}+\frac{3B^{2}-1}{6}2y_{j}^{\prime}\\
 & +\frac{3A^{2}-1}{6}2y_{j+1}^{\prime}+\frac{3B^{2}-1}{6}4y_{j+1}^{\prime}\\
= & 3\frac{\Delta_{j}}{\delta_{j}}\left[1-A^{2}-B^{2}\right]+\left(2A^{2}+B^{2}-1\right)y_{j}^{\prime}+\left(A^{2}+2B^{2}-1\right)y_{j+1}^{\prime}
\end{align*}

\end_inset


\begin_inset Formula 
\[
y^{\prime}=3\frac{\Delta_{j}}{\delta_{j}}\left[1-A^{2}-B^{2}\right]+\left(2A^{2}+B^{2}-1\right)y_{j}^{\prime}+\left(A^{2}+2B^{2}-1\right)y_{j+1}^{\prime}
\]

\end_inset


\end_layout

\begin_layout Chapter
最小二乘
\end_layout

\begin_layout Chapter
数值微分和积分
\end_layout

\begin_layout Chapter
常微分方程
\end_layout

\begin_layout Chapter
边值问题
\end_layout

\begin_layout Chapter
偏微分方程
\end_layout

\begin_layout Chapter
随机数和应用
\end_layout

\begin_layout Chapter
三角插值和FFT
\end_layout

\begin_layout Section
傅立叶变换
\end_layout

\begin_layout Subsection
复数算术
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:10.1"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
原单位根
\end_layout

\end_inset

设
\begin_inset Formula $\omega$
\end_inset

为
\begin_inset Formula $n$
\end_inset

次原单位根，
\begin_inset Formula $k$
\end_inset

为整数，则有
\begin_inset Formula 
\begin{equation}
\sum_{j=0}^{n-1}\omega^{jk}=\begin{cases}
n & \text{如果}k=n\,\text{的整数倍}\\
0 & \text{其他}
\end{cases}\label{eq:my10.1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
此引理可用于证明傅立叶矩阵是幺正矩阵。
\end_layout

\begin_layout Subsection
离散傅里叶变换
\end_layout

\begin_layout Standard
设
\begin_inset Formula $x=\left[x_{0},\cdots,x_{n-1}\right]^{T}$
\end_inset

为
\begin_inset Formula $n$
\end_inset

维实数向量，
\begin_inset Formula $\omega=e^{-i\,2\pi/n}$
\end_inset

。
\series bold

\begin_inset Formula $N$
\end_inset

个数据点，
\begin_inset Formula $N$
\end_inset

次单位根，矩阵元素为 
\begin_inset Formula $\omega^{jk}$
\end_inset

，
\begin_inset Formula $j,k\in\{0,1,2,\cdots N-1\}$
\end_inset


\series default
。下面是本章的一些基本定义。
\end_layout

\begin_layout Definition
\begin_inset Formula $x=[x_{0},\cdots,x_{n-1}]^{T}$
\end_inset

的离散傅里叶变换（DFT）为
\begin_inset Formula $n$
\end_inset

维向量
\begin_inset Formula $y=[y_{0},\cdots,y_{n-1}]$
\end_inset

，其中
\begin_inset Formula $\omega=e^{-i2\pi/n}$
\end_inset


\begin_inset Formula 
\begin{equation}
y_{k}=\frac{1}{\sqrt{n}}\sum_{j=0}^{n-1}x_{j}\omega^{jk}\label{eq:10.7}
\end{equation}

\end_inset

用矩阵形式表示为
\begin_inset Formula 
\begin{equation}
y=F_{n}\,x\label{eq:10.8}
\end{equation}

\end_inset

其中
\begin_inset Formula $F$
\end_inset

是傅立叶矩阵，由
\begin_inset CommandInset ref
LatexCommand eqref
reference "lem:10.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

，
\begin_inset Formula $F$
\end_inset

是幺正矩阵。
\begin_inset Formula 
\[
F_{n}=\frac{1}{\sqrt{n}}\left[\begin{array}{ccccc}
\omega^{0} & \omega^{0} & \omega^{0} & \cdots & \omega^{0}\\
\omega^{0} & \omega^{1} & \omega^{2} & \cdots & \omega^{n-1}\\
\omega^{0} & \omega^{2} & \omega^{4} & \cdots & \omega^{2(n-1)}\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
\omega^{0} & \omega^{n-1} & \omega^{2(n-1)} & \cdots & \omega^{(n-1)^{2}}
\end{array}\right]
\]

\end_inset

除了第一行外，其他各行的元素和都为
\begin_inset Formula $0$
\end_inset

。因为
\begin_inset Formula $F_{n}$
\end_inset

是对称矩阵，因此对每一列也是如此。傅立叶矩阵的逆矩阵为 
\begin_inset Formula $F_{n}^{-1}=\overline{F_{n}}$
\end_inset

，即它的复共轭。离散傅里叶逆变换写成
\begin_inset Formula 
\[
x=F_{n}^{-1}\,y
\]

\end_inset


\end_layout

\begin_layout Lemma
\noindent
\begin_inset CommandInset label
LatexCommand label
name "lem:10.4"

\end_inset

设
\begin_inset Formula $\{y_{k}\}$
\end_inset

是
\begin_inset Formula $\{x_{j}\}$
\end_inset

的DFT，其中
\begin_inset Formula $x_{j}$
\end_inset

是实数，则有(a) 
\begin_inset Formula $y_{0}$
\end_inset

为实数；（b）
\begin_inset Formula $y_{n-k}=y_{k}^{*}$
\end_inset

，
\begin_inset Formula $k=1,\cdots,n-1$
\end_inset

。
\end_layout

\begin_layout Subsection
快速傅立叶变换
\end_layout

\begin_layout Theorem
\begin_inset Argument 1
status open

\begin_layout Plain Layout
FFT计算次数
\end_layout

\end_inset

设
\begin_inset Formula $n$
\end_inset

是
\begin_inset Formula $2$
\end_inset

的幂，则大小为
\begin_inset Formula $n$
\end_inset

的
\begin_inset Formula $FFT$
\end_inset

变换需要
\begin_inset Formula $n\left(2\log_{2}n-1\right)+1$
\end_inset

次加法和乘法运算，以及一次除以
\begin_inset Formula $\sqrt{n}$
\end_inset

的运算。
\end_layout

\begin_layout Standard
DFT 的快速算法可以直接用来计算 逆DFT 变换，逆DFT变换对应的矩阵是原矩阵的共轭
\begin_inset Formula $\overline{F_{n}}$
\end_inset

。要计算
\begin_inset Formula $y$
\end_inset

的DFT逆变换，我们只需先求共轭，再进行
\begin_inset Formula $FFT$
\end_inset

，再求一次共轭就能得到结果了。这是因为
\begin_inset Formula 
\[
F_{n}^{-1}\,y=\overline{F_{n}}\,y=\overline{F_{n}\overline{y}}
\]

\end_inset


\end_layout

\begin_layout Subsection
变换因子的性质
\end_layout

\begin_layout Standard
如果定义 
\begin_inset Formula $W_{N}^{nk}=e^{-j\,2\pi/N\,nk}$
\end_inset

，则显然有：
\end_layout

\begin_layout Enumerate
缩放性质
\begin_inset Formula 
\[
W_{N}^{2rk}=W_{N/2}^{rk},\quad W_{N}^{(2r+1)k}=W_{N/2}^{rk}\cdot W_{N}^{k},
\]

\end_inset


\end_layout

\begin_layout Enumerate
周期性（移除
\begin_inset Formula $N$
\end_inset

的整数倍）
\begin_inset Formula 
\[
W_{N}^{n(N-k)}=W_{N}^{-nk},\quad W_{N}^{k(N-n)}=W_{N}^{-nk},
\]

\end_inset


\begin_inset Formula 
\[
W_{N}^{nk}=W_{N}^{r},\quad r=(nk)\mod N
\]

\end_inset


\end_layout

\begin_layout Enumerate
以及（N/2反对称性）
\begin_inset Formula 
\[
W_{N}^{(nk+N/2)}=-W_{N}^{nk}
\]

\end_inset


\end_layout

\begin_layout Standard
有了这两个性质之后，设
\begin_inset Formula $N=2^{m}$
\end_inset

（
\begin_inset Formula $m\in\mathbb{N}^{+}$
\end_inset

）并将DFT 
\begin_inset Formula 
\[
X(k)\coloneqq\mathrm{DFT}\{x(n)\}=\sum_{n=0}^{N-1}x(n)\cdot e^{-j\,2\pi/N\,nk},\quad k=0,1,\cdots,n-1
\]

\end_inset

分解为两部分：
\begin_inset Formula 
\begin{align}
X(k) & \coloneqq\sum_{r=0}^{N/2-1}x(2r)\cdot W_{N}^{2rk}+\sum_{r=0}^{N/2-1}x(2r+1)\cdot W_{N}^{(2r+1)k},\quad\text{even}+\text{odd}\nonumber \\
 & =\sum_{r=0}^{N/2-1}x(2r)\cdot W_{N/2}^{rk}+W_{N}^{k}\cdot\sum_{r=0}^{N/2-1}x(2r+1)\cdot W_{N/2}^{rk}\nonumber \\
 & \coloneqq{\color{blue}G(k)}+{\color{red}W_{N}^{k}\cdot H(k)},\quad k=0,1,2,\cdots,N/2-1\label{eq:my2}
\end{align}

\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:my2"
plural "false"
caps "false"
noprefix "false"

\end_inset

只包括了
\begin_inset Formula $k\in[0,N/2-1]$
\end_inset

的部分，使用其中 
\begin_inset Formula ${\color{blue}G(k)}$
\end_inset

 和 
\begin_inset Formula ${\color{red}W_{N}^{k}\cdot H(k)}$
\end_inset

 的周期性
\begin_inset Formula 
\[
G(k+\frac{N}{2})=G(k),\quad W_{N}^{k}\cdot H(k+\frac{N}{2})=-W_{N}^{k}\cdot H(k),\quad k=0,1,2,\cdots,N/2-1
\]

\end_inset

得到
\begin_inset Formula $k$
\end_inset

的其余部分对应的表达式
\begin_inset Formula 
\begin{equation}
X(k+\frac{N}{2})=G(k)-W_{N}^{k}\cdot H(k),\quad k=0,1,2,\cdots,N/2-1\label{eq:my3}
\end{equation}

\end_inset

例如
\begin_inset Formula $N=4$
\end_inset

，
\begin_inset Newline newline
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="5">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $k$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
前
\begin_inset Formula $N/2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $G(0)+W_{4}^{0}\,H(0)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $G(1)+W_{4}^{1}\,H(1)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
后
\begin_inset Formula $N/2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $G(0)-W_{4}^{0}\,H(0)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $G(1)-W_{4}^{1}\,H(1)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename inset/butterfly-unit.webp
	lyxscale 80
	scale 60

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:my1"

\end_inset

序列长度
\begin_inset Formula $N=4$
\end_inset

的完整的信号流图。
\end_layout

\end_inset


\end_layout

\end_inset

从
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:my1"
plural "false"
caps "false"
noprefix "false"

\end_inset

可以看出，长度为
\begin_inset Formula $N=4$
\end_inset

的序列最开始只进行了一次奇偶分解，而且分为了两组蝶形流程图，分别是从
\begin_inset Formula $x$
\end_inset

到中间变量为一组（第1组）和从中间变量到
\begin_inset Formula $X$
\end_inset

为一组（第 组）。右侧的蝶形单元出现交叉的原因是输出的 
\begin_inset Formula $X(2)$
\end_inset

，
\begin_inset Formula $X(3)$
\end_inset

没有换位。对于
\begin_inset Formula $N=2^{m}$
\end_inset

的情况，这种奇偶分解和蝶形图分解应该被贯彻下去。
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename inset/butterfly-unit2.webp
	lyxscale 80
	scale 60

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:my2"

\end_inset

一般形式的鲽形单元
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:my2"
plural "false"
caps "false"
noprefix "false"

\end_inset

所示的一般形式的蝶形单元，对应下面的方程组
\begin_inset Formula 
\begin{align*}
 & x_{m+1}(p)=x_{m}(p)+x_{m}(q)\cdot W^{r}\\
 & x_{m+1}(q)=x_{m}(p)-x_{m}(q)\cdot W^{r}
\end{align*}

\end_inset

在这样一个一般形式的蝶形单元中，总共进行了
\begin_inset Formula $2$
\end_inset

次加法运算和
\begin_inset Formula $1$
\end_inset

次乘法运算。
\end_layout

\begin_layout Standard
蝶形单元具有以下特点：
\end_layout

\begin_layout Itemize
每一个蝶形单元都是独立的；
\end_layout

\begin_layout Itemize
每一级（组）都有
\begin_inset Formula $N/2$
\end_inset

个蝶形单元，其中
\begin_inset Formula $N$
\end_inset

为序列长度。
\end_layout

\begin_layout Itemize
长度为
\begin_inset Formula $N=2^{m}$
\end_inset

的序列具有
\begin_inset Formula $m$
\end_inset

级（组）的蝶形，且每级可以分为
\begin_inset Formula $N/2^{i}$
\end_inset

小组蝶形单元，
\begin_inset Formula $i$
\end_inset

代表级数。
\end_layout

\begin_layout Remark
以上蝶形单元的特点可以通过
\begin_inset Formula $N=4$
\end_inset

的特殊情况推广得到。由蝶形单元的独立性可知，由两点构成的蝶型单元运算过后就不会再参与其他蝶型单元的运算了。对于长度为
\begin_inset Formula $N=2^{m}$
\end_inset

的序列来讲，整个信号流图所需要的乘法运算次数为
\begin_inset Formula 
\[
M_{c}=\frac{N}{2}\,m=\frac{N}{2}\log_{2}m
\]

\end_inset

整个信号流图所需要的加法运算次数为
\begin_inset Formula 
\[
M_{a}=N\,m=N\log_{2}N.
\]

\end_inset

因此使用FFT算法比直接计算一个序列的DFT要快得多（矩阵运算
\begin_inset Formula $A.X$
\end_inset

需要
\begin_inset Formula $N^{2}$
\end_inset

次乘法和
\begin_inset Formula $N(N-1)$
\end_inset

次加法）。
\end_layout

\begin_layout Example
我们以 
\begin_inset Formula $N=8$
\end_inset

的序列为例，
\begin_inset Formula $N=8$
\end_inset

的序列共进行了两次奇偶分组：
\end_layout

\begin_deeper
\begin_layout Itemize
进行分组之前的序号为： 
\begin_inset Formula $0,\;1,\;2,\;3,\;4,\;5,\;6,\;7$
\end_inset

。
\end_layout

\begin_layout Itemize
第一次分组之后的序号为： 
\begin_inset Formula $0,\;2,\;4,\;6,\;1,\;3,\;5,\;7$
\end_inset

。
\end_layout

\begin_layout Itemize
第二次分组之后的序号为： 
\begin_inset Formula $0,\;4,\;2,\;6,\;1,\;5,\;3,\;7$
\end_inset

。
\end_layout

\end_deeper
\begin_layout Example
之后按第二次分组的序号进行运算，最终得到的结果的序号是： 
\begin_inset Formula $0,\;1,\;2,\;3,\;4,\;5,\;6,\;7$
\end_inset

。如果我们将未分组之前的序号和第二次分组之后的序号进行二进制编码可以得到：
\begin_inset Formula 
\[
\begin{array}{ccccc}
0 & 000 & \quad & 0 & 000\\
1 & {\color{blue}001} & \quad & 4 & {\color{blue}100}\\
2 & 010 & \quad & 2 & 010\\
3 & {\color{blue}011} & \quad & 6 & {\color{blue}110}\\
4 & {\color{blue}100} & \quad & 1 & {\color{blue}001}\\
5 & 101 & \quad & 5 & 101\\
6 & {\color{blue}110} & \quad & 3 & {\color{blue}011}\\
7 & 111 & \quad & 7 & 111
\end{array}
\]

\end_inset

我们可以看出用红色标记出的二进制编码实际上是进行了
\series bold
码位倒置
\series default
（code reverse）。
\end_layout

\begin_layout Remark
使用 FFT 算法的注意事项：
\end_layout

\begin_deeper
\begin_layout Itemize
信号离散时，采样频率为 Nyquist 频率；
\end_layout

\begin_layout Itemize
\begin_inset Formula $N$
\end_inset

必须为
\begin_inset Formula $2$
\end_inset

的整数次幂；
\end_layout

\begin_layout Itemize
数据长度必须足够长： 
\begin_inset Formula $\Delta f=\frac{1}{N\cdot T_{s}}$
\end_inset

。其中，
\begin_inset Formula $\Delta f$
\end_inset

 为数据分辨率； 
\begin_inset Formula $N$
\end_inset

为序列长度（序列点数）； 为采样周期， 
\begin_inset Formula $N\cdot T_{s}$
\end_inset

是数据的实际长度。
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Remark
\begin_inset CommandInset href
LatexCommand href
name "奈奎斯特–香农采样定理"
target "https://www.zhihu.com/question/35836664/answer/71335686"
literal "false"

\end_inset

。采样频率要大于信号最高频率的2倍，才能无失真的保留信号的完整信息。频域上：采样的频率足够高，使得频域中的原信号频谱的副本(copies)不会混叠(aliasi
ng)，从而可以用个低通滤波器截下一块完整的频谱重建信号，时域上：采样点足够密集，使得能获得足够多的频率信息。
\end_layout

\begin_layout Example
程序示例
\end_layout

\begin_layout Example
\begin_inset listings
lstparams "language={C++},keywordstyle={\color{red}}"
inline false
status open

\begin_layout Plain Layout

for (int i = 1; i < n; i <<= 1){
\end_layout

\begin_layout Plain Layout

	complex<double> wn(cos(pi / i), inv * sin(pi / i)); //原根
\end_layout

\begin_layout Plain Layout

	for (int j = 0; j < n; j += (i << 1)){
\end_layout

\begin_layout Plain Layout

		complex<double> w0(1, 0);
\end_layout

\begin_layout Plain Layout

		for (int k = 0; k < i; ++k, w0 *= wn){
\end_layout

\begin_layout Plain Layout

			complex<double> x = a[j + k];
\end_layout

\begin_layout Plain Layout

			complex<double> y = a[j + k + i] * w0;
\end_layout

\begin_layout Plain Layout

			a[j + k] = x + y;
\end_layout

\begin_layout Plain Layout

			a[i + j + k] = x - y; }}}
\end_layout

\end_inset


\end_layout

\begin_layout Example
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="5">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $i=1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $j\Rightarrow$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $6$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $k\Rightarrow$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $j+k$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $6$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $j+k+i$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $5$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $7$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset space \enskip{}
\end_inset

 
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="5">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $i=2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $j\Rightarrow$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $k\Rightarrow$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $j+k$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $5$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $j+k+i$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $6$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $7$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset space \enskip{}
\end_inset

 
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="5">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $i=4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $j\Rightarrow$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $k\Rightarrow$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $j+k$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $j+k+i$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $5$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $6$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $7$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:my2"

\end_inset


\begin_inset Formula $N=8$
\end_inset

的序列，指标的示意图
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Example
\begin_inset CommandInset ref
LatexCommand eqref
reference "tab:my2"
plural "false"
caps "false"
noprefix "false"

\end_inset

展示了计算 
\begin_inset Formula $x(n)$
\end_inset

，
\begin_inset Formula $n=0,1,\cdots,7$
\end_inset

 八个点的傅里叶变换的流程。
\end_layout

\begin_layout Itemize
计算时，先对
\begin_inset Formula $x(n)$
\end_inset

按二进制码逆序排序，形成蝶形信号图的最底层。
\end_layout

\begin_layout Itemize
然后按照蝶形图计算。每一层的偏移是上一层的两倍。
\begin_inset Formula $j\text{的数目}*k\text{的数目}=N/2$
\end_inset

（
\begin_inset Formula $1/2$
\end_inset

 来自于奇偶组合）。
\end_layout

\begin_layout Itemize
然后按照蝶形图不停地作奇偶组合。
\begin_inset Formula $k$
\end_inset

 表示第几组蝶形单元。
\begin_inset Formula $j+k$
\end_inset

索引蝶形单元的上端，
\begin_inset Formula $j+k+i$
\end_inset

索引蝶形单元的下端。
\begin_inset Formula 
\begin{align*}
 & X(k):={\color{blue}G(k)}+{\color{red}W_{N}^{k}\cdot H(k)}=\sum_{r=0}^{N/2-1}{\color{blue}x(2r)\cdot W_{N/2}^{rk}}+W_{N}^{k}\cdot\sum_{r=0}^{N/2-1}{\color{red}x(2r+1)\cdot W_{N/2}^{rk}},\\
 & X(k+\frac{N}{2})=G(k)-W_{N}^{k}\cdot H(k),\quad k=0,1,2,\cdots,N/2-1
\end{align*}

\end_inset


\end_layout

\begin_layout Remark
如果待处理数据的长度不是
\begin_inset Formula $2^{n}$
\end_inset

的形式，参考
\begin_inset CommandInset href
LatexCommand href
name "快速傅里叶变换（FFT） N不为2的次方怎么做"
target "https://www.zhihu.com/question/57834941"
literal "false"

\end_inset

。
\end_layout

\begin_layout Section
三角插值
\end_layout

\begin_layout Standard
DFT可以用来做插值，它的输入是均匀分布的样本点，通过DFT变换得到的输出向量
\begin_inset Formula $y$
\end_inset

就是插值的系数。
\end_layout

\begin_layout Subsection
DFT插值定理
\end_layout

\begin_layout Standard
设 
\begin_inset Formula $[c,d]$
\end_inset

 为插值区间，
\begin_inset Formula $n$
\end_inset

为正整数。定义 
\begin_inset Formula $\Delta t=(d-c)/n$
\end_inset

 以及 
\begin_inset Formula $t_{j}=c+j\Delta t$
\end_inset

 ，其中
\begin_inset Formula $j=0,\cdots,n-1$
\end_inset

 是插值区间上的均匀划分（注意不包括右端点
\begin_inset Formula $d$
\end_inset

）。向量
\begin_inset Formula $x$
\end_inset

为傅立叶变换的输入，
\begin_inset Formula $x_{j}$
\end_inset

可以理解为信号的第
\begin_inset Formula $j$
\end_inset

个分量。例如，我们可以把
\begin_inset Formula $x$
\end_inset

想象成一系列的测量，每个
\begin_inset Formula $x_{j}$
\end_inset

都测量一个离散的采样点
\begin_inset Formula $t_{j}$
\end_inset

，如图
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:10.4"
plural "false"
caps "false"
noprefix "false"

\end_inset

所示。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename inset/NA-10.4.png
	scale 60

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
向量
\begin_inset Formula $x$
\end_inset

看成时间序列。通过傅立叶变换可以用三角函数多项式对其进行插值
\begin_inset CommandInset label
LatexCommand label
name "fig:10.4"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
 & F_{n}=\frac{1}{\sqrt{n}}\left[\begin{array}{cc}
\omega^{0} & \omega^{0}\\
\omega^{0} & \omega^{1}
\end{array}\right],\quad\omega=e^{-i2\pi/n}\\
 & F_{n}^{-1}=\frac{1}{\sqrt{n}}\left[\begin{array}{cc}
\omega^{0} & \omega^{0}\\
\omega^{0} & \omega^{-1}
\end{array}\right]
\end{align*}

\end_inset


\end_layout

\begin_layout Theorem
\begin_inset Argument 1
status open

\begin_layout Plain Layout
DFT插值定理
\end_layout

\end_inset

给定区间
\begin_inset Formula $[c,d]$
\end_inset

和正整数
\begin_inset Formula $n$
\end_inset

，令
\begin_inset Formula $t_{j}=c+j(d-c)/n$
\end_inset

， 
\begin_inset Formula $j=0,\cdots,n-1$
\end_inset

，令 
\begin_inset Formula $x=(x_{0},\cdots,x_{n-1})$
\end_inset

是一个
\begin_inset Formula $n$
\end_inset

维向量。
\begin_inset Formula $\vec{a}+\vec{b}i=F_{n}x$
\end_inset

，其中 
\begin_inset Formula $F_{n}$
\end_inset

是离散傅立叶变换矩阵。则复函数
\begin_inset Formula 
\[
Q(t)=\frac{1}{\sqrt{n}}\sum_{k=0}^{n-1}\left(a_{k}+ib_{k}\right)e^{i2\pi\,{\color{red}k}\,(t-c)/(d-c)}
\]

\end_inset

满足
\begin_inset Formula $Q(t_{j})=x_{j}$
\end_inset

，
\begin_inset Formula $j=0,\cdots,n-1$
\end_inset

。并且若
\begin_inset Formula $x_{j}$
\end_inset

为实数，则实数函数
\begin_inset Formula 
\[
P_{n}(t)=\frac{1}{\sqrt{n}}\sum_{k=0}^{n-1}\left(a_{k}\cos\frac{2\pi k\,(t-c)}{d-c}-b_{k}\sin\frac{2\pi k\,(t-c)}{d-c}\right)
\]

\end_inset

满足 
\begin_inset Formula $D(t_{j})=x_{j}$
\end_inset

，
\begin_inset Formula $j=0,\cdots,n-1$
\end_inset

。下标
\begin_inset Formula $n$
\end_inset

表示三角插值公式中的项数（从零开始），有时可以把
\begin_inset Formula $P_{n}$
\end_inset

称为
\begin_inset Formula $n$
\end_inset

阶三角函数。
\end_layout

\begin_layout Itemize
引理
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:10.4"
plural "false"
caps "false"
noprefix "false"

\end_inset

：设
\begin_inset Formula $\{y_{k}\}$
\end_inset

是
\begin_inset Formula $\{x_{j}\}$
\end_inset

的DFT，其中
\begin_inset Formula $x_{j}$
\end_inset

是实数，则有(a) 
\begin_inset Formula $y_{0}$
\end_inset

为实数；（b）
\begin_inset Formula $y_{n-k}=y_{k}^{*}$
\end_inset

，
\begin_inset Formula $k=1,\cdots,n-1$
\end_inset

。
\end_layout

\begin_layout Itemize
和下面的引理
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:10.7"
plural "false"
caps "false"
noprefix "false"

\end_inset

可以进一步简化插值函数
\begin_inset Formula $P_{n}(t)$
\end_inset

。
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:10.7"

\end_inset

设
\begin_inset Formula $t=j/n$
\end_inset

，其中
\begin_inset Formula $j$
\end_inset

和
\begin_inset Formula $n$
\end_inset

为整数。另取一整数
\begin_inset Formula $k$
\end_inset

，则有
\begin_inset Formula 
\begin{equation}
\cos2\pi\left(n-k\right)t=\cos2\pi\,kt,\quad\sin2\pi\left(n-k\right)t=-\sin2k\pi t\label{eq:10.18}
\end{equation}

\end_inset


\end_layout

\begin_layout Corollary
\begin_inset CommandInset label
LatexCommand label
name "cor:10.8"

\end_inset

对偶数
\begin_inset Formula $n$
\end_inset

，令
\begin_inset Formula $t_{j}=c+j(d-c)/n$
\end_inset

， 
\begin_inset Formula $j=0,\cdots,n-1$
\end_inset

，令 
\begin_inset Formula $x=(x_{0},\cdots,x_{n-1})$
\end_inset

是
\begin_inset Formula $n$
\end_inset

维实数向量。定义
\begin_inset Formula $\sbf a+\sbf bi=F_{n}x$
\end_inset

，其中
\begin_inset Formula $F_{n}$
\end_inset

为DFT，则以下方程
\begin_inset Formula 
\begin{equation}
P_{n}(t)=\frac{1}{\sqrt{n}}\left[a_{0}+2\sum_{k=1}^{n/2-1}\left(a_{k}\cos\frac{2\pi k(t-c)}{d-c}-b_{k}\sin\frac{2\pi k(t-c)}{d-c}\right)+a_{n/2}\cos\frac{\pi n(t-c)}{d-c}\right]\label{eq:10.19}
\end{equation}

\end_inset

满足
\begin_inset Formula $P_{n}(t_{j})=x_{j}$
\end_inset

，
\begin_inset Formula $j=0,\cdots,n-1$
\end_inset

。对奇数
\begin_inset Formula $n$
\end_inset

有
\begin_inset Formula 
\[
P_{n}(t)=\frac{1}{\sqrt{n}}\left[a_{0}+2\sum_{k=1}^{(n-1)/2}\left(a_{k}\cos\frac{2\pi k(t-c)}{d-c}-b_{k}\sin\frac{2\pi k(t-c)}{d-c}\right)\right]
\]

\end_inset


\end_layout

\begin_layout Remark
例如
\begin_inset Formula $n$
\end_inset

为偶数，
\begin_inset Formula $a_{n/2}$
\end_inset

恰好是中间项，
\begin_inset Formula $0$
\end_inset

为求和项，
\begin_inset Formula $1\sim n/2-1$
\end_inset

为正频项，
\begin_inset Formula $n/2+1\sim n-1$
\end_inset

为负频项。
\begin_inset Formula $P_{n}(t)$
\end_inset

的后半部分，根据
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:10.18"
plural "false"
caps "false"
noprefix "false"

\end_inset

，相当于做替换
\begin_inset Formula 
\[
2\left(n-k\right)\pi t\Rightarrow-2k\pi t
\]

\end_inset

即频率加上负号，所以被称为负频项。
\color red
正频项是从小到大
\color inherit

\begin_inset Formula 
\[
\omega,\quad2\omega,\;\cdots,\;(\frac{n}{2}-1)\omega,\quad\pi
\]

\end_inset


\color red
负频项的绝对值是从大到小
\color inherit
，越靠近中心项，频率绝对值越高，
\begin_inset Formula 
\[
-(\frac{n}{2}-1)\omega,\quad-(\frac{n}{2}-2)\omega,\;\cdots,\;-2\omega,\quad-\omega
\]

\end_inset

其中
\begin_inset Formula $\omega=2\pi/n$
\end_inset

。对于实数序列
\begin_inset Formula $x$
\end_inset

，系数则满足 
\begin_inset Formula $y_{n-k}=y_{k}^{*}$
\end_inset

（复共轭）。
\end_layout

\begin_layout Subsection
三角插值函数的高效计算
\end_layout

\begin_layout Standard
\begin_inset CommandInset ref
LatexCommand ref
reference "cor:10.8"
plural "false"
caps "false"
noprefix "false"

\end_inset

中明确给出了三角插值的公式。在数值上，为了计算多个离散点对儿，可以直接使用DFT变换替代
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:10.19"
plural "false"
caps "false"
noprefix "false"

\end_inset

中的正弦和余弦函数。当输入点数目为
\begin_inset Formula $n$
\end_inset

个，为了将其扩充到
\begin_inset Formula $p\ge n$
\end_inset

个，可以在逆变换之前，先把系数通过填零扩充到
\begin_inset Formula $p$
\end_inset

个。也就是
\begin_inset Formula 
\begin{equation}
P_{n}(t)=\frac{\sqrt{p/n}}{\sqrt{p}}\left[a_{0}+2\sum_{k=1}^{n/2-1}\left(a_{k}\cos\frac{2\pi k(t-c)}{d-c}-b_{k}\sin\frac{2\pi k(t-c)}{d-c}\right)+a_{n/2}\cos\frac{\pi n(t-c)}{d-c}\right]\label{eq:10.21}
\end{equation}

\end_inset

其中对于 
\begin_inset Formula $k=n/2+1,\cdots,p/2$
\end_inset

，
\begin_inset Formula $a_{k}=b_{k}=0$
\end_inset

。也就是说，考虑到归一化，在逆变换之前，要先对数据乘上 
\begin_inset Formula $\sqrt{p/n}$
\end_inset

。由于 Matlab FFT 接口在 DFT 时未进行归一化（公共系数为
\begin_inset Formula $1$
\end_inset

），而IDFT 的系数为
\begin_inset Formula $1/n$
\end_inset

。可以知道若使用 Matlab 接口
\begin_inset Formula 
\begin{equation}
\mathrm{IDFT}\cdot\mathrm{DFT}\cdot x\Rightarrow F_{p}^{-1}\,\sqrt{\frac{p}{n}}\,F_{n}\,x\Rightarrow\frac{p}{n}\cdot\mathrm{ifft}_{[p]}\cdot\mathrm{fft}_{[n]}.\label{eq:10.22}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
FFT和信号处理
\end_layout

\begin_layout Standard
正交性和插值
\end_layout

\begin_layout Section
FFT net
\end_layout

\begin_layout Standard
\begin_inset CommandInset href
LatexCommand href
name "快速傅里叶变换（FFT）超详解"
target "https://zhuanlan.zhihu.com/p/347091298"
literal "false"

\end_inset

，
\begin_inset CommandInset href
LatexCommand href
name "https://zhuanlan.zhihu.com/p/347514286"
target "快速傅里叶变换（FFT）的优化"
literal "false"

\end_inset

，
\end_layout

\begin_layout Standard
对多项式
\begin_inset Formula $f(x)=\sum_{i=0}^{n}a_{i}x^{i}$
\end_inset

，
\begin_inset Formula $g(x)=\sum_{i=0}^{n}b_{i}x^{i}$
\end_inset

，其乘积
\begin_inset Formula $fg$
\end_inset

为
\begin_inset Formula 
\[
(fg)(x)=\left(\sum_{i=0}^{n}a_{i}x^{i}\right)\left(\sum_{i=0}^{n}b_{i}x^{i}\right)
\]

\end_inset

显然我们可以用
\begin_inset Formula $\order{n^{2}}$
\end_inset

 的复杂度计算这个乘积的每一项的系数。但FFT可以用
\begin_inset Formula $\order{n\log n}$
\end_inset

的时间复杂度来计算这个乘积。
\end_layout

\begin_layout Subsection
多项式的系数与点值表示
\end_layout

\begin_layout Standard
对于任意
\begin_inset Formula $n+1$
\end_inset

次多项式 
\begin_inset Formula $f(x)=\sum_{i=0}^{n}a_{i}x^{i}\in X_{n}$
\end_inset

，只需知道每一项的系数就可以唯一确定
\begin_inset Formula $f(x)$
\end_inset

，故
\begin_inset Formula $f(x)$
\end_inset

 可以表示为 
\begin_inset Formula $(a_{0},a_{1},a_{2},\cdots,a_{n})$
\end_inset

的形式，这就是多项式的
\series bold
系数表示
\series default
。
\end_layout

\begin_layout Standard
此外，
\begin_inset Formula $n$
\end_inset

次多项式上
\begin_inset Formula $n+1$
\end_inset

个不同的点能唯一确定这个多项式（插值定理），因此
\begin_inset Formula $f(x)$
\end_inset

也可以写作
\begin_inset Formula 
\[
\left\{ (x_{0},f_{0}),\;(x_{1},f_{1}),\;(x_{2},f_{2}),\cdots,(x_{n},f_{n})\right\} 
\]

\end_inset

这就是多项式的点值表示。若 
\begin_inset Formula $x_{0},x_{1},\cdots,x_{n}$
\end_inset

确定，则令
\begin_inset Formula $\tau(f)$
\end_inset

 表示
\begin_inset Formula $f$
\end_inset

的点值表示。多项式乘法在点值表示法下可以用
\begin_inset Formula $\order{n}$
\end_inset

的复杂度计算
\begin_inset Formula 
\[
\tau(fg)=\left\{ (x_{0},f_{0}\cdot g_{0}),\;(x_{1},f_{1}\cdot g_{1}),\;(x_{2},f_{2}\cdot g_{2}),\cdots,(x_{n},f_{n}\cdot g_{n})\right\} .
\]

\end_inset

所以需要一种方法在较低的时间复杂度内完成两种表示的转换。
\end_layout

\begin_layout Subsection
单位根的性质
\end_layout

\begin_layout Standard
\begin_inset Formula $n$
\end_inset


\series bold
次单位根
\series default
定义为
\begin_inset Formula 
\[
\omega_{n}=\cos\frac{2\pi}{n}+i\sin\frac{2\pi}{n}
\]

\end_inset

由欧拉公式
\begin_inset Formula 
\[
\omega_{n}^{k}=\cos\frac{2k\pi}{n}+i\sin\frac{2k\pi}{n}
\]

\end_inset

特别地，
\begin_inset Formula $\omega_{n}^{0}=\omega_{n}^{n}=1$
\end_inset

。此外
\begin_inset Formula $\omega_{n}$
\end_inset

还具有以下性质：
\begin_inset Formula 
\begin{align*}
\omega_{rn}^{rk} & =\cos\frac{2rk\pi}{rn}+i\sin\frac{2rk\pi}{rn}=\omega_{n}^{k},\quad r\in\mathbb{N}^{+}\\
\omega_{n}^{k+n/2} & =\omega_{n}^{k}\left(\cos\frac{n\,2\pi}{2\,n}+i\sin\frac{n\,2\pi}{2\,n}\right)=-\omega_{n}^{k},\quad k\in\mathbb{N}^{+}\\
\overline{\omega_{n}^{k}} & =\cos\frac{2k\pi}{n}-i\sin\frac{2k\pi}{n}=\omega_{n}^{n-k}
\end{align*}

\end_inset


\end_layout

\begin_layout Subsection
快速傅里叶变换
\end_layout

\begin_layout Standard
对多项式 
\begin_inset Formula $f(x)=\sum_{i=0}^{n}a_{i}x^{i}\in X_{n}$
\end_inset

，不是一般性的设
\begin_inset Formula $n=2^{s}$
\end_inset

，
\begin_inset Formula $s\in\mathbb{N}$
\end_inset

（认为更高次幂系数为零）。考虑按
\begin_inset Formula $a_{i}$
\end_inset

下标的奇偶性将
\begin_inset Formula $f(x)$
\end_inset

 中的项分为两部分，即
\begin_inset Formula 
\begin{align*}
f(x) & =(a_{0}+a_{2}x^{2}+a_{4}x^{4}+\cdots+a_{n-2}x^{n-2})\\
 & +(a_{1}+a_{3}x^{2}+a_{5}x^{4}+\cdots+a_{n-1}x^{n-1})
\end{align*}

\end_inset

令
\begin_inset Formula 
\begin{align*}
f_{1}(x) & =a_{0}+a_{2}x^{1}+a_{4}x^{2}+\cdots+a_{n-2}x^{(n-2)/2}\\
f_{2}(x) & =a_{1}+a_{3}x^{1}+a_{5}x^{2}+\cdots+a_{n-1}x^{(n-2)/2}
\end{align*}

\end_inset

则
\begin_inset Formula 
\[
f(x)=f_{1}(x^{2})+xf_{2}(x^{2})
\]

\end_inset

代入
\begin_inset Formula $x=\omega_{n}^{k}$
\end_inset

（
\begin_inset Formula $k<n/2$
\end_inset

）可得
\begin_inset Formula 
\begin{align}
f(\omega_{n}^{k}) & =f_{1}\left(\omega_{n}^{2k}\right)+\omega_{n}^{k}f_{2}\left(\omega_{n}^{2k}\right)\nonumber \\
 & =f_{1}\left(\omega_{n/2}^{k}\right)+\omega_{n}^{k}f_{2}\left(\omega_{n/2}^{k}\right)\label{eq:my10}
\end{align}

\end_inset

代入
\begin_inset Formula $\omega_{n}^{k+n/2}$
\end_inset

可得
\begin_inset Formula 
\begin{align}
f(\omega_{n}^{k+n/2}) & =f_{1}\left(\omega_{n}^{2k+n}\right)+\omega_{n}^{k+n/2}f_{2}\left(\omega_{n}^{2k+n}\right)\nonumber \\
 & =f_{1}\left(\omega_{n/2}^{k}\right)-\omega_{n}^{k}f_{2}\left(\omega_{n/2}^{k}\right)\label{eq:my11}
\end{align}

\end_inset

观察
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:my10"
plural "false"
caps "false"
noprefix "false"

\end_inset

，
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:my11"
plural "false"
caps "false"
noprefix "false"

\end_inset

，我们只需要求出
\begin_inset Formula $f_{1}\left(\omega_{n/2}^{k}\right)$
\end_inset

，
\begin_inset Formula $f_{2}\left(\omega_{n/2}^{k}\right)$
\end_inset

即可
\begin_inset Formula $\order{1}$
\end_inset

求出
\begin_inset Formula $f(\omega_{n}^{k})$
\end_inset

，
\begin_inset Formula $f(\omega_{n}^{k+n/2})$
\end_inset

的值。类似地，可以递归转化，最终相当于求
\begin_inset Formula 
\[
f_{1}(\omega_{1}^{k})=f_{2}(\omega_{1}^{k})=1
\]

\end_inset

故以
\begin_inset Formula $\order{\log n}$
\end_inset

的复杂度可以求出
\begin_inset Formula $f(\omega_{n}^{k})$
\end_inset

，
\begin_inset Formula $f\left(\omega_{n}^{k+n/2}\right)$
\end_inset

，进而可以用 
\begin_inset Formula $\order{n\log n}$
\end_inset

的复杂度求出所有的
\begin_inset Formula $f(\omega_{n}^{k})$
\end_inset

，即用 
\begin_inset Formula $\order{n\log n}$
\end_inset

的时间复杂度将
\begin_inset Formula $f$
\end_inset

的系数表示法转化为点值表示法。
\end_layout

\begin_layout Subsection
逆FFT
\end_layout

\begin_layout Standard
FFT的逆过程称为 离散傅立叶逆变换（IDFT）。首先来看DFT的矩阵形式为
\begin_inset Formula 
\[
\frac{1}{\sqrt{n}}\left[\begin{array}{ccccc}
1 & 1 & 1 & \cdots & 1\\
1 & (\omega_{n}^{{\color{blue}1}})^{1} & (\omega_{n}^{1})^{2} & \cdots & (\omega_{n}^{1})^{n-1}\\
1 & (\omega_{n}^{{\color{blue}2}})^{1} & (\omega_{n}^{2})^{2} & \cdots & (\omega_{n}^{2})^{n-1}\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
1 & (\omega_{n}^{{\color{blue}n-1}})^{1} & (\omega_{n}^{n-1})^{2} & \cdots & (\omega_{n}^{n-1})^{n-1}
\end{array}\right]\left[\begin{array}{c}
a_{0}\\
a_{1}\\
a_{2}\\
\vdots\\
a_{n-1}
\end{array}\right]=\left[\begin{array}{c}
y_{0}\\
y_{1}\\
y_{2}\\
\vdots\\
y_{n-1}
\end{array}\right]
\]

\end_inset

其中
\begin_inset Formula $\left[a_{i}\cdots\right]$
\end_inset

为多项式的系数表示法，
\begin_inset Formula $\left[y_{i}\cdots\right]$
\end_inset

为多项式的点值表示法。它的逆矩阵是（把矩阵的行逆序排列，即左乘次对角线
\begin_inset Formula $I$
\end_inset

矩阵）
\begin_inset Formula 
\[
\frac{1}{\sqrt{n}}\left[\begin{array}{ccccc}
1 & 1 & 1 & \cdots & 1\\
1 & (\omega_{n}^{{\color{blue}n-1}})^{1} & (\omega_{n}^{n-1})^{2} & \cdots & (\omega_{n}^{n-1})^{n-1}\\
1 & (\omega_{n}^{{\color{blue}n-2}})^{1} & (\omega_{n}^{n-2})^{2} & \cdots & (\omega_{n}^{n-2})^{n-1}\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
1 & (\omega_{n}^{{\color{blue}1}})^{1} & (\omega_{n}^{1})^{2} & \cdots & (\omega_{n}^{1})^{n-1}
\end{array}\right].
\]

\end_inset

这是因为从
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:my10.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

可知，
\begin_inset Formula 
\begin{align*}
\left[\begin{array}{ccccc}
1 & (\omega_{n}^{{\color{blue}n-i}})^{1} & (\omega_{n}^{{\color{blue}n-i}})^{2} & \cdots & (\omega_{n}^{{\color{blue}n-i}})^{n-1}\end{array}\right]\left[\begin{array}{c}
1\\
(\omega_{n}^{j})^{1}\\
(\omega_{n}^{j})^{2}\\
\vdots\\
(\omega_{n}^{j})^{n-1}
\end{array}\right] & =\sum_{k=0}^{n-1}(\omega^{n-i})^{k}(\omega_{n}^{j})^{k}\\
 & =\sum(\omega^{n-i+j})^{k}=\begin{cases}
n & i=j\\
0 & i\neq j
\end{cases}
\end{align*}

\end_inset

考虑到
\begin_inset Formula $\omega_{n}^{n-i}=\overline{\omega_{n}^{i}}$
\end_inset

，也可以把逆变换写成
\begin_inset Formula 
\[
\frac{1}{\sqrt{n}}\left[\begin{array}{ccccc}
1 & 1 & 1 & \cdots & 1\\
1 & (\overline{\omega_{n}^{1}})^{1} & (\omega_{n}^{1})^{2} & \cdots & (\omega_{n}^{1})^{n-1}\\
1 & (\omega_{n}^{2})^{1} & (\omega_{n}^{2})^{2} & \cdots & (\omega_{n}^{2})^{n-1}\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
1 & (\omega_{n}^{n-1})^{1} & (\omega_{n}^{n-1})^{2} & \cdots & (\omega_{n}^{n-1})^{n-1}
\end{array}\right]\left[\begin{array}{c}
y_{0}\\
y_{1}\\
y_{2}\\
\vdots\\
y_{n-1}
\end{array}\right]=\left[\begin{array}{c}
a_{0}\\
a_{1}\\
a_{2}\\
\vdots\\
a_{n-1}
\end{array}\right]
\]

\end_inset

即对每个元素取复共轭。
\end_layout

\begin_layout Standard
EOF
\end_layout

\end_body
\end_document
