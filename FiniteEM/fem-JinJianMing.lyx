#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass ctex-book
\begin_preamble
\input{math-preamble}
\end_preamble
\options UTF8,dvipsnames,svgnames,x11names,hyperref,colorlinks=true
\use_default_options true
\begin_modules
theorems-ams-chap-bytype
graphicboxes
\end_modules
\maintain_unincluded_children false
\language chinese-simplified
\language_package none
\inputencoding utf8-plain
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures false
\graphics default
\default_output_format pdf4
\output_sync 0
\bibtex_command default
\index_command default
\float_placement H
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 2
\use_package amssymb 2
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
FiniteEM 金建铭
\end_layout

\begin_layout Author
Young
\end_layout

\begin_layout Chapter
基本电磁场理论p4/1
\end_layout

\begin_layout Section
麦克斯韦方程组
\end_layout

\begin_layout Subsection
一般微分形式
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
 & \nabla\times\sbf E=-\frac{\partial\sbf B}{\partial t}\quad\text{法拉第定律}\label{eq:1.1}\\
 & \nabla\times\sbf H=\sbf J+\frac{\partial\sbf D}{\partial t}\quad\text{安培定律}\label{eq:1.2}\\
 & \nabla\cdot\sbf D=\rho\quad\text{高斯定律}\label{eq:1.3}\\
 & \nabla\cdot\sbf B=0\quad\text{磁场高斯定律}\label{eq:1.4}
\end{align}

\end_inset

电荷连续性方程
\begin_inset Formula 
\begin{equation}
\nabla\cdot\sbf J=-\frac{\partial\rho}{\partial t}\label{eq:1.5}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
方程
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

~
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.5"
plural "false"
caps "false"
noprefix "false"

\end_inset

式中只有三个是独立的。
\end_layout

\begin_layout Subsection
静电场和静磁场
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
 & \nabla\times\sbf E=0\label{eq:1.6}\\
 & \nabla\times\sbf H=\sbf J\label{eq:1.7}\\
 & \nabla\cdot\sbf J=0\label{eq:1.8}
\end{align}

\end_inset

而
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.3"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.4"
plural "false"
caps "false"
noprefix "false"

\end_inset

保持不变。
\end_layout

\begin_layout Subsection
时谐场
\end_layout

\begin_layout Standard
当麦克斯韦方程组中的场量是单频的谐振函数时，我们得到时谐场。用复相位因子表示法，
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

，
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.2"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.5"
plural "false"
caps "false"
noprefix "false"

\end_inset

可写成简单形式
\begin_inset Formula 
\begin{align}
 & \nabla\times\sbf E=-j\omega\sbf B\label{eq:1.9}\\
 & \nabla\times\sbf H=\sbf J+j\omega\sbf D\label{eq:1.10}\\
 & \nabla\cdot\sbf J=-j\omega\rho\label{eq:1.11}
\end{align}

\end_inset

时间约定
\begin_inset Formula $e^{j\omega t}$
\end_inset

，并被消去，
\begin_inset Formula $\omega$
\end_inset

是角频率。
\end_layout

\begin_layout Subsection
本构关系
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
 & \sbf D=\varepsilon\sbf E\label{eq:1.12}\\
 & \sbf B=\mu\sbf H\label{eq:1.13}\\
 & \sbf J=\sigma\sbf E\label{eq:1.14}
\end{align}

\end_inset

式中，
\end_layout

\begin_layout Itemize
本构参数 
\begin_inset Formula $\varepsilon$
\end_inset

，
\begin_inset Formula $\mu$
\end_inset

和
\begin_inset Formula $\sigma$
\end_inset

分别表示媒介的介电常数（
\begin_inset Formula $\mathrm{F/m}$
\end_inset

），磁导率（
\begin_inset Formula $\mathrm{H/m}$
\end_inset

）和电导率（
\begin_inset Formula $\mathrm{S/m}$
\end_inset

）。
\end_layout

\begin_layout Itemize
对各向异性媒介，这些参数是张量。对各向同性媒介，它们是标量。
\end_layout

\begin_layout Itemize
对非均匀媒介，它们是位置的函数；对均匀媒介，它们不随位置变化。
\end_layout

\begin_layout Section
标量势和矢量势
\end_layout

\begin_layout Subsection
静电场的标量势
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
 & \nabla\cdot\sbf D=\rho\\
 & \nabla\times\sbf E=0
\end{align*}

\end_inset


\begin_inset Formula 
\begin{equation}
E=-\nabla\Phi\label{eq:1.15}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
-\nabla\cdot(\varepsilon\nabla\Phi)=\rho\label{eq:1.16}
\end{equation}

\end_inset

这是
\begin_inset Formula $\Phi$
\end_inset

的二阶微分方程。
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.16"
plural "false"
caps "false"
noprefix "false"

\end_inset

式是著名的泊松（Poisson）方程。
\begin_inset Formula 
\[
\nabla^{2}=\partial_{x}^{2}+\partial_{y}^{2}+\partial_{z}^{2}
\]

\end_inset


\end_layout

\begin_layout Subsection
静磁场的矢量势
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
 & \nabla\cdot\sbf B=0\\
 & \nabla\times\sbf H=\sbf J
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\sbf B=\nabla\times\sbf A\label{eq:1.17}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla\times(\frac{1}{\mu}\nabla\times\sbf A)=\sbf J\label{eq:1.18}
\end{equation}

\end_inset

然而这个方程不能唯一地确定
\begin_inset Formula $\sbf A$
\end_inset

，因为如果
\begin_inset Formula $\sbf A$
\end_inset

是
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.18"
plural "false"
caps "false"
noprefix "false"

\end_inset

式的一个解，那么不管
\begin_inset Formula $f$
\end_inset

的具体形式如何，任意函数
\begin_inset Formula $\sbf A'=\sbf A+\nabla f$
\end_inset

也是
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.18"
plural "false"
caps "false"
noprefix "false"

\end_inset

式的解。因此为了唯一确定
\begin_inset Formula $\sbf A$
\end_inset

，必须对
\begin_inset Formula $\sbf A$
\end_inset

的散度强加一个条件，这种条件被称为规范条件。此条件的一种自然选择为（库仑规范）
\begin_inset Formula 
\begin{equation}
\nabla\cdot\sbf A=0\label{eq:1.19}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
上述的讨论仅适用于静态场。在时谐场情况下，也可用类似于上面的方式引进标量势和矢量势来表示电场和磁场。但是因为本书中处理时谐场问题时直接用电场和磁场，所以在此不讨
论时谐场中的矢量势和标量势。
\end_layout

\begin_layout Remark
note。一阶旋度
\begin_inset Formula 
\[
\nabla\times\sbf A=(\partial_{y}A_{z}-\partial_{z}A_{y},\,{\color{blue}\partial_{z}A_{x}-\partial_{x}A_{z}},\,\partial_{x}A_{y}-\partial_{y}A_{x})
\]

\end_inset

二阶旋度有恒等式
\begin_inset Formula 
\[
\nabla\times(\nabla\times\sbf A)=\nabla(\nabla\cdot\sbf A)-(\nabla\cdot\nabla)\,\sbf A
\]

\end_inset

例如在
\begin_inset Formula $x$
\end_inset

方向上，
\begin_inset Formula $\sbf A$
\end_inset

的散度在
\begin_inset Formula $x$
\end_inset

方向上的梯度 减去 
\begin_inset Formula $A_{x}$
\end_inset

的梯度的散度。
\end_layout

\begin_layout Remark
写成分量即
\begin_inset Formula 
\begin{align*}
\nabla\times(\nabla\times\sbf A)= & \partial_{x}\left(\partial_{y}A_{y}+\partial_{z}A_{z}\right)-\left(\partial_{y}^{2}+\partial_{z}^{2}\right)A_{x}\\
 & +\partial_{y}\left(\partial_{x}A_{x}+\partial_{z}A_{z}\right)-\left(\partial_{x}^{2}+\partial_{z}^{2}\right)A_{y}\\
 & +\partial_{z}\left(\partial_{x}A_{x}+\partial_{y}A_{y}\right)-\left(\partial_{x}^{2}+\partial_{y}^{2}\right)A_{z}
\end{align*}

\end_inset


\end_layout

\begin_layout Remark
令
\begin_inset Formula $\sbf A\to\sbf A+\nabla f$
\end_inset

，其中
\begin_inset Formula $f$
\end_inset

为任意标量函数。则
\begin_inset Formula $f$
\end_inset

部分的方程是，
\begin_inset Formula 
\begin{align*}
 & \nabla\left(\nabla^{2}f\right)-\nabla^{2}\nabla f\\
\Rightarrow\quad & \partial_{i}\partial_{k}\partial_{k}f-\partial_{k}\partial_{k}\partial_{i}f=0
\end{align*}

\end_inset

即
\begin_inset Formula $\sbf A+\nabla f$
\end_inset

也满足
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.18"
plural "false"
caps "false"
noprefix "false"

\end_inset

。
\end_layout

\begin_layout Section
波动方程
\end_layout

\begin_layout Standard
推导只包含一个场量的控制微分方程。
\end_layout

\begin_layout Subsection
矢量波动方程
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\nabla\times\left(\frac{1}{\mu_{r}}\nabla\times\sbf E\right)-\omega^{2}\varepsilon_{r}\sbf E=-j\omega\sbf J\label{eq:1.20}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla\times\left(\frac{1}{\varepsilon_{r}}\nabla\times\sbf H\right)-\omega^{2}\mu_{r}\sbf H=\nabla\times(\frac{1}{\varepsilon_{r}}\sbf J)\label{eq:1.21}
\end{equation}

\end_inset


\begin_inset Formula $\sbf J$
\end_inset

是外加电流或源电流，
\begin_inset Formula $\varepsilon_{r}(=\varepsilon-j\sigma/\omega)$
\end_inset

是感应电流（
\begin_inset Formula $\sigma\sbf E$
\end_inset

）和位移电流（
\begin_inset Formula $j\omega\sbf D$
\end_inset

）的综合贡献；然而为简单起见，我们以后仍用
\begin_inset Formula $\varepsilon$
\end_inset

表示
\begin_inset Formula $\varepsilon_{r}$
\end_inset

。
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.20"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.21"
plural "false"
caps "false"
noprefix "false"

\end_inset

式被称为非齐次矢量波动方程。
\end_layout

\begin_layout Subsection
标量波动方程
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left[\partial_{x}\left(\frac{1}{\mu_{r}}\partial_{x}\right)+\partial_{y}\left(\frac{1}{\mu_{r}}\partial_{y}\right)+k_{0}^{2}\varepsilon_{r}\right]E_{z}=jk_{0}\,Z_{0}\,J_{z}\label{eq:1.22}
\end{equation}

\end_inset

以及
\begin_inset Formula 
\begin{equation}
\left[\partial_{x}\left(\frac{1}{\varepsilon_{r}}\partial_{x}\right)+\partial_{y}\left(\frac{1}{\varepsilon_{r}}\partial_{y}\right)+k_{0}^{2}\mu_{r}\right]H_{z}=-\partial_{x}\left(\frac{1}{\varepsilon_{r}}J_{y}\right)+\partial_{y}\left(\frac{1}{\varepsilon_{r}}J_{x}\right)\label{eq:1.23}
\end{equation}

\end_inset

式中，
\begin_inset Formula $\varepsilon_{r}=\varepsilon/\varepsilon_{0}$
\end_inset

和
\begin_inset Formula $\mu_{r}=\mu/\mu_{0}$
\end_inset

分别表示相对介电常数和相对磁导率，在此假设它们是位置的复标量函数；
\begin_inset Formula $k_{0}=\omega\sqrt{\varepsilon_{0}\mu_{0}}$
\end_inset

 是自由空间波数；
\begin_inset Formula $Z_{0}=\sqrt{\mu_{0}/\varepsilon_{0}}$
\end_inset

 是自由空间的特征阻抗。电常数 
\begin_inset Formula $\varepsilon_{0}=8.854\times10^{-12}\,\mathrm{F/m}$
\end_inset

，磁常数
\begin_inset Formula $\mu_{0}=4\pi\times10^{-7}\,\mathrm{H/m}$
\end_inset

 分别为自由空间的介电常数和磁导率。
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.22"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.23"
plural "false"
caps "false"
noprefix "false"

\end_inset

式类型得到方程叫做非齐次标量波动方程。
\end_layout

\begin_layout Section
边界条件
\end_layout

\begin_layout Subsection
两媒介间的界面
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\hat{\sbf n}\times\sbf E_{1} & =\hat{\sbf n}\times\sbf E_{2}\label{eq:1.24}\\
\hat{\sbf n}\cdot\sbf D_{1} & =\hat{\sbf n}\cdot\sbf D_{2}\label{eq:1.25}
\end{align}

\end_inset

同样，对于磁场有
\begin_inset Formula 
\begin{align}
\hat{\sbf n}\times\sbf H_{1} & =\hat{\sbf n}\times\sbf H_{2}\label{eq:1.26}\\
\hat{\sbf n}\cdot\sbf B_{1} & =\hat{\sbf n}\cdot\sbf B_{2}\label{eq:1.27}
\end{align}

\end_inset

这里
\begin_inset Formula $\hat{\sbf n}$
\end_inset

是垂直于界面的单位矢量，由媒质
\begin_inset Formula $2$
\end_inset

指向媒质1，上面四个方程也可成为场的连续性条件。在这四个边界条件中，只有两个是独立的，一个是
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.24"
plural "false"
caps "false"
noprefix "false"

\end_inset

或
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.27"
plural "false"
caps "false"
noprefix "false"

\end_inset

，一个是
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.25"
plural "false"
caps "false"
noprefix "false"

\end_inset

或
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.26"
plural "false"
caps "false"
noprefix "false"

\end_inset

。
\end_layout

\begin_layout Standard
面电流密度（
\begin_inset Formula $\sbf J_{s}$
\end_inset

），面电荷密度（
\begin_inset Formula $\rho_{s}$
\end_inset

）
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
 & \hat{\sbf n}\cdot(\sbf D_{1}-\sbf D_{2})=\rho_{s}\label{eq:1.28}\\
 & \hat{\sbf n}\times(\sbf H_{1}-\sbf H_{2})=\sbf J_{s}\label{eq:1.29}
\end{align}

\end_inset


\end_layout

\begin_layout Subsection
理想导体面
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\sbf n}\times\sbf E=0\label{eq:1.30}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\sbf n}\cdot\sbf B=0\label{eq:1.31}
\end{equation}

\end_inset

式中
\begin_inset Formula $\sbf E$
\end_inset

和
\begin_inset Formula $\sbf B$
\end_inset

都是导体外部的场，
\begin_inset Formula $\hat{\sbf n}$
\end_inset

是导体的外法向单位矢量。在这种情况下，边界始终有面电流 
\begin_inset Formula $\sbf J_{s}=\hat{\sbf n}\times\sbf H$
\end_inset

 和面电荷 
\begin_inset Formula $\rho_{s}=\hat{\sbf n}\cdot\sbf D$
\end_inset

。
\end_layout

\begin_layout Remark
note。导体面上，
\begin_inset Formula $\sbf H$
\end_inset

只有切向分量。
\begin_inset Formula $n,H,J_{s}$
\end_inset

 组成右手系，
\begin_inset Formula 
\[
\left(\hat{\sbf n},\quad\hat{\sbf H},\quad\sbf J_{s}\right)
\]

\end_inset


\end_layout

\begin_layout Subsection
非理想导电面
\end_layout

\begin_layout Standard
\begin_inset Formula $\sbf E$
\end_inset

的
\series bold
横投影
\series default
 等于 
\begin_inset Formula $\sbf H$
\end_inset

的 叉矢量。
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\sbf E-\left(\hat{\sbf n}\cdot\sbf E\right)\hat{\sbf n}=\eta\,Z_{0}\,\hat{\sbf n}\times\sbf H\label{eq:1.32}
\end{equation}

\end_inset

或者 
\begin_inset Formula $\sbf E$
\end_inset

 的叉矢量等于 
\begin_inset Formula $\sbf H$
\end_inset

 的横投影。
\begin_inset Formula 
\begin{equation}
\hat{\sbf n}\times\sbf E=-\eta\,Z_{0}\,\left[\sbf H-\left(\hat{\sbf n}\cdot\sbf H\right)\hat{\sbf n}\right]\label{eq:1.33}
\end{equation}

\end_inset

其中
\begin_inset Formula $\eta=\sqrt{\mu_{r2}/\varepsilon_{r2}}$
\end_inset

为媒介
\begin_inset Formula $2$
\end_inset

的归一化特征阻抗。方程
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.32"
plural "false"
caps "false"
noprefix "false"

\end_inset

或
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.33"
plural "false"
caps "false"
noprefix "false"

\end_inset

称为阻抗边界条件。在二维情形下，当 
\begin_inset Formula $\sbf E=\hat{\sbf z}E_{z}$
\end_inset

时，可以写成
\begin_inset Formula 
\begin{equation}
\frac{\partial\sbf E_{z}}{\partial n}=j\,k_{0}\,\frac{\mu_{r1}}{\eta}E_{z}\label{eq:1.34}
\end{equation}

\end_inset

当
\begin_inset Formula $\sbf H=\hat{\sbf z}H_{z}$
\end_inset

时，可以写成
\begin_inset Formula 
\begin{equation}
\frac{\partial H_{z}}{\partial n}=j\,k_{0}\,\varepsilon_{r1}\,\eta\,H_{z}\label{eq:1.35}
\end{equation}

\end_inset

通常，第一种情形称为
\begin_inset Formula $E_{z}$
\end_inset

极化；第二种情形称为
\begin_inset Formula $H_{z}$
\end_inset

极化。
\end_layout

\begin_layout Section
辐射条件
\end_layout

\begin_layout Standard
当区域的外边界延伸至无穷远时，此区域被称为“无约束的”或“开放的”区域。同样为了得到问题的唯一解，在外边界处也必须确定一个条件，这种条件被称为辐射条件。
\end_layout

\begin_layout Subsection
索末菲辐射条件
\end_layout

\begin_layout Standard
假设
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\lim_{r\to\infty}r\left[\nabla\times\left(\begin{array}{c}
\sbf E\\
\sbf H
\end{array}\right)+j\,k_{0}\hat{\sbf r}\times\left(\begin{array}{c}
\sbf E\\
\sbf H
\end{array}\right)\right]=0\label{eq:1.36}
\end{equation}

\end_inset

式中，
\begin_inset Formula $r=\sqrt{x^{2}+y^{2}+z^{2}}$
\end_inset

。通常称方程
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.36"
plural "false"
caps "false"
noprefix "false"

\end_inset

式为一般三维场的索末菲（Sommerfield）辐射条件。对于二维场，索末菲辐射条件变成
\begin_inset Formula 
\begin{equation}
\lim_{\rho\to\infty}\sqrt{\rho}\left[\partial_{\rho}\left(\begin{array}{c}
E_{z}\\
H_{z}
\end{array}\right)+j\,k_{0}\left(\begin{array}{c}
E_{z}\\
H_{z}
\end{array}\right)\right]=0\label{eq:1.37}
\end{equation}

\end_inset

式中
\begin_inset Formula $\rho=\sqrt{x^{2}+y^{2}}$
\end_inset

。
\end_layout

\begin_layout Subsection
吸收边界条件
\end_layout

\begin_layout Standard
sd
\begin_inset Formula 
\begin{equation}
B_{m}\left(\begin{array}{c}
E_{z}\\
H_{z}
\end{array}\right)=\order{\rho^{-2m-1/2}},\quad m=1,2,3,\cdots\label{eq:1.38}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{align*}
 & B_{1}=\partial_{\rho}+j\,k_{0}+\frac{1}{2\rho}\\
 & B_{2}=\partial_{\rho}+j\,k_{0}+\frac{1}{2\rho}-\frac{1}{8\rho(1+j\,k_{0}\rho)}-\frac{1}{2\rho(1+j\,k_{0}\rho)}\partial_{\varphi}^{2}
\end{align*}

\end_inset


\end_layout

\begin_layout Chapter
有限元方法介绍
\end_layout

\begin_layout Section
边值问题的经典方法
\end_layout

\begin_layout Subsection
Galerkin 方法, 2.1.3,page 24
\end_layout

\begin_layout Standard
Galerkin 方法属于 加权残差方法一族（weighted residual methods）。如同名字，它通过对微分方程的残差作加权和，求寻求它的解。
\begin_inset Formula 
\begin{equation}
r=\mathcal{L}\tilde{\phi}-f\neq0.\label{eq:2.13}
\end{equation}

\end_inset


\begin_inset Formula $\tilde{\phi}$
\end_inset

最好的近似解，将使 
\begin_inset Formula $\Omega$
\end_inset

 上所有点的残差
\begin_inset Formula $r$
\end_inset

最小。在这种方式下，加权残差方法施加的条件是
\begin_inset Formula 
\begin{equation}
R_{i}=\int_{\Omega}w_{i}r\dd{\Omega}=0\label{2.14}
\end{equation}

\end_inset

其中 
\begin_inset Formula $R_{i}$
\end_inset

 表示加权残差积分，
\begin_inset Formula $w_{i}$
\end_inset

 是选定的权重函数。
\end_layout

\begin_layout Subsection
Galerkin 方法的解, 2.2.3, p 26
\end_layout

\begin_layout Section
一个简单的例子
\end_layout

\begin_layout Section
有限元方法的基本步骤
\end_layout

\begin_layout Standard
边值问题的有限元分析应包括下列基本步骤：
\end_layout

\begin_layout Enumerate
区域的离散或子域划分；
\end_layout

\begin_layout Enumerate
插值函数的选择
\end_layout

\begin_layout Enumerate
方程组的建立
\end_layout

\begin_layout Enumerate
方程组的求解。
\end_layout

\begin_layout Subsection
区域离散
\end_layout

\begin_layout Standard
全域被划分成许多小区域，用 
\begin_inset Formula $\Omega^{e}\left(e=1,2,3,\cdots,M\right)$
\end_inset

表示，这里 
\begin_inset Formula $M$
\end_inset

 表示子域总数，这些子域通常被称为单元。
\end_layout

\begin_layout Standard
基本单元：
\end_layout

\begin_layout Itemize
一维：线性单元
\end_layout

\begin_layout Itemize
二维：三角形单元
\end_layout

\begin_layout Itemize
三维：四面体单元
\end_layout

\begin_layout Standard
在多数有限元解中，问题是用与单元有关的 
\color blue
结点上的未知函数 
\begin_inset Formula $\Phi$
\end_inset


\color inherit
 表达的。例如线性单元有两个结点，每端点一个；线性三角形单元有三个结点，各顶点上一个。一个结点的完整描述应该包括：它的坐标值，局部编码，全局编码。局部编码表示它
在单元中的位置，全局编码表示它在整个系统中的位置。
\end_layout

\begin_layout Standard
有限元公式通常得到带状矩阵，其带宽由一个单元中两个结点的全局编码之差的最大值决定。通过适当的结点编码使得带宽最小，可以减少计算机的存储量和运算时间。
\end_layout

\begin_layout Subsection
插值函数的选择
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\tilde{\Phi}^{e}=\sum_{j=1}^{n}N_{j}^{e}\Phi_{j}^{e}=\left\{ N^{e}\right\} ^{T}\left\{ \Phi^{e}\right\} =\left\{ \Phi^{e}\right\} ^{T}\left\{ N^{e}\right\} \label{eq:jm2.51}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $n$
\end_inset

是单元中的结点数；
\begin_inset Formula $\Phi_{j}^{e}$
\end_inset

 是单元中 
\begin_inset Formula $j$
\end_inset

 结点的
\begin_inset Formula $\Phi$
\end_inset

值；
\begin_inset Formula $N_{j}^{e}$
\end_inset

 是插值函数，通常也称为展开函数或基函数。
\end_layout

\begin_layout Itemize
\begin_inset Formula $N_{j}^{e}$
\end_inset

 的最高阶被称为单元的阶。例如，若 
\begin_inset Formula $N_{j}^{e}$
\end_inset

 是线性函数，则单元 
\begin_inset Formula $e$
\end_inset

 是线性单元。
\end_layout

\begin_layout Itemize
函数
\begin_inset Formula $N_{j}^{e}$
\end_inset

 的重要特征是：
\color blue
它们只有在单元 
\begin_inset Formula $e$
\end_inset

 内才不为零，而在单元 
\begin_inset Formula $e$
\end_inset

 外均为零。
\end_layout

\begin_layout Subsection
方程组公式的建立
\end_layout

\begin_layout Subsubsection
Ritz 方法的求解公式
\end_layout

\begin_layout Subsubsection
Galerkin 方法的求解公式
\end_layout

\begin_layout Standard
有两类边界条件经常出现：一是狄利克雷（Dirichlet）边界条件，像 eq2.23 那样，它给出了边界处的 
\begin_inset Formula $\Phi$
\end_inset

值；
\begin_inset Formula 
\[
\left.\Phi\right|_{x=0}=0,\quad\left.\Phi\right|_{x=1}=1.
\]

\end_inset

另一类是齐次诺伊曼（Neumann）边界条件，它要求边界处 
\begin_inset Formula $\Phi$
\end_inset

 的法向导数为零。第一类边界是必要（essential）边界条件，它必须显式地强加在计算中；第二类边界条件通常在求解过程中隐含的自动满足，因此通常被称为
 自然边界条件（natural boundary condition）。
\end_layout

\begin_layout Standard
可以看出一般有三个步骤：
\end_layout

\begin_layout Itemize
首先应用 Ritz 或 Galerkin 方法写出单元方程 2.55 or 2.69 式。
\end_layout

\begin_layout Itemize
其次，将单元方程对所有单元求和，得到方程组，这个过程叫做组合。
\end_layout

\begin_layout Itemize
最后，应用边界条件来得到方程组地最终形式。
\end_layout

\begin_layout Remark
注意：在计算机实现此计算的过程中，这三个步骤通常不是分立的，相反，他们相互交织在一起。单元矩阵的生成和边界条件的强加通常发生在组合过程中。
\end_layout

\begin_layout Subsection
方程组的求解
\end_layout

\begin_layout Section
有限元公式的另一种表示
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\tilde{\Phi}=\sum_{e=1}^{M}\sum_{j=1}^{n}N_{j}^{e}\Phi_{j}^{e}.\label{eq:2.74}
\end{equation}

\end_inset

应用局部和全局编码间的关系，我们至少在原理上可将 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:2.74"
plural "false"
caps "false"
noprefix "false"

\end_inset

重新写成
\begin_inset Formula 
\begin{equation}
\tilde{\Phi}=\sum_{j=1}^{N}N_{j}^{g}\Phi_{j}\label{eq:2.75}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
式中 
\begin_inset Formula $N$
\end_inset

 表示结点总数；
\begin_inset Formula $N_{j}^{g}$
\end_inset

 表示 
\begin_inset Formula $\Phi_{j}$
\end_inset

 的展开函数，这里用商标 
\begin_inset Formula $g$
\end_inset

 强调有关下标 
\begin_inset Formula $j$
\end_inset

 是全局编码。
\end_layout

\begin_layout Itemize
显然，只有在与结点
\begin_inset Formula $j$
\end_inset

 相连的单元中，
\begin_inset Formula $N_{j}^{g}$
\end_inset

 才不为零。
\end_layout

\begin_layout Itemize
需要把 
\begin_inset Formula $N_{j}^{e}$
\end_inset

 展开到全域上，需要通过索引矩阵，将局部编码转换到全局编码。
\end_layout

\begin_layout Standard
本节公式和上节公式的主要差别在于应用局部和全局编码关系的阶段不同。在商界的公式推导中，他应用在组合过程中；而在本节公式的推导中，它应用在求给定结点的
 
\begin_inset Formula $N_{j}^{g}$
\end_inset

 的过程中。
\end_layout

\begin_layout Chapter
一维有限元分析
\end_layout

\begin_layout Section
边值问题
\end_layout

\begin_layout Section
变分公式
\end_layout

\begin_layout Section
有限元分析
\end_layout

\begin_layout Subsection
离散化和插值
\end_layout

\begin_layout Subsection
用 Ritz 方法建立公式
\end_layout

\begin_layout Subsubsection
狄利克雷边界条件的强加
\end_layout

\begin_layout Standard
所以，我们只需在 
\begin_inset Formula $x=0$
\end_inset

 处加上狄利克雷边界条件：
\begin_inset Formula $\left.\Phi\right|_{x=0}p$
\end_inset

。只要用 
\begin_inset Formula $\Phi_{1}=p$
\end_inset

 代替从 
\begin_inset Formula $\partial F/\partial\Phi_{1}=0$
\end_inset

 得出的第一个方程，即可简单实现边界条件的强加，或等价地令
\begin_inset Formula 
\begin{equation}
K_{11}=1,\quad b_{1}=p,\quad K_{1j}=0,\quad j=2,\cdots3,\cdots4,\cdots N\label{eq:3.60}
\end{equation}

\end_inset

这样替换后，上述例子中的新方程组变为
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{cccc}
1 & 0 & 0 & 0\\
K_{21} & K_{22} & K_{23} & K_{24}\\
K_{31} & K_{32} & K_{33} & K_{34}\\
K_{41} & K_{42} & K_{43} & K_{44}
\end{array}\right]\left\{ \begin{array}{c}
\Phi_{1}\\
\Phi_{2}\\
\Phi_{3}\\
\Phi_{4}
\end{array}\right\} =\left\{ \begin{array}{c}
p\\
b_{2}\\
b_{3}\\
b_{4}
\end{array}\right\} \label{eq:3.61}
\end{equation}

\end_inset

这种新方程组显然不再具有对称性。然而对称性可以减小计算机的内存需求和运行时间，为了恢复对称性，我们可以进一步修正
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:3.61"
plural "false"
caps "false"
noprefix "false"

\end_inset

式为：
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{cccc}
1 & 0 & 0 & 0\\
0 & K_{22} & K_{23} & K_{24}\\
0 & K_{32} & K_{33} & K_{34}\\
0 & K_{42} & K_{43} & K_{44}
\end{array}\right]\left\{ \begin{array}{c}
\Phi_{1}\\
\Phi_{2}\\
\Phi_{3}\\
\Phi_{4}
\end{array}\right\} =\left\{ \begin{array}{c}
p\\
b_{2}-K_{21}p\\
b_{3}-K_{31}p\\
b_{4}-K_{41}p
\end{array}\right\} \label{eq:3.62}
\end{equation}

\end_inset

实际上就是方程组的移项。从数值角度看，这等价于令
\begin_inset Formula 
\begin{equation}
b_{i}=b_{i}-K_{i1}p,\quad K_{i1}=0,\quad i=2,\cdots3,\cdots4,\cdots N\label{eq:3.63}
\end{equation}

\end_inset

可以看出，
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:3.62"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中确实已恢复了对称性，而方程组的解并不受影响，方程组也可以写成
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{ccc}
K_{22} & K_{23} & K_{24}\\
K_{32} & K_{33} & K_{34}\\
K_{42} & K_{43} & K_{44}
\end{array}\right]\left\{ \begin{array}{c}
\Phi_{2}\\
\Phi_{3}\\
\Phi_{4}
\end{array}\right\} =\left\{ \begin{array}{c}
b_{2}-K_{21}p\\
b_{3}-K_{31}p\\
b_{4}-K_{41}p
\end{array}\right\} \label{eq:3.64}
\end{equation}

\end_inset

这就是说，能够处理较小的方程组来得到相同的解。尤其在三维情况下，这种优点非常明显，因为这样可以消除许多方程。
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
ref JMJin P104：一般情况下，假设 
\begin_inset Formula $\Gamma_{1}$
\end_inset

 上有 
\begin_inset Formula $N_{1}$
\end_inset

 个结点，把结点它们的 全局编号 存储在矢量
\begin_inset Formula $\mathcal{B}(i)$
\end_inset

中；把给定的边界值存储在矢量 
\begin_inset Formula $p(i)$
\end_inset

 中。对线性方程组 施加第一类边界条件 的操作如下：
\end_layout

\begin_layout Itemize
对涉及边界结点的方程，即
\begin_inset Formula $K_{ij}$
\end_inset

的第
\begin_inset Formula $\mathcal{B}(i)$
\end_inset

行（
\begin_inset Formula $K_{ij}$
\end_inset

对称，所以也相当于列），处理成 平庸方程 
\begin_inset Formula $1*\Phi_{\mathcal{B}(i)}=p(i)$
\end_inset


\begin_inset Formula 
\[
b_{\mathcal{B}(i)}=p\left(i\right),\quad K_{\mathcal{B}(i),\mathcal{B}(i)}=1,\quad K_{\mathcal{B}(i),j}=0,\quad\text{for}\quad j\neq\mathcal{B}(i).
\]

\end_inset


\end_layout

\begin_layout Itemize
对其他不属于边界结点的方程进行移项，恢复对称性；把本行中 
\color blue
所有边界结点项
\color inherit
 移到右边的 
\begin_inset Formula $b$
\end_inset

 上：
\begin_inset Formula 
\[
b_{j}\to b_{j}-K_{j,\mathcal{B}(i)}p_{i}\left(i\right),\quad K_{j,\mathcal{B}(i)}=0\quad\text{for}\quad j\neq\mathcal{B}(i)
\]

\end_inset

其中 
\begin_inset Formula $i=1,2,3,\cdots,N_{1}$
\end_inset

。
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
用 Galerkin 方法建立公式
\end_layout

\begin_layout Subsection
方程组的求解
\end_layout

\begin_layout Section
金属衬底介质片对平面波的反射
\end_layout

\begin_layout Section
光滑凸形阻抗柱的散射
\end_layout

\begin_layout Section
高阶单元
\end_layout

\begin_layout Standard
线性单元（一阶形函数单元）的优点在于公式简单和方程组的带窄。主要缺点是精度差，对于一定的单元或结点数，解的收敛较慢。增加单元/结点数可以提高精度，但将牺牲计算时
间和内存。
\end_layout

\begin_layout Standard
获得较高精度而不增加结点数的另一种方法是应用高阶插值函数或给高阶单元。这种方法已被证明是非常有效的。高阶单元的主要缺点是：
\end_layout

\begin_layout Enumerate
公式复杂；
\end_layout

\begin_layout Enumerate
方程组的带宽增加。
\end_layout

\begin_layout Subsection
二次单元
\end_layout

\begin_layout Standard
高斯–勒让德求积（Gauss–Legendre quadrature）公式：
\begin_inset Formula 
\begin{equation}
\int_{-1}^{1}P\left(\xi\right)\dd{\xi}=\sum_{i=1}^{n}W_{i}P\left(\xi_{i}\right)\label{eq:3.123}
\end{equation}

\end_inset

可容易且精确地积分求出 3.120 和 3.121 式。式中 
\begin_inset Formula $\xi_{i}$
\end_inset

 表示取样点， 
\begin_inset Formula $W_{i}$
\end_inset

 是相关加权数。
\end_layout

\begin_layout Remark
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:3.123"
plural "false"
caps "false"
noprefix "false"

\end_inset

 的一个重要性质在于：如果多项式 
\begin_inset Formula $P\left(\xi\right)$
\end_inset

的次数 
\begin_inset Formula $\le p$
\end_inset

，那么若 
\begin_inset Formula $n\ge\left(p+1\right)/2$
\end_inset

，则可精确求出积分。因此对 3.120 和 3.121 中的积分，用 
\begin_inset Formula $n=3$
\end_inset

 即可得到精确结果，除非 
\begin_inset Formula $\beta$
\end_inset

 在单元内剧烈变化。
\end_layout

\begin_layout Subsection
三次单元
\end_layout

\begin_layout Standard
我们可验证它们确实是所需的，具有 
\begin_inset Formula $N_{j}^{e}\left(x_{i}^{e}\right)=\delta_{ij}$
\end_inset

 的函数。我们能用这种方法写出任意阶的插值函数。这种形式的多项式被称为 拉格朗日（Lagrange）插值多项式。
\end_layout

\begin_layout Chapter
二维有限元分析
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "chap:4"

\end_inset


\end_layout

\begin_layout Standard
page 57
\end_layout

\begin_layout Section
边值问题
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\sbf\nabla\left(\alpha\cdot\sbf\nabla\phi\right)+\beta\phi=f,\quad\left(x,y\right)\in\Omega.
\]

\end_inset

在二维情况下，边值问题即为
\begin_inset Formula 
\begin{equation}
\frac{\partial}{\partial x}\left(\alpha_{x}\frac{\partial\phi}{\partial x}\right)+\frac{\partial}{\partial y}\left(\alpha_{y}\frac{\partial\phi}{\partial y}\right)+\beta\phi=f,\quad\left(x,y\right)\in\Omega.\label{eq:4.1}
\end{equation}

\end_inset

其中 
\begin_inset Formula $\phi$
\end_inset

 是未知函数，参数
\begin_inset Formula $\alpha_{x}$
\end_inset


\begin_inset Formula $\alpha_{y}$
\end_inset


\begin_inset Formula $\beta$
\end_inset

与待求区域的物理性质有关；
\begin_inset Formula $f$
\end_inset

是源或者激励函数（excitation function）。通常的二维 Laplace 方程，Poisson 方程，或 Helmholtz 方程可以看作
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:4.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

的特殊形式。
\end_layout

\begin_layout Standard
需要考虑的边界条件为
\begin_inset Formula 
\begin{equation}
\phi=p\quad\text{on}\quad\Gamma_{1}\quad\text{essential}\label{eq:4.2}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\left(\alpha_{x}\frac{\partial\phi}{\partial x}\hat{x}+\alpha_{y}\frac{\partial\phi}{\partial y}\hat{y}\right)\cdot\hat{n}+\gamma\phi=q\quad\text{on}\quad\Gamma_{2}\quad\text{natural}\label{eq:4.3}
\end{equation}

\end_inset


\begin_inset Formula 
\[
\left(\hat{\sbf r}\cdot\sbf\alpha\nabla\phi\right)\cdot\sbf n+\gamma\phi=q
\]

\end_inset

其中 
\begin_inset Formula $\Gamma\left(=\Gamma_{1}+\Gamma_{2}\right)$
\end_inset

标记回路，它闭合区域 
\begin_inset Formula $\Omega$
\end_inset

。
\end_layout

\begin_layout Standard
当 
\begin_inset Formula $\gamma=q=0$
\end_inset

，称为 homogeneous Neumann 边界条件。
\begin_inset Formula 
\[
\left(\alpha_{x}\frac{\partial\phi}{\partial x}\hat{x}+\alpha_{y}\frac{\partial\phi}{\partial y}\hat{y}\right)\cdot\hat{n}=0
\]

\end_inset


\end_layout

\begin_layout Section
Variational formulation
\end_layout

\begin_layout Section
有限元分析
\end_layout

\begin_layout Subsection
区域离散
\end_layout

\begin_layout Subsection
单元插值
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\phi^{e}\left(x,y\right)=\sum_{j=1}^{3}N_{j}^{e}\left(x,y\right)\phi_{j}^{e}\label{eq:4.23}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
N_{j}^{e}\left(x,y\right)=\frac{1}{2\Delta^{e}}\left(a_{j}^{e}+b_{j}^{e}x+c_{j}^{e}y\right),\quad j=1,2,3\label{eq:4.24}
\end{equation}

\end_inset


\begin_inset Formula $L_{j}^{e}$
\end_inset

是线性三角形单元的插值函数。其中
\begin_inset Formula 
\begin{align}
 & a_{1}^{e}=x_{2}^{e}y_{3}^{e}-y_{2}^{e}x_{3}^{e}; &  & b_{1}^{e}=y_{2}^{e}-y_{3}^{e}; &  & c_{1}^{e}=x_{3}^{e}-x_{2}^{e}\nonumber \\
 & a_{2}^{e}=x_{3}^{e}y_{1}^{e}-y_{3}^{e}x_{1}^{e}; &  & b_{2}^{e}=y_{3}^{e}-y_{1}^{e}; &  & c_{2}^{e}=x_{1}^{e}-x_{3}^{e}\label{eq:4.24-1}\\
 & a_{3}^{e}=x_{1}^{e}y_{2}^{e}-y_{1}^{e}x_{2}^{e}; &  & b_{3}^{e}=y_{1}^{e}-y_{2}^{e}; &  & c_{3}^{e}=x_{2}^{e}-x_{1}^{e}\nonumber 
\end{align}

\end_inset

以及
\begin_inset Formula 
\[
\Delta^{e}=\frac{1}{2}\left|\begin{array}{ccc}
1 & x_{1}^{e} & y_{1}^{e}\\
1 & x_{2}^{e} & y_{2}^{e}\\
1 & x_{3}^{e} & y_{3}^{e}
\end{array}\right|=\frac{1}{2}\left(b_{1}^{e}c_{2}^{e}-b_{2}^{e}c_{1}^{e}\right)=\text{第}e\text{个单元的面积}.
\]

\end_inset

容易证明，插值函数具有性质
\begin_inset Formula 
\begin{equation}
N_{i}^{e}\left(x_{i}^{e},y_{j}^{e}\right)=\delta_{ij}=\begin{cases}
1 & i=j\\
0 & i\neq j.
\end{cases}\label{eq:4.25}
\end{equation}

\end_inset

因此在节点
\begin_inset Formula $i$
\end_inset

上，
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:4.23"
plural "false"
caps "false"
noprefix "false"

\end_inset

中的
\begin_inset Formula $\phi^{e}$
\end_inset

回到它的节点值 
\begin_inset Formula $\phi_{i}^{e}$
\end_inset

。
\end_layout

\begin_layout Standard
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\begin_inset Formula 
\[
\left|\begin{array}{ccc}
1 & x_{1}^{e} & y_{1}^{e}\\
1 & x_{2}^{e} & y_{2}^{e}\\
1 & x_{3}^{e} & y_{3}^{e}
\end{array}\right|=\left|\begin{array}{ccc}
1 & x_{1}^{e} & y_{1}^{e}\\
0 & x_{2}^{e}-x_{1}^{e} & y_{2}^{e}-y_{1}^{e}\\
0 & x_{3}^{e}-x_{1}^{e} & y_{3}^{e}-y_{1}^{e}
\end{array}\right|
\]

\end_inset

此行列式可以理解成 
\begin_inset Formula $z$
\end_inset

方向长度为
\begin_inset Formula $1$
\end_inset

的矢量，与 
\begin_inset Formula $x-y$
\end_inset

 平面上两个矢量的混合积，所以结果给出三角形的面积。
\end_layout

\end_inset


\end_layout

\begin_layout Remark
上述表达式的另一种形式为：考虑三角单元中的一点
\begin_inset Formula $P:\left(x,y\right)$
\end_inset

，与节点
\begin_inset Formula $2$
\end_inset

和
\begin_inset Formula $3$
\end_inset

定义的三角形的面积
\begin_inset Formula 
\begin{align}
\Delta_{1} & =\frac{1}{2}\left|\begin{array}{ccc}
1 & x & y\\
1 & x_{2}^{e} & y_{2}^{e}\\
1 & x_{3}^{e} & y_{3}^{e}
\end{array}\right|\nonumber \\
 & =\frac{1}{2}\left[\left(x_{2}^{e}y_{3}^{e}-x_{3}^{e}y_{2}^{e}\right)+x\left(y_{2}^{e}-y_{3}^{e}\right)+y\left(x_{3}^{e}-x_{2}^{e}\right)\right].\label{eq:4.155-1}
\end{align}

\end_inset

使用前文
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:4.24-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 定义的 
\begin_inset Formula $a_{j}^{e}$
\end_inset

，
\begin_inset Formula $b_{j}^{e}$
\end_inset

和
\begin_inset Formula $c_{j}^{e}$
\end_inset

，
\begin_inset Formula $\Delta_{1}$
\end_inset

可以写成
\begin_inset Formula 
\begin{equation}
\Delta_{1}=\frac{1}{2}\left(a_{1}^{e}+b_{1}^{e}x+c_{1}^{e}y\right).\label{eq:4.156-1}
\end{equation}

\end_inset

与
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:4.24"
plural "false"
caps "false"
noprefix "false"

\end_inset

比较，容易看出
\begin_inset Formula 
\begin{align*}
 & L_{1}^{e}=\frac{\Delta_{1}}{\Delta^{e}}=\frac{1}{2\Delta^{e}}\left(a_{1}^{e}+b_{1}^{e}x+c_{1}^{e}y\right),\\
 & L_{2}^{e}=\frac{\Delta_{2}}{\Delta^{e}}=\frac{1}{2\Delta^{e}}\left(a_{2}^{e}+b_{2}^{e}x+c_{2}^{e}y\right),\\
 & L_{3}^{e}=\frac{\Delta_{3}}{\Delta^{e}}=\frac{1}{2\Delta^{e}}\left(a_{3}^{e}+b_{3}^{e}x+c_{3}^{e}y\right).
\end{align*}

\end_inset


\end_layout

\begin_layout Subsection
Ritz 方法的公式 p57
\end_layout

\begin_layout Subsubsection
单元方程推导
\end_layout

\begin_layout Standard
矩阵 
\begin_inset Formula $\left[K^{e}\right]$
\end_inset

 的元素为
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
K_{ij}^{e}=\iint_{\Omega^{e}}\left(\alpha_{x}\frac{\partial N_{i}^{e}}{\partial x}\frac{\partial N_{j}^{e}}{\partial x}+\alpha_{y}\frac{\partial N_{i}^{e}}{\partial y}\frac{\partial N_{j}^{e}}{\partial y}+\beta N_{i}^{e}N_{j}^{e}\right)\dd{x}\dd{y},\quad i,j=1,2,3\label{eq:4.30}
\end{equation}

\end_inset

而矢量 
\begin_inset Formula $\left\{ b^{e}\right\} $
\end_inset

则表示为
\begin_inset Formula 
\begin{equation}
b_{i}^{e}=\iint_{\Omega^{e}}fN_{i}^{e}\dd{x}\dd{y},\quad i,j=1,2,3\label{eq:4.31}
\end{equation}

\end_inset

显然 
\begin_inset Formula $\left[K^{e}\right]$
\end_inset

 是对称矩阵。现在假设系数 
\begin_inset Formula $\alpha_{x}$
\end_inset

，
\begin_inset Formula $\alpha_{y}$
\end_inset

，
\begin_inset Formula $\beta$
\end_inset

和源函数
\begin_inset Formula $f$
\end_inset

在每个单元是常数，分别表示为 
\begin_inset Formula $\alpha_{x}^{e}$
\end_inset

，
\begin_inset Formula $\alpha_{y}^{e}$
\end_inset

，
\begin_inset Formula $\beta^{e}$
\end_inset

和 
\begin_inset Formula $f^{e}$
\end_inset

，则
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:4.30"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:4.31"
plural "false"
caps "false"
noprefix "false"

\end_inset

可以解析计算。特别地，注意到公式[1]
\begin_inset Formula 
\begin{equation}
\iint_{\Omega^{e}}\left(N_{1}^{e}\right)^{l}\left(N_{2}^{e}\right)^{m}\left(N_{3}^{e}\right)^{n}\dd{x}\dd{y}=\frac{l!m!n!}{\left(l+m+n+2\right)!}2\Delta^{e}.\label{eq:4.32}
\end{equation}

\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:4.30"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:4.31"
plural "false"
caps "false"
noprefix "false"

\end_inset

变成
\begin_inset Formula 
\begin{align}
K_{ij}^{e} & =\frac{1}{4\Delta^{e}}\left(\alpha_{x}^{e}b_{i}^{e}b_{j}^{e}+\alpha_{y}^{e}c_{i}^{e}c_{j}^{e}\right)+\frac{\Delta^{e}}{12}\beta^{e}\left(1+\delta_{ij}\right)\label{eq:4.33}\\
b_{i}^{e} & =\frac{\Delta^{e}}{3}f^{e}.\label{4.34}
\end{align}

\end_inset

（对于对角元，即
\begin_inset Formula $l\text{ or }m\text{ or }n\text{ or }2$
\end_inset

，可以用 
\begin_inset Formula $\delta_{ij}$
\end_inset

 表示）。
\end_layout

\begin_layout Standard
另一方面，如果 
\begin_inset Formula $\alpha_{x}$
\end_inset

，
\begin_inset Formula $\alpha_{y}$
\end_inset

，
\begin_inset Formula $\beta$
\end_inset

和 
\begin_inset Formula $f$
\end_inset

 在单元内不是常数，我们还是可以使用上面的结果，只需把 
\begin_inset Formula $\alpha_{x}^{e}$
\end_inset

，
\begin_inset Formula $\alpha_{y}^{e}$
\end_inset

，
\begin_inset Formula $\beta^{e}$
\end_inset

和 
\begin_inset Formula $f^{e}$
\end_inset

替换成单元上的平均值。也可以数值计算 
\begin_inset Formula $K_{ij}^{e}$
\end_inset

 和 
\begin_inset Formula $b_{i}^{e}$
\end_inset

，通常单元已经划分的足够小从而不必用数值方法，使用前一种方法就足够了。
\end_layout

\begin_layout Subsubsection
方程组的组合
\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $e$
\end_inset

单元
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n(1,e)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n(2,e)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n(3,e)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $5$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $5$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $5$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $6$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
单元编号
\begin_inset Formula $+$
\end_inset

节点局域编号
\begin_inset Formula $\to$
\end_inset

全局编号的查询表
\begin_inset CommandInset label
LatexCommand label
name "tab:jm4.21"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Graphics
	filename inset/FEMEM-4.2.pdf
	lyxscale 60
	scale 50

\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout

\backslash
[Delta] = {0, 0.05}; 
\backslash
[Delta]2 = {0.05, 0}; p1 = {-1, 0}; p3 = {-2, -2.2}; pts = {p1, {-2, -1},
 {-2, -1.5}, p3}; p6 = {1.5, -2.2}; p5 = (p3 + p6)/2; p2 = (p1 + p3)/2 + {-0.23,
 0.18}; p4 = (p1 + p6)/2; Graphics[{ BezierCurve[pts], , Black, Line[{p3,
 p5, p6, p4, p1}], Line[{p5, p4, p2, p5}] , FontSize -> 20 , Text["1", p1
 + 2 
\backslash
[Delta]], Text["5", p5 - 2 
\backslash
[Delta]] , Text["3", p3 - 2 
\backslash
[Delta]2], Text["6", p6 + 2 
\backslash
[Delta]] , Text["2", p2 - 2 
\backslash
[Delta]2], Text["4", p4 + 2 
\backslash
[Delta]] , Text["1", (p1 + p2 + p4)/3], Text["4", (p4 + p5 + p6)/3] , Text["2",
 (p2 + p4 + p5)/3], Text["3", (p2 + p3 + p5)/3] }]
\end_layout

\end_inset


\end_layout

\begin_layout Standard
这相当于将 
\begin_inset Formula $\left[K^{(1)}\right]$
\end_inset

（单元矩阵） 的每个元素加到 
\begin_inset Formula $[K]$
\end_inset

（全局矩阵）的适当元素上。为此我们首先考虑 
\begin_inset Formula $K_{11}^{(1)}$
\end_inset

，各数字的含义是：
\begin_inset Formula 
\[
K_{\text{节点局域编号，节点局域编号}}^{(\text{单元号})}
\]

\end_inset

参考
\begin_inset CommandInset ref
LatexCommand eqref
reference "tab:jm4.21"
plural "false"
caps "false"
noprefix "false"

\end_inset

 给出的联系数组，我们发现 
\begin_inset Formula $n(\text{节点}1,\text{单元}1)=2$
\end_inset

，即 单元 
\begin_inset Formula $1$
\end_inset

 的 节点
\begin_inset Formula $1$
\end_inset

 对应的全局编号是 
\begin_inset Formula $2$
\end_inset

；
\begin_inset Formula 
\[
\text{局域编号：}K_{11}^{(1)}\quad\Rightarrow\quad\text{全局编号：}K_{22}
\]

\end_inset

所以，我们将 
\begin_inset Formula $K_{11}^{(1)}$
\end_inset

 加到 
\begin_inset Formula $K_{22}$
\end_inset

 上。接着考虑 
\begin_inset Formula $K_{12}^{(1)}$
\end_inset

，再参考 
\begin_inset CommandInset ref
LatexCommand eqref
reference "tab:jm4.21"
plural "false"
caps "false"
noprefix "false"

\end_inset

 式，我们发现 
\begin_inset Formula $n(2,1)$
\end_inset

=4，因此将 
\begin_inset Formula $K_{12}^{(1)}$
\end_inset

 加到 
\begin_inset Formula $K_{24}$
\end_inset

 上。显然这种过程的一般规则是将 
\begin_inset Formula $K_{ij}^{e}$
\end_inset

 加到 
\begin_inset Formula $K_{{\color{blue}n(i,e)},n(j,e)}$
\end_inset

上，
\begin_inset Formula ${\color{blue}n(i,e)}$
\end_inset

 表示索引转换矩阵。
\end_layout

\begin_layout Standard
按照这种步骤，将 
\begin_inset Formula $[K^{(1)}]$
\end_inset

 的九个矩阵元素加到 
\begin_inset Formula $[K]$
\end_inset

 上后，得到
\begin_inset Formula 
\begin{equation}
[K]=\left[\begin{array}{cccccc}
K_{33}^{(1)} & K_{31}^{(1)} & 0 & K_{32}^{(1)} & 0 & 0\\
K_{13}^{(1)} & K_{11}^{(1)} & 0 & K_{12}^{(1)} & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0\\
K_{23}^{(1)} & K_{21}^{(1)} & 0 & K_{22}^{(1)} & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0
\end{array}\right]\label{eq:jm4.38}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
最后，将 
\begin_inset Formula $[K^{(4)}]$
\end_inset

 加到 
\begin_inset Formula $[K]$
\end_inset

 上后，得到
\begin_inset Formula 
\begin{equation}
[K]=\left[\begin{array}{cccccc}
K_{33}^{(1)} & K_{31}^{(1)} & 0 & K_{32}^{(1)} & 0 & 0\\
K_{13}^{(1)} & K_{11}^{(1)}+K_{33}^{(2)}+K_{33}^{(3)} & K_{31}^{(3)} & K_{12}^{(1)}+K_{32}^{(2)} & K_{31}^{(2)}+K_{32}^{(3)} & 0\\
0 & K_{13}^{(3)} & K_{11}^{(3)} & 0 & K_{12}^{(3)} & 0\\
K_{23}^{(1)} & K_{21}^{(1)}+K_{23}^{(2)} & 0 & K_{22}^{(1)}+K_{22}^{(2)}+K_{33}^{(4)} & K_{21}^{(2)}+K_{31}^{(4)} & K_{32}^{(4)}\\
0 & K_{13}^{(2)}+K_{23}^{(3)} & K_{21}^{(3)} & K_{12}^{(2)}+K_{13}^{(4)} & K_{11}^{(2)}+K_{22}^{(3)}+K_{11}^{(4)} & K_{12}^{(4)}\\
0 & 0 & 0 & K_{23}^{(4)} & K_{21}^{(4)} & K_{22}^{(4)}
\end{array}\right]\label{eq:4.40b}
\end{equation}

\end_inset

我们鼓励读者完成上述过程，并验证
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:jm4.38"
plural "false"
caps "false"
noprefix "false"

\end_inset

~
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:4.40b"
plural "false"
caps "false"
noprefix "false"

\end_inset

式。按照同样的步骤，将每个
\begin_inset Formula $b_{i}^{e}$
\end_inset

加到
\begin_inset Formula $b_{n(i,e)}$
\end_inset

上，我们能组成
\begin_inset Formula $\{b\}$
\end_inset

，最终结果为
\begin_inset Formula 
\begin{equation}
\{b\}=\left\{ \begin{array}{c}
b_{3}^{(1)}\\
b_{1}^{(1)}+b_{3}^{(2)}+b_{3}^{(3)}\\
b_{1}^{(3)}\\
b_{2}^{(1)}+b_{2}^{(2)}+b_{3}^{(4)}\\
b_{1}^{(2)}+b_{2}^{(3)}+b_{1}^{(4)}\\
b_{2}^{(4)}
\end{array}\right\} \label{eq:4.42}
\end{equation}

\end_inset

显然，对具有 
\begin_inset Formula $M$
\end_inset

 个单元和 
\begin_inset Formula $N$
\end_inset

 个结点的一般问题，也能够照此执行结合过程。
\end_layout

\begin_layout Remark
在程序上，对每个单元进行迭代时：
\end_layout

\begin_layout Enumerate
将计算所得 单元的局域刚度矩阵 存储在 Ke 变量中；
\end_layout

\begin_layout Enumerate
观察 
\begin_inset CommandInset ref
LatexCommand eqref
reference "tab:jm4.21"
plural "false"
caps "false"
noprefix "false"

\end_inset

 易知，每个单元需要一个长度为 
\begin_inset Formula $N$
\end_inset

（单元节点总数） 的数组，存放全局编号，对应程序中的变量 LV。
\end_layout

\begin_layout Enumerate
使用 SparseMat<double>::InsertSymMatrix(LV,Ke) 进行组装。
\end_layout

\begin_layout Enumerate
索引转换矩阵
\begin_inset Formula ${\color{blue}n(i,e)}$
\end_inset

的信息，可以从 网格文件 mesh.dat 中拿到。例如对于 Tri3 （线性三角形）单元，Tri3单元列表形如：
\begin_inset Formula 
\[
\begin{array}{cccc}
0 & \{0 & 5 & 6\}\\
1 & \{1 & 4 & 8\}\\
2 & \{2 & 8 & 7\}\\
3 & \{5 & 8 & 2\}
\end{array}
\]

\end_inset

左边一列是单元编号，即
\begin_inset Formula ${\color{blue}n(i,e)}$
\end_inset

 中的
\begin_inset Formula $e$
\end_inset

；右边的第
\begin_inset Formula $1,2,3$
\end_inset

（即
\begin_inset Formula ${\color{blue}n(i,e)}$
\end_inset

 中的
\begin_inset Formula $i$
\end_inset

）个编号按固定次序，分别是三角形三个顶点的全局编号，即
\begin_inset Formula ${\color{blue}n(i,e)}$
\end_inset

 中的
\begin_inset Formula $n$
\end_inset

。所以若迭代单元编号，再迭代单元的局域
\begin_inset Formula $i,j$
\end_inset

指标（局域节点编号），通过 单元列表，即可求出 
\begin_inset Formula $n(i,e)$
\end_inset

。
\end_layout

\begin_layout Subsubsection
考虑第三类边界条件
\end_layout

\begin_layout Subsubsection
狄利克雷边界条件的强加
\end_layout

\begin_layout Exercise
本练习的目的是推导
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:4.32"
plural "false"
caps "false"
noprefix "false"

\end_inset

。第一步，证明变换
\begin_inset Formula 
\[
\begin{cases}
\xi=N_{1}^{e}\left(x,y\right)\\
\eta=N_{2}^{e}\left(x,y\right)
\end{cases}
\]

\end_inset

将 图4.3 的三角形映射到 
\begin_inset Formula $\xi\eta$
\end_inset

–平面的直角三角形。第二步，证明
\begin_inset Formula 
\[
N_{3}^{e}\left(x,y\right)=1-\xi-\eta,\quad\dd{x}\dd{y}=2\Delta^{e}\dd{\xi}\dd{\eta}.
\]

\end_inset

因此
\begin_inset Formula 
\[
\iint_{\Omega^{e}}\left(N_{1}^{e}\right)^{l}\left(N_{2}^{e}\right)^{m}\left(N_{3}^{e}\right)^{n}\dd{x}\dd{y}=2\Delta^{e}\int_{0}^{1}\xi^{l}\int_{0}^{1-\xi}\eta^{m}\left(1-\xi-\eta\right)^{n}\dd{\xi}\dd{\eta}.
\]

\end_inset

计算此积分即得到
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:4.32"
plural "false"
caps "false"
noprefix "false"

\end_inset

。
\end_layout

\begin_layout Solution
代入
\begin_inset Formula 
\begin{align*}
 & N_{1}^{e}=\frac{\Delta_{1}}{\Delta^{e}}=\frac{1}{\Delta^{e}}\frac{a_{1}^{e}+b_{1}^{e}x+c_{1}^{e}y}{2}=1-\xi-\eta,\\
 & N_{2}^{e}=\frac{\Delta_{2}}{\Delta^{e}}=\frac{1}{\Delta^{e}}\frac{a_{2}^{e}+b_{2}^{e}x+c_{2}^{e}y}{2}=\xi,\\
 & N_{3}^{e}=\frac{\Delta_{3}}{\Delta^{e}}=\frac{1}{\Delta^{e}}\frac{a_{3}^{e}+b_{3}^{e}x+c_{3}^{e}y}{2}=\eta.
\end{align*}

\end_inset

以及坐标变换矩阵
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:4.161"
plural "false"
caps "false"
noprefix "false"

\end_inset


\begin_inset Formula 
\[
\left\{ \begin{array}{c}
1\\
x\\
y
\end{array}\right\} =\left[\begin{array}{ccc}
1 & 1 & 1\\
x_{1}^{e} & x_{2}^{e} & x_{3}^{e}\\
y_{1}^{e} & y_{2}^{e} & y_{3}^{e}
\end{array}\right]\left\{ \begin{array}{c}
1-\xi-\eta\\
\xi\\
\eta
\end{array}\right\} ,\quad\left\{ \begin{array}{c}
L_{1}^{e}\\
L_{2}^{e}\\
L_{3}^{e}
\end{array}\right\} =\frac{1}{2\Delta^{e}}\left[\begin{array}{ccc}
a_{1}^{e} & b_{1}^{e} & c_{1}^{e}\\
a_{2}^{e} & b_{2}^{e} & c_{2}^{e}\\
a_{3}^{e} & b_{3}^{e} & c_{3}^{e}
\end{array}\right]\left\{ \begin{array}{c}
1\\
x\\
y
\end{array}\right\} .
\]

\end_inset

得到：
\begin_inset Formula 
\begin{align*}
x & =x_{1}^{e}\left(1-\xi-\eta\right)+x_{2}^{e}\xi+x_{3}^{e}\eta=\xi\left(x_{2}^{e}-x_{1}^{e}\right)+\eta\left(x_{3}^{e}-x_{1}^{e}\right)+x_{1}^{e}\\
y & =y_{1}^{e}\left(1-\xi-\eta\right)+y_{2}^{e}\xi+y_{3}^{e}\eta=\cdots\text{同理}
\end{align*}

\end_inset

考虑到前文定义的一些系数
\begin_inset Formula 
\begin{align}
 & a_{1}^{e}=x_{2}^{e}y_{3}^{e}-y_{2}^{e}x_{3}^{e}; &  & b_{1}^{e}=y_{2}^{e}-y_{3}^{e}; &  & c_{1}^{e}=x_{3}^{e}-x_{2}^{e}\nonumber \\
 & a_{2}^{e}=x_{3}^{e}y_{1}^{e}-y_{3}^{e}x_{1}^{e}; &  & b_{2}^{e}=y_{3}^{e}-y_{1}^{e}; &  & c_{2}^{e}=x_{1}^{e}-x_{3}^{e}\label{eq:4.24-1-1}\\
 & a_{3}^{e}=x_{1}^{e}y_{2}^{e}-y_{1}^{e}x_{2}^{e}; &  & b_{3}^{e}=y_{1}^{e}-y_{2}^{e}; &  & c_{3}^{e}=x_{2}^{e}-x_{1}^{e}\nonumber 
\end{align}

\end_inset

从而表示为，
\begin_inset Formula 
\[
\left[\begin{array}{c}
x\\
y
\end{array}\right]=\left[\begin{array}{c}
c_{3}^{e}\xi-c_{2}^{e}\eta+x_{1}^{e}\\
-b_{3}^{e}\xi+b_{2}^{e}\eta+y_{1}^{e}
\end{array}\right]
\]

\end_inset

所以 Jacobi 矩阵为
\begin_inset Formula 
\begin{align*}
\frac{\partial\left(x,y\right)}{\partial\left(\xi,\eta\right)} & =\left[\begin{array}{cc}
c_{3}^{e} & -c_{2}^{e}\\
-b_{3}^{e} & b_{2}^{e}
\end{array}\right]=b_{2}^{e}c_{3}^{e}-b_{3}^{e}c_{2}^{e}\\
\det J & =2{\color{blue}\frac{1}{2}\left(b_{2}^{e}c_{3}^{e}-b_{3}^{e}c_{2}^{e}\right)}=2{\color{blue}\Delta^{e}}.
\end{align*}

\end_inset


\end_layout

\begin_layout Solution
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
总结
\begin_inset Formula 
\begin{align*}
 & \left[\begin{array}{c}
x\\
y
\end{array}\right]=\left[\begin{array}{cc}
c_{3}^{e} & -c_{2}^{e}\\
-b_{3}^{e} & b_{2}^{e}
\end{array}\right]\left[\begin{array}{c}
\xi\\
\eta
\end{array}\right]+\left[\begin{array}{c}
x_{1}^{e}\\
y_{1}^{e}
\end{array}\right],\\
 & \left[\begin{array}{c}
\xi\\
\eta
\end{array}\right]=\frac{1}{2\Delta^{e}}\left\{ \left[\begin{array}{cc}
b_{2}^{e} & c_{2}^{e}\\
b_{3}^{e} & c_{3}^{e}
\end{array}\right]\left[\begin{array}{c}
x\\
y
\end{array}\right]+\left[\begin{array}{c}
a_{2}^{e}\\
a_{3}^{e}
\end{array}\right]\right\} ,\\
 & \frac{\partial\left(x,y\right)}{\partial\left(\xi,\eta\right)}=2\Delta^{e}.
\end{align*}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Solution
从 
\begin_inset Formula $\left(x,y\right)\to\left(\xi,\eta\right)$
\end_inset

的坐标变换，如果代入三个顶点的坐标 ：
\begin_inset Formula $\left(x_{1},y_{1}\right)\cdots$
\end_inset

 ，则结果为
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
a1 := x2 y3 - y2 x3; a2 := x3 y1 - y3 x1; a3 := x1 y2 - y1 x2;(*------------*)
 b1 := y2 - y3; b2 := y3 - y1; b3 := y1 - y2; (*------------*) c1 := x3
 - x2; c2 := x1 - x3; c3 := x2 - x1; 
\backslash
[CapitalDelta]e := 1/2 (b1 c2 - b2 c1); (*coordinate transformation*) toxy[
\backslash
[Xi]_, 
\backslash
[Eta]_] := {{c3, -c2}, {-b3, b2}} .
 {
\backslash
[Xi], 
\backslash
[Eta]} + {x1, y1}; to
\backslash
[Xi]
\backslash
[Eta][x_, y_] := {{b2, c2}, {b3, c3}} .
 {x, y} + {a2, a3};(*test*) {2 
\backslash
[CapitalDelta]e, to
\backslash
[Xi]
\backslash
[Eta][x1, y1], to
\backslash
[Xi]
\backslash
[Eta][x2, y2], to
\backslash
[Xi]
\backslash
[Eta][x3, y3]} // Simplify // TableForm
\end_layout

\end_inset


\begin_inset Formula 
\begin{align*}
 & \left(x_{1},y_{1}\right)\to\left(\xi=0,\eta=0\right)\\
 & \left(x_{2},y_{2}\right)\to\left(\xi=1,\eta=0\right)\\
 & \left(x_{3},y_{3}\right)\to\left(\xi=0,\eta=1\right)
\end{align*}

\end_inset

即二维不规则三角元经过坐标变换后，变成了标准直角三角形；直角位于坐标原点。
\end_layout

\begin_layout Section
Quadratic 三角单元
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename inset/quadratic-triangular.png
	scale 50

\end_inset


\end_layout

\begin_layout Standard
quadratic triangular element 的 elemental matrix 是 
\begin_inset Formula $6\times6$
\end_inset

 矩阵，它的元素是
\begin_inset Formula 
\begin{align}
K_{ij} & =\iint_{\Omega^{e}}\left(\alpha_{x}\frac{\partial N_{i}^{e}}{\partial x}\frac{\partial N_{j}^{e}}{\partial x}+\alpha_{y}\frac{\partial N_{i}^{e}}{\partial y}\frac{\partial N_{j}^{e}}{\partial y}+\beta N_{i}^{e}N_{j}^{e}\right)\dd{x}\dd{y}\nonumber \\
 & i,j=1,2,3,\cdots6.\label{eq:4.151}
\end{align}

\end_inset

类似地，列 
\begin_inset Formula $\left\{ b^{e}\right\} $
\end_inset

 的元素为
\begin_inset Formula 
\begin{equation}
b_{i}^{e}=\iint_{\Omega^{e}}fN_{i}^{e}\dd{x}\dd{y},\quad i,j=1,2,3,\cdots6.\label{eq:4.152}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
4.7.1 Quadratic Triangular Elements
\end_layout

\begin_layout Standard
page 83
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
L_{j}^{e}\left(x,y\right)=\frac{1}{2\Delta^{e}}\left(a_{j}^{e}+b_{j}^{e}x+c_{j}^{e}y\right),\quad j=1,2,3\label{eq:4.149}
\end{equation}

\end_inset

其中 
\begin_inset Formula $a_{j}^{e}$
\end_inset


\begin_inset Formula $b_{j}^{e}$
\end_inset


\begin_inset Formula $c_{j}^{e}$
\end_inset

和 
\begin_inset Formula $\Delta^{e}$
\end_inset

的定义和（4.24）中的相同。
\end_layout

\begin_layout Subsection
4.7.2 构建插值函数
\end_layout

\begin_layout Standard
page 84
\end_layout

\begin_layout Standard
上述的方法可以用于构建任意阶单元的插值函数，然而有必要寻找一种简单的方法。下面的方法基于 Lagrangian interpolation polynomial
s。再次观察
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:4.149"
plural "false"
caps "false"
noprefix "false"

\end_inset

中定义的 
\begin_inset Formula $L_{j}^{e}$
\end_inset

。
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename inset/FEMEM-4.28.png
	scale 50

\end_inset


\end_layout

\begin_layout Standard
考虑三角单元中的一点
\begin_inset Formula $P$
\end_inset

，由点
\begin_inset Formula $P$
\end_inset

和节点
\begin_inset Formula $2$
\end_inset

和
\begin_inset Formula $3$
\end_inset

定义的三角形的面积为
\begin_inset Formula 
\begin{align}
\Delta_{1} & =\frac{1}{2}\left|\begin{array}{ccc}
1 & x & y\\
1 & x_{2}^{e} & y_{2}^{e}\\
1 & x_{3}^{e} & y_{3}^{e}
\end{array}\right|\nonumber \\
 & =\frac{1}{2}\left[\left(x_{2}^{e}y_{3}^{e}-x_{3}^{e}y_{2}^{e}\right)+x\left(y_{2}^{e}-y_{3}^{e}\right)+y\left(x_{3}^{e}-x_{2}^{e}\right)\right].\label{eq:4.155}
\end{align}

\end_inset

使用前文
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:4.24-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 定义的 
\begin_inset Formula $a_{j}^{e}$
\end_inset

，
\begin_inset Formula $b_{j}^{e}$
\end_inset

和
\begin_inset Formula $c_{j}^{e}$
\end_inset

，
\begin_inset Formula $\Delta_{1}$
\end_inset

可以写成
\begin_inset Formula 
\begin{equation}
\Delta_{1}=\frac{1}{2}\left(a_{1}^{e}+b_{1}^{e}x+c_{1}^{e}y\right).\label{eq:4.156}
\end{equation}

\end_inset

与
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:4.149"
plural "false"
caps "false"
noprefix "false"

\end_inset


\begin_inset Formula 
\[
L_{j}^{e}\left(x,y\right)=\frac{1}{2\Delta^{e}}\left(a_{j}^{e}+b_{j}^{e}x+c_{j}^{e}y\right),\quad j=1,2,3
\]

\end_inset

比较，容易看出
\begin_inset Formula 
\begin{equation}
L_{1}^{e}=\frac{\Delta_{1}}{\Delta^{e}}=\frac{1}{2\Delta^{e}}\left(a_{1}^{e}+b_{1}^{e}x+c_{1}^{e}y\right).\label{eq:4.157}
\end{equation}

\end_inset

类似地，我们发现
\begin_inset Formula 
\begin{equation}
L_{2}^{e}=\frac{\Delta_{2}}{\Delta^{e}}=\frac{1}{2\Delta^{e}}\left(a_{2}^{e}+b_{2}^{e}x+c_{2}^{e}y\right).\label{eq:4.158}
\end{equation}

\end_inset

以及
\begin_inset Formula 
\begin{equation}
L_{3}^{e}=\frac{\Delta_{3}}{\Delta^{e}}=\frac{1}{2\Delta^{e}}\left(a_{3}^{e}+b_{3}^{e}x+c_{3}^{e}y\right).\label{eq:4.159}
\end{equation}

\end_inset

其中
\begin_inset Formula $\Delta_{2}$
\end_inset

标记由点
\begin_inset Formula $P$
\end_inset

和节点
\begin_inset Formula $3$
\end_inset

，节点
\begin_inset Formula $1$
\end_inset

定义的三角形，
\begin_inset Formula $\Delta_{3}$
\end_inset

标记由点
\begin_inset Formula $P$
\end_inset

和节点
\begin_inset Formula $1,2$
\end_inset

定义的三角形。由于点
\begin_inset Formula $P$
\end_inset

的选取完全确定了
\begin_inset Formula $L_{1}^{e}$
\end_inset

，
\begin_inset Formula $L_{2}^{e}$
\end_inset

和
\begin_inset Formula $L_{3}^{e}$
\end_inset

，所以也可以反过来，用后者定义一个唯一点
\begin_inset Formula $P$
\end_inset

，由此也把 
\begin_inset Formula $\left(L_{1}^{e},L_{2}^{e},L_{3}^{e}\right)$
\end_inset

 称为面积坐标。在文献中，它们也被称为 
\series bold
自然或单形坐标
\series default
（simplex coordinates）。
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:4.157"
plural "false"
caps "false"
noprefix "false"

\end_inset

–
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:4.159"
plural "false"
caps "false"
noprefix "false"

\end_inset

可以紧凑地写成
\begin_inset Formula 
\begin{equation}
\left\{ \begin{array}{c}
L_{1}^{e}\\
L_{2}^{e}\\
L_{3}^{e}
\end{array}\right\} =\frac{1}{2\Delta^{e}}\left[\begin{array}{ccc}
a_{1}^{e} & b_{1}^{e} & c_{1}^{e}\\
a_{2}^{e} & b_{2}^{e} & c_{2}^{e}\\
a_{3}^{e} & b_{3}^{e} & c_{3}^{e}
\end{array}\right]\left\{ \begin{array}{c}
1\\
x\\
y
\end{array}\right\} \label{eq:4.160}
\end{equation}

\end_inset


\color blue

\begin_inset Formula $L_{j}^{e}$
\end_inset

正好是线性三角形单元的插值函数。
\color inherit
易得逆变换矩阵
\begin_inset Formula 
\begin{equation}
\left\{ \begin{array}{c}
1\\
x\\
y
\end{array}\right\} =\left[\begin{array}{ccc}
1 & 1 & 1\\
x_{1}^{e} & x_{2}^{e} & x_{3}^{e}\\
y_{1}^{e} & y_{2}^{e} & y_{3}^{e}
\end{array}\right]\left\{ \begin{array}{c}
L_{1}^{e}\\
L_{2}^{e}\\
L_{3}^{e}
\end{array}\right\} .\label{eq:4.161}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
此坐标变换把 
\begin_inset Formula $\left(x,y\right)$
\end_inset

 平面上的任意形状三角形，变换到 
\begin_inset Formula $L_{i}$
\end_inset

 平面上的 等腰直角三角形。
\end_layout

\begin_layout Subsection
4.7.3 数值积分
\end_layout

\begin_layout Standard
ref: The finite element method in electromagnetics; JianMing Jin; 4.7.3 page
 148 (87)
\end_layout

\begin_layout Standard
此外， 可以借助数值积分方法。经常使用的数值积分方案是 Gauss quadrature，在 Sect 3.6 中讨论了一维积分的方法。对于在三角形单元上的积分，
文献[9]中证明了
\begin_inset Formula 
\begin{equation}
\iint_{\Omega^{e}}F\left(L_{1}^{e},L_{2}^{e},L_{3}^{e}\right)\dd{x}\dd{y}=\sum_{i=1}^{m}F\left(L_{1i}^{e},L_{2i}^{e},L_{3i}^{e}\right)W_{i}\Delta^{e}\label{eq:4.164}
\end{equation}

\end_inset

其中 
\begin_inset Formula $\left(L_{1i}^{e},L_{2i}^{e},L_{3i}^{e}\right)$
\end_inset

 表示采样点（sampling points），
\begin_inset Formula $W_{i}$
\end_inset

 表示权重，在表 4.1中给出；
\begin_inset Formula $\Delta^{e}$
\end_inset

表示
\begin_inset Formula $\left(x,y\right)$
\end_inset

坐标空间中三角元的面积，来自于坐标变换的雅可比行列式。
\end_layout

\begin_layout Standard
记被积函数的 polynomial degree 为 
\begin_inset Formula $p$
\end_inset

：
\end_layout

\begin_layout Enumerate
若 
\begin_inset Formula $p\le1$
\end_inset

，当 
\begin_inset Formula $m=1$
\end_inset

 即可积出精确值。
\end_layout

\begin_layout Enumerate
若 
\begin_inset Formula $p\le2$
\end_inset

，当 
\begin_inset Formula $m=3$
\end_inset

 即可积出精确值。
\end_layout

\begin_layout Enumerate
若 
\begin_inset Formula $p\le3$
\end_inset

，当 
\begin_inset Formula $m=4$
\end_inset

 即可积出精确值。
\end_layout

\begin_layout Enumerate
若 
\begin_inset Formula $p\le4$
\end_inset

，当 
\begin_inset Formula $m=7$
\end_inset

 即可积出精确值。
\end_layout

\begin_layout Standard
\begin_inset Formula $p$
\end_inset

直到20，都可以应用 Gauss quadrature 规则。
\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="11" columns="8">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
图
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $p$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $i$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $L_{1i}^{e}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $L_{2i}^{e}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $L_{3i}^{e}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $W_{i}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
重心采点 
\begin_inset Formula $(1)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.33333333$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.33333333$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.33333333$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.00000000$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
边心采点 
\begin_inset Formula $(3)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.500000000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.500000000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.00000000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.33333333$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.00000000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.500000000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.500000000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.33333333$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.500000000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.00000000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.500000000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.33333333$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
重心+内部 
\begin_inset Formula $(4)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.33333333$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.33333333$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.33333333$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.56250000$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.73333333$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.13333333$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.13333333$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.52083333$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.13333333$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.73333333$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.13333333$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.52083333$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.13333333$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.13333333$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.73333333$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.52083333$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
三角形的 Gauss Quadrature 的采样点和权重
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Remark
令 
\begin_inset Formula $J$
\end_inset

 表示几何坐标对等参坐标的雅可比矩阵，
\begin_inset Formula $\det[J]$
\end_inset

正比于几何区域的面积，例如对于三角形
\begin_inset Formula 
\[
S=\frac{1}{2}\det[J]
\]

\end_inset

在计算程序中，这个几何常数被吸收进 权重因子 
\begin_inset Formula $W_{i}$
\end_inset

 中。因此程序中高斯积分法的形式为：
\begin_inset Formula 
\[
\iint_{\Omega^{e}}F\left(L_{1}^{e},L_{2}^{e},L_{3}^{e}\right)\dd{x}\dd{y}=\sum_{i=1}^{m}F\left(L_{1i}^{e},L_{2i}^{e},L_{3i}^{e}\right)W_{i}^{\prime}\det[J]
\]

\end_inset


\end_layout

\begin_layout Chapter
三维有限元分析,p99/96
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "chap:5"

\end_inset


\end_layout

\begin_layout Standard
所考虑的边值问题，可以用二阶微分方程表述
\begin_inset Formula 
\begin{equation}
-\partial_{x}\left(\alpha_{x}\partial_{x}\phi\right)-\partial_{y}\left(\alpha_{y}\partial_{y}\phi\right)-\partial_{z}\left(\alpha_{z}\partial_{z}\phi\right)+\beta\phi=f,\quad\left(x,y,z\right)\in V\label{eq:5.1}
\end{equation}

\end_inset

并连同边值条件
\begin_inset Formula 
\begin{equation}
\phi=p\quad\text{on}\quad S_{1}\label{eq:5.2}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\left(\alpha_{x}\partial_{x}\phi\hat{x}+\alpha_{y}\partial_{y}\phi\hat{y}+\alpha_{z}\partial_{z}\phi\hat{z}\right)\cdot\hat{n}+\gamma\phi=q\quad\text{on}\quad S_{2}\label{eq:5.3}
\end{equation}

\end_inset

其中 
\begin_inset Formula $S\left(=S_{1}+S_{2}\right)$
\end_inset

 标记闭合体积
\begin_inset Formula $V$
\end_inset

的曲面，
\begin_inset Formula $\hat{n}$
\end_inset

 是指向外面的单位向量。
\end_layout

\begin_layout Section
边值问题
\end_layout

\begin_layout Section
变分公式
\end_layout

\begin_layout Section
有限元分析
\end_layout

\begin_layout Subsection
区域离散化，Domain Discretization
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\phi^{e}\left(x,y,z\right)=\sum_{j=1}^{4}N_{j}^{e}\left(x,y,z\right)\phi_{j}^{e}\label{eq:5.10}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{align}
K_{ij}^{e} & =\iiint_{V}\left(\alpha_{x}\partial_{x}N_{i}^{e}\,\partial_{x}N_{j}^{e}+\alpha_{y}\partial_{y}N_{i}^{e}\,\partial_{y}N_{j}^{e}+\alpha_{z}\partial_{z}N_{i}^{e}\,\partial_{z}N_{j}^{e}\right)\dd{V}\label{eq:5.17}\\
b_{i}^{e} & =\iiint_{V}fN_{i}^{e}\dd{V}\label{eq:5.18}
\end{align}

\end_inset

显然 
\begin_inset Formula $[K^{e}]$
\end_inset

 是对称矩阵。
\end_layout

\begin_layout Subsection
Ritz 方法的 Formulation
\end_layout

\begin_layout Subsection
Galerkin 方法的 Formulation
\end_layout

\begin_layout Standard
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:5.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 对应的 residual error 是
\begin_inset Formula 
\begin{align}
R_{i}^{e} & =\sum_{j=1}^{r}\phi_{j}^{e}\iiint_{V^{e}}\left(\alpha_{x}\partial_{x}N_{i}^{e}\,\partial_{x}N_{j}^{e}+\alpha_{y}\partial_{y}N_{i}^{e}\,\partial_{y}N_{j}^{e}+\alpha_{z}\partial_{z}N_{i}^{e}\,\partial_{z}N_{j}^{e}+\beta N_{i}^{e}N_{j}^{e}\right)\dd{V}\nonumber \\
 & -\iiint_{V^{e}}N_{i}^{e}f\dd{V}-\oint_{S^{e}}N_{i}^{e}\sbf D\cdot\hat{n}^{e}\dd{S}.\label{eq:5.42}
\end{align}

\end_inset

写成矩阵形式是
\begin_inset Formula 
\begin{equation}
\left\{ R^{e}\right\} =\left[K^{e}\right]\left\{ \phi^{e}\right\} -\left\{ b^{e}\right\} -\left\{ g^{e}\right\} .\label{eq:5.43}
\end{equation}

\end_inset


\begin_inset Formula $\left[K^{e}\right]$
\end_inset

 和 
\begin_inset Formula $\left\{ b^{e}\right\} $
\end_inset

 中的元素与
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:5.17"
plural "false"
caps "false"
noprefix "false"

\end_inset

 和 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:5.18"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中的相同。
\end_layout

\begin_layout Standard
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\begin_inset Formula 
\begin{align}
K_{ij}^{e} & =\iiint_{V}\left(\alpha_{x}\partial_{x}N_{i}^{e}\,\partial_{x}N_{j}^{e}+\alpha_{y}\partial_{y}N_{i}^{e}\,\partial_{y}N_{j}^{e}+\alpha_{z}\partial_{z}N_{i}^{e}\,\partial_{z}N_{j}^{e}\right)\dd{V}\label{eq:5.17-1}\\
b_{i}^{e} & =\iiint_{V}fN_{i}^{e}\dd{V}\label{eq:5.18-1}
\end{align}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $\left\{ g^{e}\right\} $
\end_inset

中的元素为
\begin_inset Formula 
\begin{equation}
g_{i}^{e}=\oint_{S^{e}}N_{i}^{e}\sbf D\cdot\hat{n}^{e}\dd{S}\cdot\label{eq:5.44}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
矩形块单元
\end_layout

\begin_layout Section
静电问题的应用
\end_layout

\begin_layout Section
静磁问题的应用
\end_layout

\begin_layout Subsection
问题的描述
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\nabla\times(\frac{1}{\mu_{r}}\nabla\times\sbf A)=\mu_{0}\sbf J\label{eq:5.60}
\end{equation}

\end_inset


\end_layout

\begin_layout Paragraph
狄利克雷边界条件
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\sbf n}\times\sbf A=\sbf P\quad\text{在}S_{1}\text{上}\label{eq:5.61}
\end{equation}

\end_inset

如果在局部坐标系中为 
\begin_inset Formula $\sbf n=(0,0,1)$
\end_inset

，则
\begin_inset Formula 
\begin{equation}
{\color{blue}\hat{\sbf n}\times\sbf A=(-A_{y},A_{x})}=(P_{x},P_{y})\label{eq:5.61b}
\end{equation}

\end_inset

即约束
\begin_inset Formula $\sbf A$
\end_inset

的切向分量 
\begin_inset Formula $\{A_{x},A_{y}\}$
\end_inset

，因此将约束
\begin_inset Formula $\sbf A$
\end_inset

在Edges上的环路积分 
\begin_inset Formula $\int\sbf A\cdot\dd{\sbf\ell}$
\end_inset

。
\end_layout

\begin_layout Paragraph
适用于对称面的齐次诺伊曼条件
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\sbf n}\times(\nabla\times\sbf A)=0,\quad\text{在}S_{2}\text{上}\label{eq:5.62}
\end{equation}

\end_inset

同样在局部坐标系
\begin_inset Formula $\sbf n=(0,0,1)$
\end_inset

中,
\begin_inset Formula 
\[
\nabla\times\sbf A=(\partial_{y}A_{z}-\partial_{z}A_{y},\,{\color{blue}\partial_{z}A_{x}-\partial_{x}A_{z}},\,\partial_{x}A_{y}-\partial_{y}A_{x})
\]

\end_inset

则套用
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:5.61b"
plural "false"
caps "false"
noprefix "false"

\end_inset

，
\begin_inset Formula 
\[
\hat{\sbf n}\times(\nabla\times\sbf A)=(-{\color{blue}\mathrm{curl}_{y}},\,\mathrm{curl}_{x})=(0,0)
\]

\end_inset

即约束
\begin_inset Formula $\sbf A$
\end_inset

的旋度的切向分量。
\end_layout

\begin_layout Paragraph
介质分界面的连续性条件
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\sbf n}\times\sbf A^{+}=\hat{\sbf n}\times\sbf A^{-},\quad\text{在}S_{d}\text{上}\label{eq:5.63}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\frac{1}{\mu_{r}^{+}}\hat{\sbf n}\times\nabla\times\sbf A^{+}=\frac{1}{\mu_{r}^{-}}\hat{\sbf n}\times\nabla\times\sbf A^{-},\quad\text{在}S_{d}\text{上}\label{eq:5.64}
\end{equation}

\end_inset

它们是连续性条件 
\begin_inset Formula $\hat{\sbf n}\cdot\sbf B^{+}=\hat{\sbf n}\cdot\sbf B^{-}$
\end_inset

和 
\begin_inset Formula $\hat{\sbf n}\times\sbf H^{+}=\hat{\sbf n}\times\sbf H^{-}$
\end_inset

的直接结果。
\end_layout

\begin_layout Subsection
变分公式
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
F(\sbf A)=\frac{1}{2}\int_{V}\frac{1}{\mu_{r}}(\nabla\times\sbf A)\cdot(\nabla\times\sbf A)\dd{V}-\mu_{0}\int_{V}\sbf J\cdot\sbf A\dd{V}\label{eq:5.65}
\end{equation}

\end_inset


\end_layout

\begin_layout Remark
有矢量恒等式
\begin_inset Formula 
\[
\nabla\cdot({\color{blue}\sbf a}\times\sbf b)=\sbf b\cdot\nabla\times\sbf a-\sbf a\cdot\nabla\times\sbf b
\]

\end_inset

代入
\begin_inset Formula $\sbf b={\color{red}\delta\sbf A}$
\end_inset

，
\begin_inset Formula $\sbf a={\color{blue}\nabla\times\sbf A}$
\end_inset

 得
\begin_inset Formula 
\[
\nabla\cdot\left[({\color{blue}\nabla\times\sbf A})\times{\color{red}\delta\sbf A}\right]={\color{red}\delta\sbf A}\cdot\nabla\times({\color{blue}\nabla\times\sbf A})-({\color{blue}\nabla\times\sbf A})\cdot(\nabla\times{\color{red}\delta\sbf A})
\]

\end_inset

在考虑散度定理
\begin_inset Formula $\int_{v}\nabla\cdot\sbf f\dd{V}=\int_{S}\hat{\sbf n}\cdot\sbf f\dd{S}$
\end_inset


\begin_inset Formula 
\begin{align*}
\nabla\cdot\left[({\color{blue}\nabla\times\sbf A})\times{\color{red}\delta\sbf A}\right] & \Rightarrow\sbf n\cdot\left[({\color{blue}\nabla\times\sbf A})\times{\color{red}\delta\sbf A}\right]\\
 & ={\color{red}\delta\sbf A}\cdot\left[\sbf n\times({\color{blue}\nabla\times\sbf A})\right]
\end{align*}

\end_inset

因此 
\series bold
在积分号下
\series default
 有
\begin_inset Formula 
\begin{align*}
\int_{V}({\color{blue}\nabla\times\sbf A})\cdot(\nabla\times{\color{red}\delta\sbf A})= & \int_{V}\left(\nabla\times{\color{blue}\nabla\times\sbf A}\right)\cdot{\color{red}\delta\sbf A}\\
 & -\int_{S_{2}}\left(\sbf n\times{\color{blue}\nabla\times\sbf A}\right)\cdot{\color{red}\delta\sbf A}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Remark
类似地，
\begin_inset Formula 
\begin{align*}
\int_{V}({\color{blue}\nabla\times\sbf A})\cdot(\nabla\times{\color{red}\sbf A})= & \int_{V}\left(\nabla\times{\color{blue}\nabla\times\sbf A}\right)\cdot{\color{red}\sbf A}\\
 & -\int_{S_{2}}\left(\sbf n\times{\color{blue}\nabla\times\sbf A}\right)\cdot{\color{red}\sbf A}
\end{align*}

\end_inset

即 
\series bold
curl 的模方
\series default
等于
\series bold
二阶curl的投影
\series default
减去
\series bold
curl切向分量的投影
\series default
。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\delta F(\sbf A)= & \int_{V}\left[\nabla\times(\frac{1}{\mu_{r}}\nabla\times\sbf A)-\mu_{0}\sbf J\right]\cdot\delta\sbf A\dd{V}\\
 & -\int_{S_{d}}\left[\frac{1}{\mu_{r}^{+}}\left(\hat{\sbf n}\times\nabla\times\sbf A^{+}\right)-\frac{1}{\mu_{r}^{+}}\left(\hat{\sbf n}\times\nabla\times\sbf A^{-}\right)\right]\cdot\delta\sbf A\dd{S}\\
 & -\int_{S_{2}}\frac{1}{\mu_{r}}\left(\hat{\sbf n}\times\nabla\times\sbf A\right)\cdot\delta\sbf A\dd{S}
\end{align*}

\end_inset

其中
\begin_inset Formula $S_{2}$
\end_inset

表示诺伊曼边界，
\begin_inset Formula $\hat{n}\times\delta\sbf A$
\end_inset

在狄利克雷边界
\begin_inset Formula $S_{1}$
\end_inset

上为零。
\begin_inset Formula $\delta F(\sbf A)=0$
\end_inset

 意味着
\begin_inset Formula $\sbf A$
\end_inset

必须满足 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:5.60"
plural "false"
caps "false"
noprefix "false"

\end_inset

，
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:5.62"
plural "false"
caps "false"
noprefix "false"

\end_inset

，
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:5.64"
plural "false"
caps "false"
noprefix "false"

\end_inset

。
\end_layout

\begin_layout Exercise
从下式
\end_layout

\begin_layout Exercise
\begin_inset Formula 
\[
R_{p\alpha}^{e}=\int_{V^{e}}N_{\alpha}^{e}\,\hat{\sbf p}\cdot\left[\nabla\times\left(\frac{1}{\mu_{r}}\nabla\times\sbf A\right)-\mu_{0}\sbf J\right]\dd{V},\quad p=x,y,z
\]

\end_inset


\end_layout

\begin_layout Section
时谐场问题的应用p114/111
\end_layout

\begin_layout Subsection
问题的描述
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\nabla\times\left(\frac{1}{\mu_{r}}\nabla\times\sbf E\right)-k_{0}^{2}\varepsilon_{r}\,\sbf E=-i\,k_{0}Z_{0}\sbf J\label{eq:5.101}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla\times\left(\frac{1}{\varepsilon_{r}}\nabla\times\sbf H\right)-k_{0}^{2}\mu_{r}\,\sbf H=\nabla\times\left(\frac{1}{\varepsilon_{r}}\sbf J\right)\label{eq:5.102}
\end{equation}

\end_inset

其中
\begin_inset Formula $Z_{0}=\sqrt{\mu_{0}/\varepsilon_{0}}$
\end_inset

。
\end_layout

\begin_layout Paragraph
导电面上的边界条件
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\sbf n}\times\sbf E=0\label{eq:5.103}
\end{equation}

\end_inset

i.e.
\begin_inset Formula 
\[
(-E_{y},E_{x})=(0,0)
\]

\end_inset

and
\begin_inset Formula 
\begin{equation}
\hat{\sbf n}\times\nabla\times\sbf H=0\label{eq:5.104}
\end{equation}

\end_inset


\begin_inset Formula 
\[
(-{\color{blue}\mathrm{curl}H_{y}},\,\mathrm{curl}H_{x})=(0,0)
\]

\end_inset


\end_layout

\begin_layout Remark
Note：
\end_layout

\begin_deeper
\begin_layout Enumerate
有矢量恒等式
\begin_inset Formula 
\begin{align*}
\varepsilon_{mni}{\color{blue}\partial_{n}}\,\varepsilon_{ijk}\partial_{j}H_{k} & =\left(\delta_{mj}\delta_{nk}-\delta_{nj}\delta_{mk}\right){\color{blue}\partial_{n}}\partial_{j}H_{k}\\
 & ={\color{blue}\partial_{k}}\partial_{m}H_{k}-{\color{blue}\partial_{n}}\partial_{n}\,H_{m}
\end{align*}

\end_inset

即
\begin_inset Formula 
\[
\nabla\times(\nabla\times\sbf H)=\nabla(\nabla\cdot\sbf H)-\nabla^{2}\sbf H
\]

\end_inset

类似地有
\begin_inset Formula 
\[
\sbf n\times(\nabla\times\sbf H)=(\nabla\sbf H)\cdot\sbf n-(\sbf n\cdot\nabla)\sbf H
\]

\end_inset

其中
\begin_inset Formula $\nabla\sbf H$
\end_inset

表示并矢。如果
\begin_inset Formula $\sbf n$
\end_inset

是常矢量（或者在局部）也可写成
\begin_inset Formula 
\[
\sbf n\times(\nabla\times\sbf H)=\nabla(\sbf n\cdot\sbf H)-\sbf n\cdot(\nabla\sbf H)
\]

\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $\hat{\sbf n}\times\nabla\times\sbf H=0$
\end_inset

 reads as，在边界上
\begin_inset Formula $\sbf H$
\end_inset

的旋度的切向分量为零。如图选取合适的积分回路，令切向积分可以忽略，然后得到在边界面上
\begin_inset Formula $\sbf H$
\end_inset

的法向分量处处相等。 
\begin_inset Newline newline
\end_inset


\begin_inset Graphics
	filename inset/fig-boundary-condition-1.png
	lyxscale 65
	scale 40

\end_inset


\end_layout

\end_deeper
\begin_layout Paragraph
导磁面上的对偶条件
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\sbf n}\times\nabla\times\sbf E=0\label{eq:5.105}
\end{equation}

\end_inset


\begin_inset Formula 
\[
(-{\color{blue}\mathrm{curl}E_{y}},\,\mathrm{curl}E_{x})=(0,0)
\]

\end_inset


\begin_inset Formula 
\begin{equation}
\hat{\sbf n}\times\sbf H=0\label{eq:5.106}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
(-H_{y},H_{x})=(0,0)
\]

\end_inset


\end_layout

\begin_layout Paragraph
第三类边界条件
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
 & \frac{1}{\mu_{r}}\hat{\sbf n}\times\left(\nabla\times\sbf E\right)+\gamma_{e}\hat{\sbf n}\times\left(\hat{\sbf n}\times\sbf E\right)=\sbf U\label{eq:5.107}\\
 & \frac{1}{\varepsilon_{r}}\hat{\sbf n}\times\left(\nabla\times\sbf H\right)+\gamma_{h}\hat{\sbf n}\times\left(\hat{\sbf n}\times\sbf H\right)=\sbf V\label{eq:5.108}
\end{align}

\end_inset


\begin_inset Formula $\sbf n=(0,0,1)$
\end_inset

局部坐标下的分量形式
\begin_inset Formula 
\[
\frac{1}{\mu_{r}}(-{\color{blue}\mathrm{curl}E_{y}},\,\mathrm{curl}E_{x})+\gamma_{e}\left(-E_{x},-E_{y}\right)=\left(U_{x},U_{y}\right)
\]

\end_inset

其中 
\begin_inset Formula $\gamma_{e}$
\end_inset

和
\begin_inset Formula $\gamma_{h}$
\end_inset

是已知参数，
\begin_inset Formula $\sbf U$
\end_inset

和
\begin_inset Formula $\sbf V$
\end_inset

是已知矢量。
\end_layout

\begin_layout Standard
两种不同媒质分界面上的连续性条件为
\begin_inset Formula 
\begin{align}
 & \hat{\sbf n}\times\sbf E^{+}=\hat{\sbf n}\times\sbf E^{-}\label{eq:5.109}\\
 & \hat{\sbf n}\times\sbf H^{+}=\hat{\sbf n}\times\sbf H^{-}\label{eq:5.110}
\end{align}

\end_inset

也可将它们写成
\begin_inset Formula 
\begin{align}
 & \frac{1}{\mu_{r}^{+}}\hat{\sbf n}\times(\nabla\times\sbf E^{+})=\frac{1}{\mu_{r}^{-}}\hat{\sbf n}\times(\nabla\times\sbf E^{-})\label{eq:5.111}\\
 & \frac{1}{\varepsilon_{r}^{+}}\hat{\sbf n}\times(\nabla\times\sbf H^{+})=\frac{1}{\varepsilon_{r}^{-}}\hat{\sbf n}\times(\nabla\times\sbf H^{-})\label{eq:5.112}
\end{align}

\end_inset


\end_layout

\begin_layout Remark
\begin_inset Formula $\sbf n$
\end_inset

的左叉乘相当于在
\begin_inset Formula $\sbf n$
\end_inset

的法向上将矢量旋转
\begin_inset Formula $90\text{\textdegree}$
\end_inset

。因此两次
\begin_inset Formula $\sbf n\times$
\end_inset

算符相当于取切向投影的负号：
\begin_inset Formula 
\[
\sbf n\times(\sbf n\times\sbf A)=-A_{t},
\]

\end_inset


\end_layout

\begin_layout Subsection
变分公式
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
F(\sbf E)= & \frac{1}{2}\int_{V}\left[\frac{1}{\mu_{r}}\left(\nabla\times\sbf E\right)\cdot\left(\nabla\times\sbf E\right)-k_{0}^{2}\varepsilon_{r}\,\sbf E\cdot\sbf E\right]\dd{V}\nonumber \\
 & +\int_{S_{2}}\left[\frac{\gamma_{e}}{2}\left(\hat{\sbf n}\times\sbf E\right)\cdot\left(\hat{\sbf n}\times\sbf E\right)+\sbf E\cdot\sbf U\right]\dd{S}\nonumber \\
 & +i\,k_{0}Z_{0}\int_{V}\sbf E\cdot\sbf J\dd{V}\label{eq:5.113}
\end{align}

\end_inset


\begin_inset Formula 
\begin{align}
F(\sbf H)= & \frac{1}{2}\int_{V}\left[\frac{1}{\varepsilon_{r}}\left(\nabla\times\sbf H\right)\cdot\left(\nabla\times\sbf H\right)-k_{0}^{2}\mu_{r}\,\sbf H\cdot\sbf H\right]\dd{V}\nonumber \\
 & +\int_{S_{2}}\left[\frac{\gamma_{h}}{2}\left(\hat{\sbf n}\times\sbf H\right)\cdot\left(\hat{\sbf n}\times\sbf H\right)+\sbf H\cdot\sbf V\right]\dd{S}\nonumber \\
 & -\int_{V}\sbf H\cdot\left(\nabla\times\frac{1}{\varepsilon_{r}}\sbf J\right)\dd{V}\label{eq:5.114}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
类似于标量情形，上面给出的泛函对
\begin_inset Formula $\varepsilon_{r}$
\end_inset

，
\begin_inset Formula $\mu_{r}$
\end_inset

，
\begin_inset Formula $\gamma_{e}$
\end_inset

和
\begin_inset Formula $\gamma_{h}$
\end_inset

为实数或复数时均成立。如果这些参数是实数，那么，我们可以选用下列其他形式的泛函
\begin_inset Formula 
\begin{align}
F(\sbf E)= & \frac{1}{2}\int_{V}\left[\frac{1}{\mu_{r}}\left(\nabla\times\sbf E\right)\cdot\left(\nabla\times\sbf E\right)^{*}-k_{0}^{2}\varepsilon_{r}\,\sbf E\cdot\sbf E^{*}\right]\dd{V}\nonumber \\
 & +\frac{1}{2}\int_{S_{2}}\left[\gamma_{e}\left(\hat{\sbf n}\times\sbf E\right)\cdot\left(\hat{\sbf n}\times\sbf E\right)^{*}+\sbf E^{*}\cdot\sbf U+\sbf E\cdot\sbf U^{*}\right]\dd{S}\nonumber \\
 & +i\,k_{0}Z_{0}\frac{1}{2}\int_{V}\left(\sbf E^{*}\cdot\sbf J-\sbf E\cdot\sbf J^{*}\right)\dd{V}\label{eq:5.115}
\end{align}

\end_inset

注意最后一项有负号，是因为前面的虚数
\begin_inset Formula $i$
\end_inset

。
\begin_inset Formula 
\begin{align}
F(\sbf H)= & \frac{1}{2}\int_{V}\left[\frac{1}{\varepsilon_{r}}\left(\nabla\times\sbf H\right)\cdot\left(\nabla\times\sbf H\right)^{*}-k_{0}^{2}\mu_{r}\,\sbf H\cdot\sbf H^{*}\right]\dd{V}\nonumber \\
 & +\frac{1}{2}\int_{S_{2}}\left[\gamma_{h}\left(\hat{\sbf n}\times\sbf H\right)\cdot\left(\hat{\sbf n}\times\sbf H\right)^{*}+\sbf H^{*}\cdot\sbf V+\sbf H\cdot\sbf V^{*}\right]\dd{S}\nonumber \\
 & -\frac{1}{2}\int_{V}\left[\sbf H^{*}\cdot\left(\nabla\times\frac{1}{\varepsilon_{r}}\sbf J\right)+\sbf H\cdot\left(\nabla\times\frac{1}{\varepsilon_{r}}\sbf J\right)^{*}\right]\dd{V}\label{eq:5.116}
\end{align}

\end_inset

这两个泛函均是实值的。因此它们的驻点对应于极大值或极小值；前面的两个泛函，由于它们是复数，因此不存在这样的极大值或极小值。
\end_layout

\begin_layout Subsection
边界条件和界面条件的处理
\end_layout

\begin_layout Standard
狄利克雷边界条件，例如
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:5.103"
plural "false"
caps "false"
noprefix "false"

\end_inset

。
\begin_inset Formula 
\[
\hat{\sbf n}\times\sbf E=0
\]

\end_inset

分量形式
\begin_inset Formula 
\begin{equation}
n_{x}E_{y}-n_{y}E_{x}=0,\quad n_{y}E_{z}-n_{z}E_{y}=0,\quad n_{z}E_{x}-n_{x}E_{z}=0\label{eq:5.117}
\end{equation}

\end_inset

其中
\begin_inset Formula $\sbf n=n_{x}\hat{\sbf x}+n_{y}\hat{\sbf y}+n_{z}\hat{\sbf z}$
\end_inset

。然后，选择一非零分量，例如
\begin_inset Formula $n_{z}$
\end_inset

，来消除其他两个分量
\begin_inset Formula 
\begin{equation}
\frac{E_{x}}{n_{x}}=\frac{E_{z}}{n_{z}},\quad\frac{E_{y}}{n_{y}}=\frac{E_{z}}{n_{z}},\label{eq:5.118}
\end{equation}

\end_inset

即可实现狄利克雷边界条件的强加。
\end_layout

\begin_layout Standard
当然，假如 
\begin_inset Formula $n_{x}$
\end_inset

或
\begin_inset Formula $n_{y}$
\end_inset

是非零的，也可以选择
\begin_inset Formula $n_{x}$
\end_inset

或
\begin_inset Formula $n_{y}$
\end_inset

来消除其它两个分量。
\end_layout

\begin_layout Standard
磁场在导电面上满足的边界条件
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:5.104"
plural "false"
caps "false"
noprefix "false"

\end_inset

等价于 
\begin_inset Formula $\hat{\sbf n}\cdot\sbf H=0$
\end_inset

，即
\begin_inset Formula 
\begin{equation}
n_{x}H_{x}+n_{y}H_{y}+n_{z}H_{z}=0\label{eq:5.119}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
H_{z}=-\frac{n_{x}}{n_{z}}H_{x}-\frac{n_{y}}{n_{z}}H_{y}\label{eq:5.120}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
我们需要显示强加连续性条件
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:5.109"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:5.110"
plural "false"
caps "false"
noprefix "false"

\end_inset

，
\begin_inset Formula 
\begin{align*}
 & \hat{\sbf n}\times\sbf E^{+}=\hat{\sbf n}\times\sbf E^{-}\\
 & \hat{\sbf n}\times\sbf H^{+}=\hat{\sbf n}\times\sbf H^{-}
\end{align*}

\end_inset

而将
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:5.111"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:5.112"
plural "false"
caps "false"
noprefix "false"

\end_inset

当作自然条件来自动满足。只要给每个节点赋单一的值，即可实现连续性条件
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:5.109"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:5.110"
plural "false"
caps "false"
noprefix "false"

\end_inset

的强加。不幸的是，在实现上述过程时，我们也强加了法向场连续性，这与下列实际边界条件矛盾，
\begin_inset Formula 
\begin{align}
 & \hat{\sbf n}\cdot(\varepsilon_{r}^{+}\sbf E^{+})=\hat{\sbf n}\cdot(\varepsilon_{r}^{-}\sbf E^{-})\label{eq:5.121}\\
 & \hat{\sbf n}\cdot(\mu_{r}^{+}\sbf H^{+})=\hat{\sbf n}\cdot(\mu_{r}^{-}\sbf H^{-})\label{eq:5.122}
\end{align}

\end_inset


\series bold
基于这种推理，只要在界面附近将网格细分即可解决这种问题
\series default
。
\end_layout

\begin_layout Paragraph
强加边界条件
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left\{ \begin{array}{c}
E_{x}^{+}\\
E_{y}^{+}\\
E_{z}^{+}
\end{array}\right\} =\left[\begin{array}{ccc}
n_{x}^{2}e+1 & n_{x}n_{y}e & n_{x}n_{z}e\\
n_{x}n_{y}e & n_{y}^{2}e+1 & n_{y}n_{z}e\\
n_{x}n_{z}e &  & n_{z}^{2}e+1
\end{array}\right]\left\{ \begin{array}{c}
E_{x}^{-}\\
E_{y}^{-}\\
E_{z}^{-}
\end{array}\right\} \label{eq:5.127}
\end{equation}

\end_inset

式中
\begin_inset Formula 
\[
e=\frac{\varepsilon_{r}^{-}}{\varepsilon_{r}^{+}}-1
\]

\end_inset

只要用
\begin_inset Formula $\mu_{r}$
\end_inset

代替
\begin_inset Formula $\varepsilon_{r}$
\end_inset

，即可得到磁场
\begin_inset Formula $\sbf H$
\end_inset

的类似表达式。
\end_layout

\begin_layout Paragraph
计算法向分量
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\sum_{s}\iint_{S^{s}}\hat{\sbf n^{s}}\cdot\left(\varepsilon_{r}^{+}N_{j}^{s}\,\sbf E_{i}^{+}\right)\dd{S}=\sum_{s}\iint_{S^{s}}\hat{\sbf n^{s}}\cdot\left(\varepsilon_{r}^{-}N_{j}^{s}\,\sbf E_{i}^{-}\right)\dd{S}\label{eq:5.128}
\end{equation}

\end_inset


\begin_inset Formula $\sbf E_{i}^{+}$
\end_inset

表示节点
\begin_inset Formula $i$
\end_inset

上的电场；
\begin_inset Formula $S^{s}$
\end_inset

表示第
\begin_inset Formula $s$
\end_inset

个三角形的面，
\begin_inset Formula $\hat{\sbf n}$
\end_inset

表示其法向，
\begin_inset Formula $N_{j}^{s}$
\end_inset

表示第
\begin_inset Formula $s$
\end_inset

个三角形内，局部节点编号
\begin_inset Formula $j$
\end_inset

的插值函数。
\begin_inset Formula $i,j,s$
\end_inset

 的关系为 
\begin_inset Formula $\mathrm{ns}(j,s)=i$
\end_inset

（局部
\begin_inset Formula $\to$
\end_inset

全局编号映射表）。既然
\begin_inset Formula $\hat{\sbf n^{s}}$
\end_inset

在三角形平面上有唯一的定义，则它可容易地被计算出。显而易见，如果我们将节点
\begin_inset Formula $i$
\end_inset

上的单位矢量
\begin_inset Formula $\hat{\sbf n_{i}}$
\end_inset

定义为
\begin_inset Formula 
\begin{equation}
\hat{\sbf n}_{i}=\frac{\sbf n}{\abs{\sbf n}},\quad\sbf n=\sum_{s}\iint_{S^{s}}\hat{\sbf n^{s}}N_{j}^{s}\dd{S}\label{eq:5.129}
\end{equation}

\end_inset

则
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:5.128"
plural "false"
caps "false"
noprefix "false"

\end_inset

可写成
\begin_inset Formula 
\begin{equation}
\hat{\sbf n_{i}}\cdot\left(\varepsilon_{r}^{+}\,\sbf E_{r}^{+}\right)=\hat{\sbf n_{i}}\cdot\left(\varepsilon_{r}^{-}\,\sbf E_{r}^{-}\right)\label{eq:5.130}
\end{equation}

\end_inset

显然，单位矢量
\begin_inset Formula $\hat{\sbf n_{i}}$
\end_inset

是局部加权平均，随着网格的细分，它收敛成实际光滑边界的唯一局部法向。因此可将
\begin_inset Formula $\hat{\sbf n_{i}}$
\end_inset

当作节点
\begin_inset Formula $i$
\end_inset

的平均法向，用它来实现
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:5.128"
plural "false"
caps "false"
noprefix "false"

\end_inset

，
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:5.120"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:5.127"
plural "false"
caps "false"
noprefix "false"

\end_inset

式给出的边界条件和界面条件。
\end_layout

\begin_layout Subsection
伪解问题
\end_layout

\begin_layout Standard
\begin_inset Formula $\nabla\times(\sbf E)/\mu_{r}$
\end_inset

和
\begin_inset Formula $(\nabla\times\sbf H)/\varepsilon_{r}$
\end_inset

必须是连续的。然而，我们在有限元求解过程中仅仅需要插值函数或展开函数连续，而对它们的导数则没有这种要求。这样得出的解叫作只在不太严格意义上满足控制微分方程的
\series bold
弱解
\series default
。因为在弱解中 
\begin_inset Formula $\nabla\times(\sbf E)/\mu_{r}$
\end_inset

和
\begin_inset Formula $(\nabla\times\sbf H)/\varepsilon_{r}$
\end_inset

 不连续，所以我们不能取 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:5.101"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:5.102"
plural "false"
caps "false"
noprefix "false"

\end_inset

的散度来证明散度条件的满足。
\begin_inset Formula 
\begin{align*}
 & \nabla\times\sbf E=-j\omega\sbf B\\
 & \nabla\times\sbf H=\sbf J+j\omega\sbf D
\end{align*}

\end_inset

更具体地说，如果对求电场感兴趣，可以先求磁场
\begin_inset Formula $\sbf H$
\end_inset

，然后用麦克斯韦方程解出电场：
\begin_inset Formula 
\begin{equation}
\sbf E=\frac{1}{j\omega\varepsilon}\left(\nabla\times\sbf H-\sbf J\right)\label{eq:5.131}
\end{equation}

\end_inset

这样即使
\begin_inset Formula $\sbf H$
\end_inset

掺杂了伪解（非常可能）使用
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:5.131"
plural "false"
caps "false"
noprefix "false"

\end_inset

计算出的电场将不会包含伪解，满足散度条件。类似地，可以从电场得到磁场。
\begin_inset Formula 
\begin{equation}
\sbf H=\frac{-1}{j\omega\mu}\nabla\times\sbf E\label{eq:5.132}
\end{equation}

\end_inset

上式可以保证磁场是无散的。不幸的是，因为导数运算，这样计算出的电场或磁场比直接用有限元求解的结果精度低。
\end_layout

\begin_layout Subsubsection
罚项
\end_layout

\begin_layout Subsection
场的奇异性问题 p125/122
\end_layout

\begin_layout Subsection
结论
\end_layout

\begin_layout Standard
在这一节中，我们建立了三维时谐电磁场问题的有限元公式。用节点量插值的传统有限元时，我们遇到了三个主要困难。
\end_layout

\begin_layout Itemize
媒质界面不连续
\end_layout

\begin_layout Itemize
非物理界或伪解
\end_layout

\begin_layout Itemize
不能模拟导体和材料的角、边缘和尖角处场的奇异性。
\end_layout

\begin_layout Standard
通过引入新型单元，不会出现困难。
\end_layout

\begin_layout Chapter
电磁学的变分原理 p128/125
\end_layout

\begin_layout Standard
变分方法是通常用于建立有限元求解公式的两种方法之一。它的优点在于：有牢固的数理基础，其公式也有明确的物理解释。另一个优点在于：通过变分过程，我们能够清楚地说明必
要边界条件和自然边界条件之间的区别，其他优点包括方便和公式优雅。
\end_layout

\begin_layout Section
标准变分原理
\begin_inset CommandInset label
LatexCommand label
name "sec:6.1"

\end_inset


\end_layout

\begin_layout Standard
page 128。标准变分原理复述如下：对下式微分方程定义的边值问题：
\begin_inset Formula 
\begin{equation}
\mathcal{L}\Phi=f\label{eq:j6.1}
\end{equation}

\end_inset

如果算符是自伴的，即
\begin_inset Formula 
\begin{equation}
\langle\Phi,\mathcal{L}\psi\rangle=\langle\mathcal{L}\Phi,\psi\rangle\label{eq:j6.2}
\end{equation}

\end_inset

 并且 
\begin_inset Formula $\mathcal{L}$
\end_inset

 是正定的，即
\begin_inset Formula 
\begin{equation}
\langle\Phi,\mathcal{L}\Phi\rangle\begin{cases}
>0 & \Phi\neq0\\
=0 & \Phi=0
\end{cases}\label{eq:j6.3}
\end{equation}

\end_inset

那么，通过求下式泛函的极小值
\begin_inset Formula 
\begin{equation}
F(\Phi)=\frac{1}{2}\langle\Phi,\mathcal{L}\Phi\rangle-\frac{1}{2}\langle\Phi,f\rangle-\frac{1}{2}\langle f,\Phi\rangle\label{eq:j6.4}
\end{equation}

\end_inset

即可求出
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

式的解。
\end_layout

\begin_layout Standard
在上面的几个式子中，
\begin_inset Formula $\psi$
\end_inset

表示与
\begin_inset Formula $\Phi$
\end_inset

满足相同边界条件的任意函数。
\series bold
尖括号表示如下定义的内积
\series default

\begin_inset Formula 
\begin{equation}
\langle\Phi,\psi\rangle=\int_{\Omega}\Phi^{*}\psi\dd{\Omega}\label{eq:j6.5}
\end{equation}

\end_inset

式中，
\begin_inset Formula $\Omega$
\end_inset

表示问题的区域，它可以是一维、二维和三维的；星号表示复共轭。为了证明这个变分原理，我们首先需要证明：
\end_layout

\begin_layout Enumerate
微分方程
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

是当泛函
\begin_inset Formula $F$
\end_inset

驻定时（即当
\begin_inset Formula $\delta F=0$
\end_inset

时）的必然结果。
\end_layout

\begin_layout Enumerate
然后，我们需要证明驻点是泛函
\begin_inset Formula $F$
\end_inset

的极小值点。这等价于证明
\begin_inset Formula $\delta(\delta F)>0$
\end_inset

。 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\delta F & =\frac{1}{2}\langle\delta\Phi,\mathcal{L}\Phi\rangle+\frac{1}{2}\langle\Phi,\mathcal{L}\delta\Phi\rangle-\frac{1}{2}\langle\delta\Phi,f\rangle-\frac{1}{2}\langle f,\delta\Phi\rangle\label{eq:j6.6}\\
 & =\frac{1}{2}\langle\delta\Phi,\mathcal{L}\Phi-f\rangle+\frac{1}{2}\langle\mathcal{L}\Phi-f,\delta\Phi\rangle\label{eq:j6.8}\\
 & =\ree\langle\delta\Phi,\mathcal{L}\Phi-f\rangle\label{eq:j6.9}
\end{align}

\end_inset

上式已使用了厄米性质 
\begin_inset Formula $\langle\mathcal{L}\delta\Phi,\Phi\rangle=\langle\delta\Phi,\mathcal{L}\Phi\rangle$
\end_inset

以及内积的定义
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.5"
plural "false"
caps "false"
noprefix "false"

\end_inset

。由于
\begin_inset Formula $\delta\Phi$
\end_inset

是任意变分，所以从
\begin_inset Formula $\ree\langle\delta\Phi,\mathcal{L}\Phi-f\rangle=0$
\end_inset

可以出的
\begin_inset Formula $\Phi$
\end_inset

 必须满足
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

即 
\begin_inset Formula $\mathcal{L}\Phi=f$
\end_inset

。
\end_layout

\begin_layout Remark
这里把复合微分算子
\begin_inset Formula $\mathcal{L}$
\end_inset

看作类似系数矩阵的东西，把 
\begin_inset Formula $\Phi$
\end_inset

 看作自由度，因此不考虑
\begin_inset Formula $F(\Phi)$
\end_inset

 对
\begin_inset Formula $\partial_{\mu}\phi$
\end_inset

 以及更高阶偏导的依赖，因为对 
\begin_inset Formula $\partial_{\mu}\phi$
\end_inset

 的依赖也已经考虑到算子
\begin_inset Formula $\mathcal{L}$
\end_inset

中了，故写作
\begin_inset Formula $F(\phi)$
\end_inset

。在这种框架下，欧拉–拉格朗日方程取简化形式 
\begin_inset Formula $\frac{\partial\mathcal{L}}{\partial\phi}=0$
\end_inset

。
\end_layout

\begin_layout Remark
对于论点
\begin_inset Formula $2$
\end_inset

，即
\begin_inset Formula $\delta(\delta F)>0$
\end_inset

，再取 
\begin_inset Formula $\delta F$
\end_inset

的第一变分，得到
\begin_inset Formula 
\begin{equation}
\delta(\delta F)=\delta F(\Phi+\delta\Phi)-\delta F(\Phi)=\ree\langle\delta\Phi,\mathcal{L}\delta\Phi\rangle\label{eq:j6.11}
\end{equation}

\end_inset

既然
\begin_inset Formula $\mathcal{L}$
\end_inset

是正定的。那么对于非零的
\begin_inset Formula $\delta\Phi$
\end_inset

，可从
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.3"
plural "false"
caps "false"
noprefix "false"

\end_inset

式得到
\begin_inset Formula $\delta(\delta F)>0$
\end_inset

。因此，驻点确实是
\begin_inset Formula $F$
\end_inset

的极小值点。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Subsection
多场耦合
\end_layout

\begin_layout Standard
考虑两个场 
\begin_inset Formula $\phi_{1},\phi_{2}$
\end_inset

 耦合的简单模型
\begin_inset Formula 
\begin{align*}
\mathcal{F}(\phi_{i})= & \sum_{i=1,2}\frac{1}{2}\langle\phi_{i},\mathcal{L}_{i}\phi_{i}\rangle-\frac{1}{2}\langle\phi_{i},f_{i}\rangle-\frac{1}{2}\langle f_{i},\phi_{i}\rangle\\
 & +\frac{1}{2}\langle\phi_{1},\mathcal{L}_{12}\phi_{2}\rangle+\frac{1}{2}\langle\phi_{2},\mathcal{L}_{21}\phi_{1}\rangle
\end{align*}

\end_inset


\begin_inset Formula 
\begin{align*}
\delta\mathcal{F}= & \sum_{i=1,2}\frac{1}{2}\langle\mathcal{L}_{i}\delta\phi_{i},\phi_{i}\rangle+\frac{1}{2}\langle\mathcal{L}_{i}\phi_{i},\delta\phi_{i}\rangle-\frac{1}{2}\langle\delta\phi_{i},f_{i}\rangle-\frac{1}{2}\langle f_{i},\delta\phi_{i}\rangle\\
 & +\frac{1}{2}{\color{blue}\langle\delta\phi_{1},\mathcal{L}_{12}\phi_{2}\rangle}+\frac{1}{2}{\color{brown}\langle\phi_{1},\mathcal{L}_{12}\delta\phi_{2}\rangle}+\frac{1}{2}{\color{blue}\langle\delta\phi_{2},\mathcal{L}_{21}\phi_{1}\rangle}+\frac{1}{2}{\color{brown}\langle\phi_{2},\mathcal{L}_{21}\delta\phi_{1}\rangle}\\
= & \frac{1}{2}\langle\delta\phi_{1},\mathcal{L}_{1}\phi_{1}-f_{1}+{\color{blue}\mathcal{L}_{12}\phi_{2}}\rangle+\frac{1}{2}\langle\mathcal{L}_{1}\phi_{1}-f_{1}+{\color{brown}\mathcal{L}_{21}\phi_{2}},\delta\phi_{1}\rangle\\
 & +\frac{1}{2}\langle\delta\phi_{2},\mathcal{L}_{2}\phi_{2}-f_{2}+{\color{blue}\mathcal{L}_{21}\phi_{1}}\rangle+\frac{1}{2}\langle\mathcal{L}_{2}\phi_{2}-f_{2}+{\color{brown}\mathcal{L}_{12}\phi_{1}},\delta\phi_{2}\rangle\\
= & \ree\langle\delta\phi_{1},\mathcal{L}_{1}\phi_{1}-f_{1}+{\color{blue}\mathcal{L}_{12}\phi_{2}}\rangle+\ree\langle\delta\phi_{2},\mathcal{L}_{2}\phi_{2}-f_{2}+{\color{blue}\mathcal{L}_{21}\phi_{1}}\rangle
\end{align*}

\end_inset

上面已经使用了厄米性质 
\begin_inset Formula $\langle\mathcal{L}\delta\phi_{i},\phi_{j}\rangle=\langle\delta\phi_{i},\mathcal{L}\phi_{j}\rangle$
\end_inset

以及内积的定义
\begin_inset Formula $\langle\Phi,\psi\rangle=\int_{\Omega}\Phi\psi^{*}\dd{\Omega}$
\end_inset

，以及 
\begin_inset Formula $\mathcal{L}_{12}^{*}=\mathcal{L}_{21}$
\end_inset

。由于
\begin_inset Formula $\delta\phi_{i}$
\end_inset

是任意变分，所以从
\begin_inset Formula $\ree\langle\cdots\rangle=0$
\end_inset

 可以出的
\begin_inset Formula $\phi_{i}$
\end_inset

 必须满足的方程
\begin_inset Formula 
\begin{align*}
 & \mathcal{L}_{1}\phi_{1}-f_{1}+{\color{blue}\mathcal{L}_{12}\phi_{2}}=0\\
 & \mathcal{L}_{2}\phi_{2}-f_{2}+{\color{blue}\mathcal{L}_{21}\phi_{1}}=0
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
上面的式子可以简洁地写成矩阵的形式：
\begin_inset Formula 
\[
F\left[\phi_{i}\right]=\frac{1}{2}\left[\begin{array}{cc}
\phi_{1} & \phi_{2}\end{array}\right]^{*}\left[\begin{array}{cc}
\mathcal{L}_{1} & \mathcal{L}_{12}\\
\mathcal{L}_{21} & \mathcal{L}_{2}
\end{array}\right]\left[\begin{array}{c}
\phi_{1}\\
\phi_{2}
\end{array}\right]-\frac{1}{2}\left[\begin{array}{cc}
\phi_{1} & \phi_{2}\end{array}\right]^{*}\left[\begin{array}{c}
f_{1}\\
f_{2}
\end{array}\right]-\frac{1}{2}\left[\begin{array}{cc}
f_{1} & f_{2}\end{array}\right]^{*}\left[\begin{array}{c}
\phi_{1}\\
\phi_{2}
\end{array}\right]
\]

\end_inset


\begin_inset Formula 
\[
\left[\begin{array}{cc}
\mathcal{L}_{1} & \mathcal{L}_{12}\\
\mathcal{L}_{21} & \mathcal{L}_{2}
\end{array}\right]\left[\begin{array}{c}
\phi_{1}\\
\phi_{2}
\end{array}\right]=\left[\begin{array}{c}
f_{1}\\
f_{2}
\end{array}\right]
\]

\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
或者
\begin_inset Formula 
\[
F\left[\phi_{i}\right]=\frac{1}{2}\phi_{i}^{*}\mathcal{L}_{ij}\phi_{j}-\frac{1}{2}\phi_{i}^{*}f_{i}-\frac{1}{2}f_{i}^{*}\phi_{i}
\]

\end_inset

对应的方程为
\begin_inset Formula 
\[
\mathcal{L}_{ij}\phi_{j}=f_{i}
\]

\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
其中要求
\begin_inset Formula $\mathcal{L}$
\end_inset

 是厄米矩阵，
\begin_inset Formula $\mathcal{L}_{ji}^{*}=\mathcal{L}_{ij}$
\end_inset

：对于对角元素，相当于要求它作用在
\begin_inset Formula $\phi_{i}$
\end_inset

上是厄米的；对于非对角元素，相当于要求它对
\begin_inset Formula $\phi_{i}$
\end_inset

内积是对称的。
\end_layout

\begin_layout Subsubsection
标准变分原理的例子
\end_layout

\begin_layout Example
泊松方程
\begin_inset Formula 
\begin{equation}
-\nabla\cdot(\varepsilon\nabla\Phi)=\rho\label{eq:j6.12}
\end{equation}

\end_inset

显然这个方程的算符为
\begin_inset Formula 
\begin{equation}
\mathcal{L}=-\nabla\cdot(\varepsilon\nabla)\label{eq:j6.13}
\end{equation}

\end_inset


\end_layout

\begin_layout Example
首先来验证
\begin_inset Formula $\mathcal{L}$
\end_inset

满足
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.2"
plural "false"
caps "false"
noprefix "false"

\end_inset

，即厄米条件。根据内积的定义，
\begin_inset Formula $\mathcal{L}$
\end_inset

的作用是：
\begin_inset Formula 
\begin{equation}
\langle\psi,\mathcal{L}\Phi\rangle=\int_{V}\psi^{*}[-\nabla\cdot(\varepsilon\nabla\Phi)]\dd{V}\label{eq:j6.14}
\end{equation}

\end_inset

使用第一标量格林定理
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:jA.20"
plural "false"
caps "false"
noprefix "false"

\end_inset


\begin_inset Formula 
\[
\int_{V}\left[a\nabla\cdot{\color{blue}(u\nabla b)}+u(\nabla a)\cdot(\nabla b)\right]\dd{V}=\oint_{S}a{\color{blue}u\frac{\partial b}{\partial n}}\dd{S}
\]

\end_inset

得到
\begin_inset Formula 
\begin{equation}
\langle\psi,\mathcal{L}\Phi\rangle=\int_{V}\Phi[-\nabla\cdot(\varepsilon\nabla\psi^{*})]\dd{V}-\oint_{S}\varepsilon\left(\psi^{*}\frac{\partial\Phi}{\partial n}-\Phi\frac{\partial\psi^{*}}{\partial n}\right)\dd{S}\label{eq:j6.15}
\end{equation}

\end_inset

其中
\begin_inset Formula $\hat{\sbf n}$
\end_inset

是
\begin_inset Formula $S$
\end_inset

的外法向单位矢量。如果
\begin_inset Formula $\varepsilon$
\end_inset

是实数或实函数，则上式右边第一项可写成
\begin_inset Formula $\langle\mathcal{L}\psi,\Phi\rangle$
\end_inset

。第二项是面积分，如果
\begin_inset Formula $\Phi$
\end_inset

和
\begin_inset Formula $\psi$
\end_inset

均满足齐次狄利克雷边界条件（满足其一即可）
\begin_inset Formula 
\begin{equation}
\Phi=0,\quad\text{在}S_{1}\text{上}\label{eq:j6.16}
\end{equation}

\end_inset

以及第三类齐次边界条件
\begin_inset Formula 
\begin{equation}
\varepsilon\frac{\partial\Phi}{\partial n}+\gamma\Phi=0,\quad\text{在}S_{2}\text{上}\label{eq:j6.17}
\end{equation}

\end_inset

那么，
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.15"
plural "false"
caps "false"
noprefix "false"

\end_inset

式右边第二项为零。上式中的
\begin_inset Formula $\varepsilon$
\end_inset

和
\begin_inset Formula $\gamma$
\end_inset

是实数，而
\begin_inset Formula $S_{1}+S_{2}=S$
\end_inset

。在条件
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.16"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.17"
plural "false"
caps "false"
noprefix "false"

\end_inset

式下， 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.15"
plural "false"
caps "false"
noprefix "false"

\end_inset

变成
\begin_inset Formula 
\begin{equation}
\langle\psi,\mathcal{L}\Phi\rangle=\langle\mathcal{L}\psi,\Phi\rangle\label{eq:j6.18}
\end{equation}

\end_inset

即算符
\begin_inset Formula $\mathcal{L}$
\end_inset

是自伴的条件为：
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\varepsilon$
\end_inset

 和 
\begin_inset Formula $\gamma$
\end_inset

是实数；
\end_layout

\begin_layout Enumerate
边界条件是齐次的。
\end_layout

\begin_layout Standard
在这些条件下，将
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.13"
plural "false"
caps "false"
noprefix "false"

\end_inset

式代入
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.14"
plural "false"
caps "false"
noprefix "false"

\end_inset

中，即可建立泛函
\begin_inset Formula $F$
\end_inset

如下：
\begin_inset Formula 
\begin{equation}
F(\Phi)=\frac{1}{2}\int_{V}\Phi^{*}[-\nabla\cdot(\varepsilon\nabla\Phi)]\dd{V}-\frac{1}{2}\int_{V}\Phi\rho^{*}\dd{V}-\frac{1}{2}\int_{V}\rho\Phi^{*}\dd{V}\label{eq:j6.19}
\end{equation}

\end_inset

应用第一标量格林定理
\begin_inset Formula 
\[
\int_{V}\left[a\nabla\cdot{\color{blue}(u\nabla b)}+u(\nabla a)\cdot(\nabla b)\right]\dd{V}=\oint_{S}a{\color{blue}u\frac{\partial b}{\partial n}}\dd{S}
\]

\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.19"
plural "false"
caps "false"
noprefix "false"

\end_inset

式以及边界条件
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.16"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.17"
plural "false"
caps "false"
noprefix "false"

\end_inset

式，上式可写成
\begin_inset Formula 
\begin{equation}
F(\Phi)=\frac{1}{2}\int_{V}\varepsilon\abs{\nabla\Phi}^{2}\dd{V}+\frac{1}{2}\int_{S_{2}}\gamma\abs{\Phi}^{2}\dd{S}-\frac{1}{2}\int_{V}(\Phi\rho^{*}+\rho\Phi^{*})\dd{V}\label{eq:j6.20}
\end{equation}

\end_inset


\end_layout

\begin_layout Example
考虑下式简化情形
\begin_inset Formula 
\begin{equation}
\langle\Phi,\mathcal{L}\Phi\rangle=\int_{V}\Phi^{*}[-\nabla\cdot(\varepsilon\nabla\Phi)]\dd{V}\label{eq:j6.21}
\end{equation}

\end_inset

应用第一标量格林定理，上式变成
\begin_inset Formula 
\begin{equation}
\langle\Phi,\mathcal{L}\Phi\rangle=\int_{V}\varepsilon\nabla\Phi\cdot\nabla\Phi^{*}\dd{V}-\oint_{S}\varepsilon\Phi*\frac{\partial\Phi}{\partial n}\dd{S}\label{eq:j6.22}
\end{equation}

\end_inset

由于边界条件
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.16"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.17"
plural "false"
caps "false"
noprefix "false"

\end_inset

式，
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.22"
plural "false"
caps "false"
noprefix "false"

\end_inset

式变成
\begin_inset Formula 
\begin{equation}
\langle\Phi,\mathcal{L}\Phi\rangle=\int_{V}\varepsilon\abs{\nabla\Phi}^{2}\dd{V}+\int_{S_{2}}\gamma\abs{\Phi}^{2}\dd{S}\label{eq:6.23}
\end{equation}

\end_inset

假设
\begin_inset Formula $\varepsilon$
\end_inset

和
\begin_inset Formula $\gamma$
\end_inset

非负，且它们不同时为零，显然当
\begin_inset Formula $\Phi\neq0$
\end_inset

时，
\begin_inset Formula $\langle\Phi,\mathcal{L}\Phi\rangle>0$
\end_inset

；当
\begin_inset Formula $\Phi=0$
\end_inset

时，
\begin_inset Formula $\langle\mathcal{L}\Phi,\Phi\rangle=0$
\end_inset

。因此，如果
\begin_inset Formula $\varepsilon$
\end_inset

和
\begin_inset Formula $\gamma$
\end_inset

是正数（非零），那么算符
\begin_inset Formula $\mathcal{L}$
\end_inset

是正定的。在这个条件下，
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.12"
plural "false"
caps "false"
noprefix "false"

\end_inset

式的解对应于
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.20"
plural "false"
caps "false"
noprefix "false"

\end_inset

式中给出泛函的极小值。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Example
上面的过程也适用于矢量问题。在这种情形下，内积定义为
\begin_inset Formula 
\begin{equation}
\langle\sbf a,\sbf b\rangle=\int_{V}\sbf a^{*}\cdot\sbf b\dd{V}\label{eq:j6.24}
\end{equation}

\end_inset

为了说明标准变分原理对矢量问题的应用及其限制，让我们考虑矢量波动方程
\begin_inset Formula 
\begin{equation}
\nabla\times(\frac{1}{\mu_{r}}\nabla\times\sbf E)-k_{0}^{2}\sbf\varepsilon_{r}\sbf E=-jk_{0}Z_{0}\sbf J\label{eq:j6.25}
\end{equation}

\end_inset

其中
\begin_inset Formula $j$
\end_inset

表示虚数单位。对于这种情形，算符
\begin_inset Formula $\mathcal{L}$
\end_inset

可以写成
\begin_inset Formula 
\begin{equation}
\mathcal{L}(\sbf f)=\nabla\times(\frac{1}{\mu_{r}}\nabla\times\sbf f)-k_{0}^{2}\sbf\varepsilon_{r}\sbf f\label{eq:j6.26}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
修正变分原理
\end_layout

\begin_layout Standard
从上节中给出的几个例子可以看到，为了应用标准变分原理，微分方程的算符必须是厄米的。
\end_layout

\begin_layout Enumerate
对一个厄米算符，算符本身以及边界算符必须是实数或实函数。
\end_layout

\begin_layout Enumerate
另外边界条件必须是齐次的。
\end_layout

\begin_layout Standard
然而，在许多电磁学问题中，算符通常是复数或复函数，且边界条件也常常是非齐次的。因此去掉这两个条件十分重要，否则它们将严重限制变分方法的应用。我们在此只考虑第二个
条件，将变分原理修正为能处理非齐次边界条件的变分方法。
\end_layout

\begin_layout Standard
考虑
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

定义的边值问题以及一组非齐次边界条件。
\begin_inset Formula 
\begin{align*}
 & \mathcal{L}\Phi=f\\
 & \Phi=p,\quad\text{on}\quad S_{1}\\
 & \varepsilon\frac{\partial\Phi}{\partial n}+\gamma\Phi=q,\quad\text{on}\quad S_{2}
\end{align*}

\end_inset

式中
\begin_inset Formula $f$
\end_inset

，
\begin_inset Formula $p$
\end_inset

和
\begin_inset Formula $q$
\end_inset

是已知参数。由前面的例子可见，这个问题是非厄米的，然而只要引进新的未知函数
\begin_inset Formula $\Phi'=\Phi-u$
\end_inset

，非厄米问题即可转化成厄米问题。这里的
\begin_inset Formula $u$
\end_inset

是满足给定非齐次边界条件的任意函数。结果新的函数
\begin_inset Formula $\Phi'$
\end_inset

满足其次边界条件，因而问题可以变成厄米的。因此可以用标准变分原理来建立问题的泛函。将
\begin_inset Formula $\Phi=\Phi'+u$
\end_inset

代入
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

，
\begin_inset Formula $\Phi'$
\end_inset

的微分方程可以写成
\begin_inset Formula 
\begin{equation}
\mathcal{L}\Phi'=f'\label{eq:j6.37}
\end{equation}

\end_inset

式中
\begin_inset Formula $f'=f-\mathcal{L}u$
\end_inset

，因此
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.37"
plural "false"
caps "false"
noprefix "false"

\end_inset

的泛函为
\begin_inset Formula 
\begin{equation}
F(\Phi')=\frac{1}{2}\langle\Phi',\mathcal{L}\Phi'\rangle-\frac{1}{2}\langle\Phi',f'\rangle-\frac{1}{2}\langle f',\Phi'\rangle\label{eq:j6.38}
\end{equation}

\end_inset

即
\begin_inset Formula 
\begin{align}
F(\Phi) & =\frac{1}{2}\langle(\Phi-u),\mathcal{L}(\Phi-u)\rangle-\frac{1}{2}\langle(\Phi-u),(f-\mathcal{L}u)\rangle\nonumber \\
 & \quad-\frac{1}{2}\langle(f-\mathcal{L}u),(\Phi-u)\rangle\label{eq:j6.39}
\end{align}

\end_inset

既然只对未知函数
\begin_inset Formula $\Phi$
\end_inset

取变分，那么我们可以丢掉不含
\begin_inset Formula $\Phi$
\end_inset

的项。因此泛函可写成
\begin_inset Formula 
\begin{equation}
F(\Phi)=\frac{1}{2}\langle\Phi,\mathcal{L}\Phi\rangle-\frac{1}{2}\langle u,\mathcal{L}\Phi\rangle+\frac{1}{2}\langle\mathcal{L}u,\Phi\rangle-\frac{1}{2}\langle\Phi,f\rangle-\frac{1}{2}\langle f,\Phi\rangle\label{eq:j6.40}
\end{equation}

\end_inset

在这里并没有将 
\begin_inset Formula $-\frac{1}{2}\langle u,\mathcal{L}\Phi\rangle+\frac{1}{2}\langle\mathcal{L}u,\Phi\rangle$
\end_inset

消去，因为在所考虑的非齐次边界条件下，不能武断的认为 
\begin_inset Formula $\mathcal{L}$
\end_inset

 是厄米的。
\end_layout

\begin_layout Subsection
边界条件的影响
\begin_inset CommandInset label
LatexCommand label
name "subsec:bnd"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\delta F(\phi)= & \frac{1}{2}\left[{\color{blue}\langle\delta\Phi,\mathcal{L}\Phi\rangle}{\color{brown}+\langle\Phi,\mathcal{L}\delta\Phi\rangle-\langle u,\mathcal{L}\delta\Phi\rangle}{\color{red}+\langle\mathcal{L}u,\delta\Phi\rangle}{\color{blue}-\langle\delta\Phi,f\rangle}{\color{red}-\langle f,\delta\Phi\rangle}\right]\nonumber \\
 & =\frac{1}{2}\left[{\color{blue}\langle\delta\Phi,\mathcal{L}\Phi-f\rangle}{\color{brown}+\langle\Phi-u,\mathcal{L}\delta\Phi\rangle}{\color{red}+\langle\mathcal{L}u-f,\delta\Phi\rangle}\right]\label{eq:ym3}
\end{align}

\end_inset

由第二标量格林定理
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:jA.20"
plural "false"
caps "false"
noprefix "false"

\end_inset


\begin_inset Formula 
\[
\int_{V}\Phi^{*}\left[-\nabla\cdot(\varepsilon\nabla\Phi)\right]\dd{V}-\int_{V}\Phi\left[-\nabla\cdot(\varepsilon\nabla\Phi^{*})\right]\dd{V}=-\oint_{S}\varepsilon(\Phi^{*}\frac{\partial\Phi}{\partial n}-\Phi\frac{\partial\Phi^{*}}{\partial n})\dd{S}
\]

\end_inset

此表达式即
\begin_inset Formula $\langle\Phi,\mathcal{L}\Phi\rangle-\langle\mathcal{L}\Phi,\Phi\rangle$
\end_inset

的余项。在边界
\begin_inset Formula $S_{1}$
\end_inset

和
\begin_inset Formula $S_{2}$
\end_inset

上分别讨论：
\end_layout

\begin_layout Enumerate
在 
\begin_inset Formula $S_{1}$
\end_inset

上，
\begin_inset Formula $\Phi=p$
\end_inset

，则
\begin_inset Formula 
\[
\Phi^{*}\frac{\partial\Phi}{\partial n}-\Phi\frac{\partial\Phi^{*}}{\partial n}=p^{*}\frac{\partial p}{\partial n}-p\frac{\partial p{}^{*}}{\partial n}
\]

\end_inset

若
\begin_inset Formula $p$
\end_inset

是实数，显然有
\begin_inset Formula $\langle\Phi,\mathcal{L}\Phi\rangle=\langle\mathcal{L}\Phi,\Phi\rangle$
\end_inset

。
\end_layout

\begin_layout Enumerate
在
\begin_inset Formula $S_{2}$
\end_inset

上，
\begin_inset Formula $\varepsilon\frac{\partial\Phi}{\partial n}=q-\gamma\Phi$
\end_inset

，则
\begin_inset Formula 
\begin{align*}
\Phi^{*}\frac{\partial\Phi}{\partial n}-\Phi\frac{\partial\Phi^{*}}{\partial n} & =\Phi^{*}(q-\gamma\Phi)-\Phi(q^{*}-\gamma\Phi^{*})\\
 & =\Phi^{*}q-\Phi q^{*}
\end{align*}

\end_inset

如果
\begin_inset Formula $\Phi$
\end_inset

，
\begin_inset Formula $q$
\end_inset

是实数，则也有
\begin_inset Formula $\langle\Phi,\mathcal{L}\Phi\rangle=\langle\mathcal{L}\Phi,\Phi\rangle$
\end_inset

。
\end_layout

\begin_layout Enumerate
前面假设了
\begin_inset Formula $u$
\end_inset

和
\begin_inset Formula $\Phi$
\end_inset

满足相同的边界条件，对于
\begin_inset Formula $\langle\Phi,\mathcal{L}u\rangle-\langle\mathcal{L}\Phi,u\rangle$
\end_inset

的讨论是类似的，结果为
\begin_inset Formula 
\[
\Phi^{*}(q-\gamma u)-u(q^{*}-\gamma\Phi^{*})
\]

\end_inset


\begin_inset Formula 
\begin{align*}
 & \Phi^{*}\frac{\partial u}{\partial n}-u\frac{\partial\Phi^{*}}{\partial n}=p^{*}\frac{\partial p}{\partial n}-p\frac{\partial p{}^{*}}{\partial n},\quad\text{on}\;S_{1}\\
 & \Phi^{*}\frac{\partial u}{\partial n}-u\frac{\partial\Phi^{*}}{\partial n}=\Phi^{*}q-q^{*}u,\quad\text{on}\;S_{2}
\end{align*}

\end_inset

可以看出，在
\begin_inset Formula $S_{1}$
\end_inset

上如果
\begin_inset Formula $p$
\end_inset

是函数，则
\begin_inset Formula ${\color{brown}\langle u,\mathcal{L}\delta\Phi\rangle=\langle\mathcal{L}u,\delta\Phi\rangle}$
\end_inset

；在
\begin_inset Formula $S_{2}$
\end_inset

上，即使
\begin_inset Formula $q$
\end_inset

，
\begin_inset Formula $\Phi$
\end_inset

，
\begin_inset Formula $u$
\end_inset

都是实函数，
\begin_inset Formula $\Phi^{*}q-q^{*}u$
\end_inset

 也未必为零，因而未必有
\begin_inset Formula ${\color{brown}\langle u,\mathcal{L}\delta\Phi\rangle=\langle\mathcal{L}u,\delta\Phi\rangle}$
\end_inset

。因此，在
\begin_inset Formula $S_{1}$
\end_inset

上
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:ym3"
plural "false"
caps "false"
noprefix "false"

\end_inset

也许能获得简化
\begin_inset Formula 
\begin{align*}
\delta F(\phi)= & \frac{1}{2}\left[{\color{blue}\langle\delta\Phi,\mathcal{L}\Phi-f\rangle}{\color{brown}+\langle\Phi-u,\mathcal{L}\delta\Phi\rangle}{\color{red}+\langle\mathcal{L}u-f,\delta\Phi\rangle}\right]\\
= & \frac{1}{2}\left[{\color{blue}\langle\delta\Phi,\mathcal{L}\Phi-f\rangle}{\color{brown}+\langle\mathcal{L}\Phi-\mathcal{L}u}{\color{red}+\mathcal{L}u-f},\delta\Phi\rangle\right]\\
= & \ree\langle\delta\Phi,\mathcal{L}\Phi-f\rangle
\end{align*}

\end_inset

但在
\begin_inset Formula $S_{2}$
\end_inset

上却未必有
\begin_inset Formula $\delta F(\phi)=\ree\langle\delta\Phi,\mathcal{L}\Phi-f\rangle$
\end_inset

。
\end_layout

\begin_layout Standard
总结，
\begin_inset Formula $S_{1}$
\end_inset

上的实函数第一类边界条件不会影响微分方程的成立，也就不影响有限元方程的建立；而
\begin_inset Formula $S_{2}$
\end_inset

上的实函数第二类边界条件会有 non–trivial 的影响，会影响到边界
\begin_inset Formula $S_{2}$
\end_inset

上方程的形式。
\end_layout

\begin_layout Subsection
应用举例
\end_layout

\begin_layout Standard
在下面的例子中将会看出，上式右边的第二项和第三项通常可转化成边界积分或边界项，其中
\begin_inset Formula $u$
\end_inset

在应用边界条件后消失。我们称上面描述的结果为 
\series bold
修正变分原理
\series default
，在此重述如下：给定边值问题
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

式，如果算符
\begin_inset Formula $\mathcal{L}$
\end_inset

在齐次边界条件下是厄米的，那么其解可通过求泛函
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.40"
plural "false"
caps "false"
noprefix "false"

\end_inset

式的驻点而得到，其中
\begin_inset Formula $u$
\end_inset

是满足给定非齐次边界条件的任意函数。
\end_layout

\begin_layout Standard
现在，让我们用上节中的例子来说明修正变分原理的应用。考虑泊松方程
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.12"
plural "false"
caps "false"
noprefix "false"

\end_inset

式所定义的问题以及下列边界条件：
\begin_inset Formula 
\begin{align}
 & -\nabla\cdot(\varepsilon\nabla\Phi)=\rho\nonumber \\
 & \Phi=p,\quad\text{on}\quad S_{1}\label{eq:j6.41}\\
 & \varepsilon\frac{\partial\Phi}{\partial n}+\gamma\Phi=q,\quad\text{on}\quad S_{2}\label{eq:j6.42}
\end{align}

\end_inset

式中
\begin_inset Formula $p$
\end_inset

和
\begin_inset Formula $q$
\end_inset

是已知参数。正如在上节中所证明的那样，只要
\begin_inset Formula $\varepsilon$
\end_inset

和
\begin_inset Formula $\gamma$
\end_inset

是实数或实函数，算符
\begin_inset Formula $\mathcal{L}$
\end_inset

在齐次边界条件下就是厄米的。因此将
\begin_inset Formula $\mathcal{L}=-\nabla\cdot(\varepsilon\nabla\cdots)$
\end_inset

 和
\begin_inset Formula $f=\rho$
\end_inset

 代入
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.40"
plural "false"
caps "false"
noprefix "false"

\end_inset

式，即可得到该问题的泛函
\begin_inset Formula $F(\Phi)$
\end_inset

为
\begin_inset Formula 
\begin{align}
F(\Phi)= & \frac{1}{2}\int_{V}\Phi^{*}\left[-\nabla\cdot(\varepsilon\nabla\Phi)\right]\dd{V}+\frac{1}{2}\int_{V}\left\{ u^{*}\left[\nabla\cdot(\varepsilon\nabla\Phi)\right]-\left[\nabla\cdot(\varepsilon\nabla u)\right]^{*}\Phi\right\} \dd{V}\nonumber \\
 & -\frac{1}{2}\int_{V}\left(\Phi^{*}\rho+\rho^{*}\Phi\right)\dd{V}\label{eq:j6.43}
\end{align}

\end_inset

式中
\begin_inset Formula $u$
\end_inset

是满足
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.41"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.42"
plural "false"
caps "false"
noprefix "false"

\end_inset

式的任意函数。应用第二标量格林定理
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:jA.20"
plural "false"
caps "false"
noprefix "false"

\end_inset

式
\begin_inset Formula 
\[
\int_{V}\left[a\nabla\cdot{\color{blue}(u\nabla b)}-b\nabla\cdot{\color{brown}(u\nabla a)}\right]\dd{V}=\oint_{S}u({\color{blue}a\frac{\partial b}{\partial n}}{\color{brown}-b\frac{\partial a}{\partial n}})\dd{S}
\]

\end_inset

得到
\begin_inset Formula 
\begin{align}
F(\Phi)= & \frac{1}{2}\int_{V}\Phi^{*}\left[-\nabla\cdot(\varepsilon\nabla\Phi)\right]\dd{V}-\frac{1}{2}\int_{V}\left(\Phi^{*}\rho+\rho^{*}\Phi\right)\dd{V}\nonumber \\
 & +\frac{1}{2}{\color{blue}\oint_{S}}\varepsilon\left(u^{*}\frac{\partial\Phi}{\partial n}-\Phi\frac{\partial u^{*}}{\partial n}\right)\dd{S}\label{eq:j6.44}
\end{align}

\end_inset

因为
\begin_inset Formula $\Phi$
\end_inset

和
\begin_inset Formula $u$
\end_inset

均满足边界条件
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.41"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.42"
plural "false"
caps "false"
noprefix "false"

\end_inset

式，将它们应用于上式得到
\begin_inset Formula 
\begin{align}
F(\Phi)= & \frac{1}{2}\int_{V}\Phi^{*}\left[-\nabla\cdot(\varepsilon\nabla\Phi)\right]\dd{V}-\frac{1}{2}\int_{V}\left(\Phi^{*}\rho+\rho^{*}\Phi\right)\dd{V}\nonumber \\
 & +\frac{1}{2}{\color{blue}\int_{S_{1}}}\varepsilon\left(p^{*}\frac{\partial\Phi}{\partial n}-p\frac{\partial u^{*}}{\partial n}\right)\dd{S}+\frac{1}{2}{\color{blue}\int_{S_{2}}}\left(qu^{*}-q^{*}\Phi\right)\dd{S}\label{eq:j6.45}
\end{align}

\end_inset

丢掉不包含
\begin_inset Formula $\Phi$
\end_inset

的项，上式可写成
\begin_inset Formula 
\begin{align}
F(\Phi)= & \frac{1}{2}\int_{V}\Phi^{*}\left[-\nabla\cdot(\varepsilon\nabla\Phi)\right]\dd{V}-\frac{1}{2}\int_{V}\left(\Phi^{*}\rho+\rho^{*}\Phi\right)\dd{V}\nonumber \\
 & +\frac{1}{2}{\color{blue}\int_{S_{1}}}\varepsilon p^{*}\frac{\partial\Phi}{\partial n}\dd{S}-\frac{1}{2}{\color{blue}\int_{S_{2}}}q^{*}\Phi\dd{S}\label{eq:j6.46}
\end{align}

\end_inset

应用
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:jA.19"
plural "false"
caps "false"
noprefix "false"

\end_inset


\begin_inset Formula 
\[
\int_{V}\left[a\nabla\cdot{\color{blue}(u\nabla b)}+u(\nabla a)\cdot(\nabla b)\right]\dd{V}=\oint_{S}a{\color{blue}u\frac{\partial b}{\partial n}}\dd{S},
\]

\end_inset

以及
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.41"
plural "false"
caps "false"
noprefix "false"

\end_inset

、
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.42"
plural "false"
caps "false"
noprefix "false"

\end_inset

的边界条件，代入中间等式
\begin_inset Formula 
\begin{align*}
\int_{V}\Phi^{*}\left[-\nabla\cdot(\varepsilon\nabla\Phi)\right]\dd{V} & =\int_{V}\varepsilon\abs{\nabla\Phi}^{2}\dd{V}-\oint_{S_{1}+S_{2}}{\color{brown}\varepsilon\Phi^{*}\frac{\partial\Phi}{\partial n}}\dd{S}\\
\gamma\abs{\Phi}^{2}-q\Phi^{*} & =-{\color{brown}\varepsilon\Phi^{*}\frac{\partial\Phi}{\partial n}},\quad\text{on}\quad S_{2}
\end{align*}

\end_inset

边界项的变形为：
\begin_inset Formula 
\begin{align*}
 & \frac{1}{2}\left[{\color{blue}\int_{S_{1}}}\varepsilon p^{*}\frac{\partial\Phi}{\partial n}\dd{S}-{\color{blue}\int_{S_{2}}}q^{*}\Phi\dd{S}\right]-\oint_{S_{1}+S_{2}}\cdots\dd{S}\\
\Rightarrow & \frac{1}{2}\left[{\color{blue}\int_{S_{1}}}\varepsilon(p^{*}-\Phi^{*})\frac{\partial\Phi}{\partial n}\dd{S}-{\color{blue}\int_{S_{2}}}q^{*}\Phi+\varepsilon\Phi^{*}\frac{\partial\Phi}{\partial n}\dd{S}\right]
\end{align*}

\end_inset

上式可写成对称形式
\begin_inset Formula 
\begin{align}
\mathcal{F}(\Phi)= & \frac{1}{2}\int_{V}\varepsilon\abs{\nabla\Phi}^{2}\dd{V}-\frac{1}{2}\int_{V}\left(\Phi^{*}\rho+\rho^{*}\Phi\right)\dd{V}\nonumber \\
 & +\frac{1}{2}\int_{S_{2}}\left(\gamma\abs{\Phi}^{2}-q\Phi^{*}-q^{*}\Phi\right)\dd{S}\label{eq:j6.47}
\end{align}

\end_inset

其中
\begin_inset Formula $S_{1}$
\end_inset

上的积分已经被消除。
\end_layout

\begin_layout Remark
当考虑的问题在实数域，即
\begin_inset Formula $\Phi,\rho,q,\gamma,\varepsilon$
\end_inset

均为实函数，
\begin_inset Formula 
\begin{align}
\mathcal{F}(\Phi)= & \frac{1}{2}\int_{V}\varepsilon(\nabla\Phi)\cdot\varepsilon(\nabla\Phi)\dd{V}-\int_{V}\Phi\rho\dd{V}\nonumber \\
 & +\int_{S_{2}}\left(\frac{1}{2}\gamma\Phi^{2}-q\Phi\right)\dd{S}\label{eq:j6.47c}
\end{align}

\end_inset

使用
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:jA.19"
plural "false"
caps "false"
noprefix "false"

\end_inset

将给出：
\begin_inset Formula 
\begin{align}
\mathcal{F}(\Phi)= & \frac{1}{2}\int_{V}\Phi[-\nabla\cdot(\varepsilon\nabla\Phi)]\dd{V}-\int_{V}\Phi\rho\dd{V}\nonumber \\
 & +\int_{S_{2}}\left(\frac{\varepsilon}{2}\Phi\frac{\partial}{\partial n}\Phi+\frac{1}{2}\gamma\Phi^{2}-q\Phi\right)\dd{S}\label{eq:j6.47b}
\end{align}

\end_inset

其中
\begin_inset Formula $\frac{\partial}{\partial n}$
\end_inset

理解为厄米算符，
\begin_inset Formula $\Phi\frac{\partial}{\partial n}\Phi$
\end_inset

理解为二次型。这里再次列出对应的方程和边界条件：
\begin_inset Formula 
\begin{align*}
 & -\nabla\cdot(\varepsilon\nabla\Phi)=\rho\\
 & \Phi=p,\quad\text{on}\quad S_{1}\\
 & \varepsilon\frac{\partial\Phi}{\partial n}+\gamma\Phi=q,\quad\text{on}\quad S_{2}
\end{align*}

\end_inset


\end_layout

\begin_layout Subsection
多场耦合
\end_layout

\begin_layout Standard
单场
\begin_inset Formula $\phi$
\end_inset

的作用量
\begin_inset Formula $\mathcal{F}(\phi)$
\end_inset

写作
\begin_inset Formula 
\begin{align*}
\mathcal{F}(\phi)= & \frac{1}{2}\langle\phi',\mathcal{L}\phi'\rangle-\frac{1}{2}\langle\phi',f'\rangle-\frac{1}{2}\langle f',\phi'\rangle\\
= & \frac{1}{2}\langle\phi,\mathcal{L}\phi\rangle-\frac{1}{2}\langle u,\mathcal{L}\phi\rangle+\frac{1}{2}\langle\mathcal{L}u,\phi\rangle-\frac{1}{2}\langle\phi,f\rangle-\frac{1}{2}\langle f,\phi\rangle
\end{align*}

\end_inset

其中
\begin_inset Formula $\phi'=\phi-u$
\end_inset

，
\begin_inset Formula $f'=f-\mathcal{L}u$
\end_inset

，
\begin_inset Formula $u$
\end_inset

是引入的任意函数，
\begin_inset Formula $u$
\end_inset

和
\begin_inset Formula $\phi$
\end_inset

均满足非齐次边界条件：
\begin_inset Formula 
\begin{align*}
 & \Phi=p,\quad\text{on}\quad S_{1}\\
 & \varepsilon\frac{\partial\Phi}{\partial n}+\gamma\Phi=q,\quad\text{on}\quad S_{2}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
类似标准变分原理，将多场耦合的
\begin_inset Formula $\mathcal{F}(\phi)$
\end_inset

用指标表示为
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula 
\begin{align*}
F\left[\phi_{i}\right] & =\frac{1}{2}\left(\phi_{i}-u_{i}\right)^{*}\mathcal{L}_{ij}\left(\phi_{j}-u_{j}\right)-\frac{1}{2}\left(\phi_{i}-u_{i}\right)^{*}\left(f_{i}-\mathcal{L}_{ij}u_{j}\right)-\frac{1}{2}\left(f_{i}-\mathcal{L}_{ij}u_{j}\right)^{*}\left(\phi_{i}-u_{i}\right)\\
 & =\frac{1}{2}\left[\phi_{i}^{*}\mathcal{L}_{ij}\phi_{j}{\color{blue}-u_{i}^{*}\mathcal{L}_{ij}\phi_{j}+\phi_{j}\mathcal{L}_{ji}^{*}u_{i}^{*}}-\phi_{i}^{*}f_{i}-f_{i}^{*}\phi_{i}\right]
\end{align*}

\end_inset

如同
\begin_inset CommandInset ref
LatexCommand eqref
reference "subsec:bnd"
plural "false"
caps "false"
noprefix "false"

\end_inset

那里所讨论的，由于考虑的非齐次边界条件，
\begin_inset Formula $u_{i}^{*}\mathcal{L}_{ij}\phi_{j}$
\end_inset

 未必等于
\begin_inset Formula $\phi_{j}\mathcal{L}_{ji}^{*}u_{i}^{*}$
\end_inset

，也就是 
\begin_inset Formula $\mathcal{L}_{ji}^{*}$
\end_inset

 在此环境下未必厄米，至少前面已经证明了单场对应的对角项 
\begin_inset Formula $u_{i}^{*}\mathcal{L}_{ii}\phi_{i}$
\end_inset

 非厄米。
\end_layout

\begin_layout Section
广义变分原理
\end_layout

\begin_layout Standard
上节给出的修正变分原理能够用来列出几乎所有无耗媒质的电磁学问题的计算公式。但是它不能用于有耗媒质，因为这些问题的有关算符是复数或复函数。正如在
\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:6.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

节中证明的那样，这些算符是非自伴（非厄米）的。本节的目的是重新定义内积，从而去掉这个限制条件。
\end_layout

\begin_layout Standard
将厄米算符限制在实算符范围内的条件直接来自于有关内积的定义
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.5"
plural "false"
caps "false"
noprefix "false"

\end_inset

式。如果我们不用
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.5"
plural "false"
caps "false"
noprefix "false"

\end_inset

式，而将内积重新定义为
\begin_inset Formula 
\begin{equation}
\langle\Phi,\psi\rangle=\int_{\Omega}\Phi\psi\dd{\Omega}\label{eq:j6.55}
\end{equation}

\end_inset

那么限制条件立即被取消了。因此内积定义的选择在某些情况下决定了一个算符是否厄米。
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.5"
plural "false"
caps "false"
noprefix "false"

\end_inset

式定义的内积通常被称为希尔伯特（Hilbert）空间中的内积；而
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.55"
plural "false"
caps "false"
noprefix "false"

\end_inset

定义的内积通常叫做
\series bold
对称积
\series default
。
\end_layout

\begin_layout Standard
现在的问题是：如果我们用
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.55"
plural "false"
caps "false"
noprefix "false"

\end_inset

式定义的内积，那么
\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:6.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

节开始描述的变分原理还成立吗？答案是肯定的。为了证明，我们取
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.4"
plural "false"
caps "false"
noprefix "false"

\end_inset

式给出泛函
\begin_inset Formula $F$
\end_inset

的第一变分，得到
\begin_inset Formula 
\begin{equation}
\delta F=\frac{1}{2}\langle\mathcal{L}\delta\Phi,\Phi\rangle+\frac{1}{2}\langle\mathcal{L}\Phi,\delta\Phi\rangle-\frac{1}{2}\langle\delta\Phi,f\rangle-\frac{1}{2}\langle f,\delta\Phi\rangle\label{eq:j6.56}
\end{equation}

\end_inset

因为
\begin_inset Formula $\mathcal{L}$
\end_inset

在内积的新定义下是自伴的，所以上式可写成
\begin_inset Formula 
\begin{equation}
\delta F=\langle\delta\Phi,\mathcal{L}\Phi-f\rangle\label{eq:j6.57}
\end{equation}

\end_inset

强加驻点条件
\begin_inset Formula $\delta F=0$
\end_inset

，我们可以得到
\begin_inset Formula 
\begin{equation}
\langle\delta\Phi,\mathcal{L}\Phi-f\rangle=0\label{eq:j6.58}
\end{equation}

\end_inset

因为
\begin_inset Formula $\delta\Phi$
\end_inset

是任意变分，我们从上式得出结论：
\begin_inset Formula $\Phi$
\end_inset

满足
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

式。在
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.55"
plural "false"
caps "false"
noprefix "false"

\end_inset

的定义下，
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.4"
plural "false"
caps "false"
noprefix "false"

\end_inset

式可写成
\begin_inset Formula 
\begin{equation}
F(\phi)=\frac{1}{2}\langle\mathcal{L}\Phi,\Phi\rangle-\langle\Phi,f\rangle\label{eq:j6.59}
\end{equation}

\end_inset

对于包含非齐次边界条件的问题，修正变分原理仍保持正确，因而6.40式中给出的泛函可写成
\begin_inset Formula 
\begin{equation}
F(\Phi)=\frac{1}{2}\langle\mathcal{L}\Phi,\Phi\rangle-\frac{1}{2}\langle\mathcal{L}\Phi,u\rangle+\frac{1}{2}\langle\Phi,\mathcal{L}u\rangle-\langle\Phi,f\rangle\label{eq:j6.60}
\end{equation}

\end_inset

称上式为
\series bold
广义变分原理
\series default
。我们可用
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.60"
plural "false"
caps "false"
noprefix "false"

\end_inset

式列出多数电磁学边值问题的计算公式。定义
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.55"
plural "false"
caps "false"
noprefix "false"

\end_inset

的直接结果是：对于复数问题，用广义原理推导出的泛函是复数量；而用前面的变分原理推导出的泛函始终是实数，并且它们通常对应于一个物理量（例如功率、功和能量）。显然，
对于复泛函，谈论极小值、极大值、甚至拐点都是毫无意义的。描述条件
\begin_inset Formula $\delta F=0$
\end_inset

的恰当词可能是“驻定的”或“驻定性”。最后我们指出：不论用广义原理还是用前面的原理建立问题的公式，与用里兹过程得到的最终方程组都是相同的。
\end_layout

\begin_layout Standard
用内积的新定义，我们可推导出由
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.12"
plural "false"
caps "false"
noprefix "false"

\end_inset

、
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.14"
plural "false"
caps "false"
noprefix "false"

\end_inset

式和6.42式定义问题的泛函：
\begin_inset Formula 
\[
F(\Phi)=\frac{1}{2}\int_{V}\varepsilon\nabla\phi\cdot\nabla\Phi\dd{V}-\int_{V}\Phi\rho\dd{V}+\int_{S_{2}}\left(\frac{\gamma}{2}\Phi^{2}-\Phi q\right)\dd{S}
\]

\end_inset

即使
\begin_inset Formula $\varepsilon$
\end_inset

和
\begin_inset Formula $\gamma$
\end_inset

是复数，上式也成立。对于矢量，相应的新内积定义为
\begin_inset Formula 
\begin{equation}
\langle\sbf a,\sbf b\rangle=\int_{V}\sbf a\cdot\sbf b\dd{V}\label{eq:j6.61}
\end{equation}

\end_inset

应用这个定义，我们可推导出由
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:j6.25"
plural "false"
caps "false"
noprefix "false"

\end_inset

、6.48、和6.49 定义的泛函
\begin_inset Formula 
\begin{align*}
F(\sbf E) & =\frac{1}{2}\int_{V}\left[\frac{1}{\mu_{r}}(\nabla\times\sbf E)\cdot(\nabla\times\sbf E)-k_{0}^{2}\varepsilon_{r}\sbf E\cdot\sbf E\right]\dd{V}\\
 & \quad+\frac{1}{2}\int_{S_{2}}\left[\frac{\gamma_{e}}{2}(\hat{\sbf n}\times\sbf E)\cdot(\hat{\sbf n}\times\sbf E)+\sbf E\cdot\sbf U\right]\dd{S}\\
 & \quad+jk_{0}Z_{0}\int_{V}\sbf E\cdot\sbf J\dd{V}
\end{align*}

\end_inset

即使
\begin_inset Formula $\varepsilon_{r}$
\end_inset

、
\begin_inset Formula $u_{r}$
\end_inset

和
\begin_inset Formula $\gamma_{e}$
\end_inset

是复数，上式仍然成立。
\end_layout

\begin_layout Exercise
证明：用广义变分原理推导出练习 6.3中定义问题的泛函为
\begin_inset Formula 
\begin{align*}
F(\Phi) & =\frac{1}{2}\int_{V}\left[\alpha_{x}(\frac{\partial\Phi}{\partial x})^{2}+\alpha_{x}(\frac{\partial\Phi}{\partial x})^{2}+\alpha_{x}(\frac{\partial\Phi}{\partial x})^{2}+\beta\Phi^{2}\right]\dd{V}\\
 & \quad+\frac{1}{2}\int_{S_{2}}\left(\frac{\gamma}{2}\Phi^{2}-q\Phi\right)\dd{S}-\int_{V}f\Phi\dd{V}
\end{align*}

\end_inset

不论
\begin_inset Formula $\alpha_{x}$
\end_inset

、
\begin_inset Formula $\alpha_{y}$
\end_inset

、
\begin_inset Formula $\alpha_{z}$
\end_inset

、
\begin_inset Formula $\beta$
\end_inset

和
\begin_inset Formula $\gamma$
\end_inset

是复数还是实数，上式均成立。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Exercise
证明：用广义变分原理推导出练习6.4中定义问题的泛函为
\begin_inset Formula 
\begin{align*}
F(\sbf E) & =\frac{1}{2}\int_{V}\left[\frac{1}{\varepsilon_{r}}(\nabla\times\sbf H)\cdot(\nabla\times\sbf H)-k_{0}^{2}\mu_{r}\sbf H\cdot\sbf H\right]\dd{V}\\
 & \quad+\frac{1}{2}\int_{S_{2}}\left[\frac{\gamma_{e}}{2}(\hat{\sbf n}\times\sbf H)\cdot(\hat{\sbf n}\times\sbf H)+\sbf H\cdot\sbf V\right]\dd{S}\\
 & \quad-\int_{V}\sbf H\cdot(\nabla\times\frac{1}{\varepsilon_{r}}\sbf J)\dd{V}
\end{align*}

\end_inset

即使
\begin_inset Formula $\varepsilon_{r}$
\end_inset

、
\begin_inset Formula $u_{r}$
\end_inset

和
\begin_inset Formula $\gamma_{e}$
\end_inset

是复数，上式也成立。
\end_layout

\begin_layout Chapter
本征值问题–波导和腔体 p140/137
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
[A]\,\{\Phi\}-\lambda\,[B]\,\{\Phi\}=\{0\}\label{eq:7.1}
\end{equation}

\end_inset

式中，
\begin_inset Formula $[A]$
\end_inset

和
\begin_inset Formula $[B]$
\end_inset

是已知矩阵，
\begin_inset Formula $\lambda$
\end_inset

和
\begin_inset Formula $\{\Phi\}$
\end_inset

是未知量。
\end_layout

\begin_layout Section
封闭波导的标量解
\end_layout

\begin_layout Standard
该公式也被称为
\begin_inset Formula $E_{z}$
\end_inset

–
\begin_inset Formula $H_{z}$
\end_inset

公式，它是标量的。
\end_layout

\begin_layout Subsection
均匀波导
\end_layout

\begin_layout Standard
在均匀填充波导中，存在两套不同的模式。一套模式在传播方向上没有磁场分量，被称为横磁（TM）模。相反，另一套在传播方向上没有电场分量，因而被称为横电（TE）模。假
设无限长波导的轴沿
\begin_inset Formula $z$
\end_inset

轴向，而且波沿
\begin_inset Formula $\hat{z}$
\end_inset

方向传播，那么波导中的场可表示成
\begin_inset Formula 
\begin{align}
\sbf E(x,y,z) & =\sbf E(x,y)\,e^{j\,(\omega t-k_{z}z)}\label{eq:7.2}\\
\sbf H(x,y,z) & =\sbf H(x,y)\,e^{j\,(\omega t-k_{z}z)}\label{eq:7.3}
\end{align}

\end_inset

其中
\begin_inset Formula $\omega$
\end_inset

表示角频率，
\begin_inset Formula $k_{z}$
\end_inset

表示传播常数。将上两式代入到无源的麦克斯韦方程组中，
\begin_inset Formula 
\begin{align*}
 & \nabla\times\sbf E=-\partial_{t}\sbf B\\
 & \nabla\times\sbf H=\partial_{t}\sbf D
\end{align*}

\end_inset

得到
\begin_inset Formula 
\begin{align}
\partial_{y}{\color{blue}E_{z}} & =-jk_{z}\,E_{y}-j\omega\mu\,H_{x}\label{eq:7.4}\\
\partial_{x}{\color{blue}E_{z}} & =-jk_{z}\,E_{x}+j\omega\mu\,H_{y}\label{eq:7.5}\\
\partial_{x}E_{y}-\partial_{y}E_{x} & =-j\omega\mu{\color{blue}H_{z}}\label{eq:7.6}\\
\partial_{y}{\color{blue}H_{z}} & =-jk_{z}H_{y}+j\omega\varepsilon E_{x}\label{eq:7.7}\\
\partial_{x}{\color{blue}H_{z}} & =-jk_{z}H_{x}-j\omega\varepsilon E_{y}\label{eq:7.8}\\
\partial_{x}H_{y}-\partial_{y}H_{x} & =j\omega\varepsilon{\color{blue}E_{z}}\label{eq:7.9}
\end{align}

\end_inset

如果
\begin_inset Formula $E_{z}$
\end_inset

和
\begin_inset Formula $H_{z}$
\end_inset

已知，那么从
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:7.4"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:7.8"
plural "false"
caps "false"
noprefix "false"

\end_inset

式可推导出
\begin_inset Formula $E_{y}$
\end_inset

和
\begin_inset Formula $H_{x}$
\end_inset

；同样从
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:7.5"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:7.7"
plural "false"
caps "false"
noprefix "false"

\end_inset

式可推导出
\begin_inset Formula $E_{x}$
\end_inset

和
\begin_inset Formula $H_{y}$
\end_inset

。因此电磁场的确定退化成两个分量
\begin_inset Formula $E_{z}$
\end_inset

和
\begin_inset Formula $H_{z}$
\end_inset

。另外从上面几个式子不难证明
\begin_inset Formula $E_{z}$
\end_inset

和
\begin_inset Formula $H_{z}$
\end_inset

满足齐次亥姆霍兹方程
\begin_inset Formula 
\begin{equation}
\partial_{x}^{2}\Phi+\partial_{y}^{2}\Phi+k_{t}^{2}\Phi=0\label{eq:7.10}
\end{equation}

\end_inset

式中
\begin_inset Formula $k_{t}^{2}=\omega^{2}\mu\varepsilon-k_{z}^{2}$
\end_inset

。对于TM情形，
\begin_inset Formula $\Phi=E_{z}$
\end_inset

，因此
\begin_inset Formula $\Phi$
\end_inset

在波导壁上满足齐次狄利克雷边界条件
\begin_inset Formula 
\begin{equation}
E_{z}=0,\quad\text{TM},\text{在}\Gamma\text{上},\label{eq:7.11}
\end{equation}

\end_inset

但对于 TE 情形，
\begin_inset Formula $\Phi=H_{z}$
\end_inset

，因此
\begin_inset Formula $\Phi$
\end_inset

在波导壁上满足 齐次诺伊曼条件
\begin_inset Formula 
\begin{equation}
\frac{\partial\Phi}{\partial n}=0,\quad\text{在}\Gamma\text{上}\label{eq:7.12}
\end{equation}

\end_inset

式中
\begin_inset Formula $\Gamma$
\end_inset

表示波导壁的导电边界，
\begin_inset Formula $\hat{\sbf n}$
\end_inset

是其单位法向。
\end_layout

\begin_layout Remark
在TE情形
\begin_inset Formula $E_{z}=0$
\end_inset

。在波导管壁上，
\begin_inset Formula $\sbf E$
\end_inset

只有纵向分量。若某处管壁法向为
\begin_inset Formula $x$
\end_inset

，则要求
\begin_inset Formula $E_{y}=0$
\end_inset

，再结合
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:7.4"
plural "false"
caps "false"
noprefix "false"

\end_inset

，
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:7.8"
plural "false"
caps "false"
noprefix "false"

\end_inset


\begin_inset Formula 
\begin{align*}
j\omega\varepsilon E_{y} & =-jk_{z}H_{x}-\partial_{x}{\color{blue}H_{z}}\\
0 & =-jk_{z}\,E_{y}-j\omega\mu\,H_{x}\\
E_{y} & =0
\end{align*}

\end_inset

因此得到 
\begin_inset Formula $\partial_{x}H_{z}=0$
\end_inset

。同理，若管壁法向为
\begin_inset Formula $y$
\end_inset

，也能得到 
\begin_inset Formula $\partial_{y}H_{z}=0$
\end_inset

。一般形式为
\begin_inset Formula 
\[
\frac{\partial H_{z}}{\partial n}=0
\]

\end_inset


\end_layout

\begin_layout Remark
在4.2节中，我们建立了该问题的等价变分问题的公式，其泛函
\begin_inset Formula $F$
\end_inset

由（4.7）式给出。对这种情形，泛函可以写成特殊形式
\begin_inset Formula 
\begin{equation}
F(\Phi)=\frac{1}{2}\iint_{\Omega}\left[\left(\partial_{x}\Phi\right)^{2}+\left(\partial_{y}\Phi\right)^{2}-k_{t}^{2}\,\Phi^{2}\right]\dd{\Omega}\label{eq:7.13}
\end{equation}

\end_inset

式中，
\begin_inset Formula $\Omega$
\end_inset

表示波导的横截面。应用第四章中描述的有限元分析，可得到方程组
\begin_inset Formula 
\begin{equation}
[K]\,\{\Phi\}=\{0\}\label{eq:7.14}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
K_{\alpha\beta}^{e}=\iint_{\Omega^{e}}\left(\partial_{x}N_{\alpha}^{e}\,\partial_{x}N_{\beta}^{e}+\partial_{y}N_{\alpha}^{e}\,\partial_{y}N_{\beta}^{e}-k_{t}^{2}\,N_{\alpha}^{e}N_{\beta}^{e}\right)\dd{\Omega}\label{eq:7.15}
\end{equation}

\end_inset

因为
\begin_inset Formula $k_{t}^{2}$
\end_inset

是待求解的未知量。
\begin_inset Formula 
\begin{equation}
K_{ij}^{e}=A_{ij}^{e}-k_{i}^{2}\,B_{ij}^{e}\label{eq:7.16}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{align}
A_{ij}^{e} & =\iint_{\Omega^{e}}\left(\partial_{x}N_{\alpha}^{e}\,\partial_{x}N_{\beta}^{e}+\partial_{y}N_{\alpha}^{e}\,\partial_{y}N_{\beta}^{e}\right)\dd{\Omega}\label{eq:7.17}\\
B_{ij}^{e} & =\iint_{\Omega^{e}}N_{\alpha}^{e}N_{\beta}^{e}\dd{\Omega}\label{eq:7.18}
\end{align}

\end_inset


\begin_inset Formula 
\begin{equation}
[A]\,\{\Phi\}=k_{i}^{2}\,[B]\,\{\Phi\}\label{eq:7.19}
\end{equation}

\end_inset


\begin_inset Formula $k_{z}^{2}=\omega^{2}\mu\varepsilon-k_{t}^{2}$
\end_inset

可以得到传播常数
\begin_inset Formula $k_{z}$
\end_inset

。
\end_layout

\begin_layout Subsection
非均匀波导
\end_layout

\begin_layout Standard
从方程
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.20"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.21"
plural "false"
caps "false"
noprefix "false"

\end_inset

出发
\begin_inset Formula 
\[
\nabla\times\left(\frac{1}{\mu_{r}}\nabla\times\sbf E\right)-\omega^{2}\varepsilon_{r}\sbf E=-j\omega\sbf J
\]

\end_inset


\begin_inset Formula 
\[
\nabla\times\left(\frac{1}{\varepsilon_{r}}\nabla\times\sbf H\right)-\omega^{2}\mu_{r}\sbf H=\nabla\times(\frac{1}{\varepsilon_{r}}\sbf J)
\]

\end_inset

写出
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:1.20"
plural "false"
caps "false"
noprefix "false"

\end_inset

的
\begin_inset Formula $z$
\end_inset

分量方程：
\begin_inset Formula 
\[
-\partial_{x}\left(\frac{1}{\mu}\partial_{x}E_{z}\right)-\partial_{y}\left(\frac{1}{\mu}\partial_{y}E_{z}\right)-j\,k_{z}\,\partial_{x}\left(\frac{1}{\mu}E_{x}\right)-j\,k_{z}\partial_{y}\left(\frac{1}{\mu}E_{y}\right)-\omega^{2}\varepsilon E_{z}=0
\]

\end_inset

从
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:7.5"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:7.7"
plural "false"
caps "false"
noprefix "false"

\end_inset

，将变量都换成
\begin_inset Formula $E_{z}$
\end_inset

，
\begin_inset Formula $H_{z}$
\end_inset

，得到
\begin_inset Formula 
\begin{align}
-\partial_{x}\left(\frac{\varepsilon}{k_{t}^{2}}\partial_{x}E_{z}\right) & -\partial_{y}\left(\frac{\varepsilon}{k_{t}^{2}}\partial_{y}E_{z}\right)\nonumber \\
 & -\frac{k_{z}}{\omega}\left[\partial_{x}\left(\frac{1}{k_{t}^{2}}\partial_{y}H_{z}\right)-\partial_{y}\left(\frac{1}{k_{t}^{2}}\partial_{x}H_{z}\right)\right]-\varepsilon E_{z}=0\label{eq:7.23}
\end{align}

\end_inset

以及对偶方程
\begin_inset Formula 
\begin{align}
-\partial_{x}\left(\frac{\mu}{k_{t}^{2}}\partial_{x}H_{z}\right) & -\partial_{y}\left(\frac{\mu}{k_{t}^{2}}\partial_{y}H_{z}\right)\nonumber \\
 & -\frac{k_{z}}{\omega}\left[\partial_{x}\left(\frac{1}{k_{t}^{2}}\partial_{y}E_{z}\right)-\partial_{y}\left(\frac{1}{k_{t}^{2}}\partial_{x}E_{z}\right)\right]-\mu H_{z}=0\label{eq:7.24}
\end{align}

\end_inset

以上
\begin_inset Formula $k_{t}^{2}=\omega^{2}\mu\varepsilon-k_{z}^{2}$
\end_inset

。
\end_layout

\begin_layout Standard
因此问题变成求解在边界条件
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:7.11"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:7.12"
plural "false"
caps "false"
noprefix "false"

\end_inset

式下的微分方程
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:7.23"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:7.24"
plural "false"
caps "false"
noprefix "false"

\end_inset

式。如果
\begin_inset Formula $k_{t}$
\end_inset

不随位置变化，则
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:7.23"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:7.24"
plural "false"
caps "false"
noprefix "false"

\end_inset

中的耦合项为零，因此 
\begin_inset Formula $E_{z}$
\end_inset

 和 
\begin_inset Formula $H_{z}$
\end_inset

 场耦合的原因是材料属性随空间变化。
\end_layout

\begin_layout Chapter
矢量有限元
\end_layout

\begin_layout Section
二维棱边元
\end_layout

\begin_layout Subsection
矩阵单元
\end_layout

\begin_layout Standard
矩阵单元虽然最简单，可以清晰地看到 矢量单元 和 矢量基函数 的特点。
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename inset-fem-JinJianMing/f8.1.png
	lyxscale 28
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
图8.1矩阵棱边单元
\begin_inset CommandInset label
LatexCommand label
name "fig:8.1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset

考虑
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:8.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

所示的矩阵单元，它在 
\begin_inset Formula $x$
\end_inset

 方向 和 
\begin_inset Formula $y$
\end_inset

 方向的边长分别是 
\begin_inset Formula $\ell_{x}^{e}$
\end_inset

 和 
\begin_inset Formula $\ell_{y}^{e}$
\end_inset

，它的中心在 
\begin_inset Formula $(x_{c}^{e},y_{c}^{e})$
\end_inset

。如果单元每边被赋予一个不变的切向场分量，那么，该单元中的场可展开为：
\begin_inset Formula 
\begin{align}
 & E_{x}^{e}=\frac{1}{\ell_{y}^{e}}\left[\left(\frac{\ell_{y}^{e}}{2}+{\color{blue}y_{c}^{e}-y}\right)E_{x1}^{e}+\left(\frac{\ell_{y}^{e}}{2}+{\color{blue}y-y_{c}^{e}}\right)\right]E_{x2}^{e}\label{eq:8.1}\\
 & E_{y}^{e}=\frac{1}{\ell_{x}^{e}}\left[\left(\frac{\ell_{x}^{e}}{2}+x_{c}^{e}-x\right)E_{x1}^{e}+\left(\frac{\ell_{x}^{e}}{2}+x-x_{c}^{e}\right)\right]E_{y2}^{e}\label{eq:8.2}
\end{align}

\end_inset

从表达式可以看出，
\begin_inset Formula $E_{x1}^{e}$
\end_inset

表示沿棱边 
\begin_inset Formula $(1,2)$
\end_inset

 的
\begin_inset Formula $E_{x}$
\end_inset

分量，类似地，
\begin_inset Formula $E_{x2}^{e}$
\end_inset

是沿棱边
\begin_inset Formula $(4,3)$
\end_inset

的
\begin_inset Formula $E_{x}$
\end_inset

分量。 
\end_layout

\begin_layout Standard
按照
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:8.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

中定义的棱边编号（
\begin_inset Formula $1,2,3,4$
\end_inset

），则 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 和 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.2"
plural "false"
caps "false"
noprefix "false"

\end_inset

可以写成：
\begin_inset Formula 
\begin{equation}
\sbf E^{e}=\sum_{i=1}^{4}\sbf N_{i}^{e}E_{i}^{e}\label{eq:8.3}
\end{equation}

\end_inset

其中 
\begin_inset Formula $E_{i}^{e}$
\end_inset

表示沿第
\begin_inset Formula $i$
\end_inset

 个棱边的切向场，
\begin_inset Formula $N_{i}^{e}$
\end_inset

是矢量插值函数或基函数，它们由下列式子给出：
\begin_inset Formula 
\begin{align}
 & N_{1}^{e}=\frac{1}{\ell_{y}^{e}}\left(\frac{\ell_{y}^{e}}{2}+{\color{blue}y_{c}^{e}-y}\right)\hat{\sbf x}\label{eq:8.4}\\
 & N_{2}^{e}=\frac{1}{\ell_{y}^{e}}\left(\frac{\ell_{y}^{e}}{2}+{\color{blue}y-y_{c}^{e}}\right)\hat{\sbf x}\label{eq:8.5}\\
 & N_{3}^{e}=\frac{1}{\ell_{x}^{e}}\left(\frac{\ell_{x}^{e}}{2}+{\color{blue}x_{c}^{e}-x}\right)\hat{\sbf y}\label{eq:8.6}\\
 & N_{4}^{e}=\frac{1}{\ell_{x}^{e}}\left(\frac{\ell_{x}^{e}}{2}+{\color{blue}x-x_{c}^{e}}\right)\hat{\sbf y}\label{eq:8.7}
\end{align}

\end_inset

Note：
\end_layout

\begin_layout Enumerate
磁矢势展开 
\begin_inset Formula $\sbf A=\sum_{\alpha}\sbf N_{\alpha}^{e}\,A_{i}^{e}$
\end_inset

 的实际自由度是 
\begin_inset Formula $\sbf A$
\end_inset

 在棱边上的积分。
\begin_inset Formula 
\[
\alpha_{i}(v)=\int_{a_{i}}\left(v\cdot t_{i}\right)\dd{s},\quad t_{i}\text{ is 切矢量}
\]

\end_inset


\end_layout

\begin_layout Enumerate
只要插值展开写成
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.3"
plural "false"
caps "false"
noprefix "false"

\end_inset

的形式；对于 share 公共边的两个单元，公共边上会有两套展开；为了保持棱边上切向场的连续性，则必然有 
\series bold

\begin_inset Formula $\sbf N_{i}^{e}$
\end_inset

 只在第 
\begin_inset Formula $i$
\end_inset

 边上有切向分量，而在其它所有边上没有切向分量
\series default
（离散正交性）。
\begin_inset Formula 
\[
\sbf N_{i}^{e}(e_{j})=\delta_{ij}
\]

\end_inset


\end_layout

\begin_layout Enumerate
这些函数的另一个特殊性质是，每个函数在单元范围内满足散度条件 
\begin_inset Formula $\nabla\cdot\sbf N_{i}^{e}=0$
\end_inset

。因此在
\series bold
无源区域
\series default
中，用它们来表达矢量场是理想的。
\end_layout

\begin_layout Enumerate
而且这些函数的旋度可以很容易找到：
\begin_inset Formula 
\begin{align*}
 & \nabla\times\sbf N_{1}^{e}=\frac{1}{\ell_{y}^{e}}\hat{\sbf z},\quad\nabla\times\sbf N_{2}^{e}=\frac{-1}{\ell_{y}^{e}}\hat{\sbf z}\\
 & \nabla\times\sbf N_{3}^{e}=-\frac{1}{\ell_{x}^{e}}\hat{\sbf z},\quad\nabla\times\sbf N_{4}^{e}=\frac{1}{\ell_{x}^{e}}\hat{\sbf z}
\end{align*}

\end_inset

它们显然是非零常数。
\end_layout

\begin_layout Remark
\begin_inset Argument 1
status open

\begin_layout Plain Layout
屋顶基函数
\end_layout

\end_inset

 顺便指出，以上矢量基函数，是为了建立场表达式中切向量的连续性而提出的。用 
\begin_inset Formula $\hat{\sbf z}$
\end_inset

叉乘这些函数，我们得到另一组适量函数 
\begin_inset Formula $\hat{\sbf z}\times\sbf N_{i}^{e}$
\end_inset

，它们保证了法向连续性。与 
\begin_inset Formula $\sbf N_{i}^{e}$
\end_inset

 相比，函数 
\begin_inset Formula $\hat{\sbf z}\times\sbf N_{i}^{e}$
\end_inset

 有零旋度和非零散度，因而用来表达
\series bold
面电流密度
\series default
是理想的。在电磁学中，这些函数被称为
\series bold
屋顶基函数
\series default
，被并广泛应用于积分方程的
\series bold
矩量法
\series default
求解中。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Remark
电流满足连续性方程 
\begin_inset Formula $\nabla\cdot\sbf J=-\frac{\partial\rho}{\partial t}$
\end_inset

，对于稳恒电流即 
\begin_inset Formula $\nabla\cdot\sbf J=0$
\end_inset

，在界面上对应
\begin_inset Formula 
\[
\sbf n\cdot\sbf J=0,\quad\Rightarrow\quad\sbf n_{1}\cdot\sbf J_{1}-\sbf n_{1}\cdot\sbf J_{1}=0
\]

\end_inset

上式考虑了界面两侧的法线 
\begin_inset Formula $\sbf n_{2}=-\sbf n_{1}$
\end_inset

。上述条件即要求在无电荷累积的界面上，电流的法向分量连续。
\end_layout

\begin_layout Subsection
三角形单元
\end_layout

\begin_layout Standard
如前所述，矩阵单元适用于有限类的几何结构。当处理不规则集合形状的问题时，有必要使用
\series bold
三角形单元
\series default
。
\end_layout

\begin_layout Standard
三角形单元的 矢量基函数 可以从 
\series bold
必要特性
\series default
导出。首先考虑 
\begin_inset CommandInset ref
LatexCommand eqref
reference "chap:4"
plural "false"
caps "false"
noprefix "false"

\end_inset

 讨论的单元面积坐标 
\begin_inset Formula $(L_{1}^{e},L_{2}^{e},L_{3}^{e})$
\end_inset

，它们是单元的
\series bold
线性插值函数
\series default
。
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename inset-fem-JinJianMing/f8.2.png
	lyxscale 70
	scale 60

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
三角形棱边单元
\begin_inset CommandInset label
LatexCommand label
name "fig:8.2"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

考虑下列矢量函数
\begin_inset Formula 
\begin{equation}
\sbf W_{12}=L_{1}^{e}\nabla L_{2}^{e}-L_{2}^{e}\nabla L_{1}^{e}.\label{eq:8.8}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate

\series bold
散度
\series default

\begin_inset Formula $\nabla\cdot\sbf W_{12}^{e}=0$
\end_inset

，它不依赖于
\begin_inset Formula $L_{i_{1}}^{e}$
\end_inset

和 
\begin_inset Formula $L_{i_{2}}^{e}$
\end_inset

的具体表达式
\begin_inset Formula 
\begin{equation}
\nabla\cdot\sbf W_{12}=\nabla\cdot\left(L_{1}^{e}\nabla L_{2}^{e}\right)-\nabla\cdot\left(L_{2}^{e}\nabla L_{1}^{e}\right)=0\label{eq:8.9}
\end{equation}

\end_inset

上式使用了 
\begin_inset Formula $\nabla\cdot(\varphi\sbf f)=(\nabla\varphi)\cdot\sbf f+\varphi\nabla\cdot\sbf f$
\end_inset

。而
\series bold
旋度
\series default

\begin_inset Formula 
\[
\nabla\times\sbf W_{12}=\nabla\times\left(L_{1}^{e}\nabla L_{2}^{e}\right)-\nabla\times\left(L_{2}^{e}\nabla L_{1}^{e}\right)=2\nabla L_{1}^{e}\times\nabla L_{2}^{e}
\]

\end_inset

上式使用了 
\begin_inset Formula $\nabla\times(\varphi\sbf f)=(\nabla\varphi)\times\sbf f+\varphi\nabla\times\sbf f$
\end_inset

。
\end_layout

\begin_layout Enumerate
其次，设
\begin_inset Formula $\sbf e_{1}$
\end_inset

是从
\series bold
节点
\begin_inset Formula $1$
\end_inset

指向节点
\begin_inset Formula $2$
\end_inset

 
\series default
的单位矢量。因为
\begin_inset Formula $L_{1}^{e}$
\end_inset

是一个线性函数，从节点
\begin_inset Formula $1$
\end_inset

到节点
\begin_inset Formula $2$
\end_inset

，它的值从
\begin_inset Formula $1$
\end_inset

变化到
\begin_inset Formula $0$
\end_inset

；
\begin_inset Formula $L_{2}^{e}$
\end_inset

 类似，从 节点
\begin_inset Formula $2$
\end_inset

的
\begin_inset Formula $1$
\end_inset

变化到节点
\begin_inset Formula $1$
\end_inset

处的
\begin_inset Formula $0$
\end_inset

，所以我们有
\begin_inset Formula 
\begin{align}
 & \sbf e_{1}\cdot\nabla L_{1}^{e}=-\frac{1}{\ell_{1}^{e}},\quad\sbf e_{1}\cdot\nabla L_{2}^{e}=\frac{1}{\ell_{1}^{e}},\nonumber \\
\Rightarrow\quad & \sbf e_{1}\cdot\sbf W_{12}=\frac{L_{1}^{e}+L_{2}^{e}}{\ell_{1}^{e}}=\frac{1}{\ell_{1}^{e}}\label{eq:8.11}
\end{align}

\end_inset

这里
\begin_inset Formula $\ell_{1}^{e}$
\end_inset

 表示连接节点
\begin_inset Formula $1$
\end_inset

和节点
\begin_inset Formula $2$
\end_inset

的棱边的长度。换句话说，
\series bold

\begin_inset Formula $\sbf W_{12}$
\end_inset

沿棱边
\begin_inset Formula $(1,2)$
\end_inset

有一不变的切向分量
\series default
。
\end_layout

\begin_layout Enumerate
并且因为
\begin_inset Formula $L_{1}^{e}$
\end_inset

沿棱边
\begin_inset Formula $(2,3)$
\end_inset

为零，
\begin_inset Formula $L_{2}^{e}$
\end_inset

沿棱边
\begin_inset Formula $(1,3)$
\end_inset

为零，所以 
\series bold

\begin_inset Formula $\sbf W_{12}$
\end_inset

沿这两个棱边没有切向分量
\series default
。
\end_layout

\begin_layout Standard
因此，
\begin_inset Formula $\sbf W_{12}$
\end_inset

具有作为与棱边
\begin_inset Formula $(1,2)$
\end_inset

相联系的棱边场的矢量基函数所需的所有特性。如果我们定义棱边
\begin_inset Formula $(1,2)$
\end_inset

为棱边
\begin_inset Formula $1$
\end_inset

，则有
\begin_inset Formula 
\begin{equation}
\sbf N_{1}^{e}=\sbf W_{12}\ell_{1}^{e}=(L_{1}^{e}\nabla L_{2}^{e}-L_{2}^{e}\nabla L_{1}^{e})\ell_{1}^{e}\label{eq:8.12}
\end{equation}

\end_inset

这里 
\begin_inset Formula $\ell_{1}^{e}$
\end_inset

 用来使 
\begin_inset Formula $\sbf N_{1}^{e}$
\end_inset

 归一，并使 
\begin_inset Formula $\sbf N_{1}^{e}$
\end_inset

 无量纲。类似地，能构造棱边 
\begin_inset Formula $(2,3)$
\end_inset

 和 
\begin_inset Formula $(3,1)$
\end_inset

 的适当矢量基函数为：
\begin_inset Formula 
\begin{align}
 & \sbf N_{2}^{e}=\sbf W_{23}\ell_{2}^{e}=(L_{2}^{e}\nabla L_{3}^{e}-L_{3}^{e}\nabla L_{2}^{e})\ell_{2}^{e}\label{eq:8.13}\\
 & \sbf N_{3}^{e}=\sbf W_{31}\ell_{3}^{e}=(L_{3}^{e}\nabla L_{1}^{e}-L_{1}^{e}\nabla L_{3}^{e})\ell_{3}^{e}\label{eq:8.14}
\end{align}

\end_inset

因此，该单元内的矢量场可展开为
\begin_inset Formula 
\begin{equation}
\sbf E^{e}=\sum_{i=1}^{3}\sbf N_{i}^{e}E_{i}^{e}\label{eq:8.15}
\end{equation}

\end_inset

这里，
\begin_inset Formula $E_{i}^{e}$
\end_inset

 表示沿着第
\begin_inset Formula $i$
\end_inset

个棱边的切向场。
\begin_inset Formula $\sbf N_{1}^{e}$
\end_inset

同一写成
\begin_inset Formula 
\[
\sbf N_{i}^{e}=\left(L_{i_{1}}^{e}\nabla L_{i_{2}}^{e}-L_{i_{2}}^{e}\nabla L_{i_{1}}^{e}\right)\ell_{i}^{e}
\]

\end_inset

其中 
\begin_inset Formula $i_{1}$
\end_inset

与 
\begin_inset Formula $i_{2}$
\end_inset

 分别为棱边
\begin_inset Formula $i$
\end_inset

的
\series bold
两个顶点
\series default
。
\begin_inset Formula $\ell_{i}^{e}$
\end_inset

 的绝对值等于棱边的长度，为了保证基函数方向一致，可以加上额外的正负号，并由
\begin_inset Formula $i_{1},i_{2}$
\end_inset

节点的 节点全局编号顺序给出。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename inset-fem-JinJianMing/f8.3.png
	lyxscale 70
	scale 60

\end_inset


\begin_inset Graphics
	filename inset/xl-1.2.png
	scale 60

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
三角形单元的矢量基函数 
\begin_inset Formula $(a)N_{1}^{e}$
\end_inset

；
\begin_inset Formula $(b)N_{2}^{e}$
\end_inset

；
\begin_inset Formula $(c)N_{3}^{e}$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:8.3"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:8.3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 给出了典型单元中矢量基函数的图形表示。正如前文所述，矢量基函数仅在所相关的棱边上有一个切向分量。从图形中可以猜测，如果定义一个柱坐标系
\begin_inset Formula $(\rho,\varphi)$
\end_inset

 ，其坐标原点在点
\begin_inset Formula $3$
\end_inset

上，角坐标从
\begin_inset Formula $3$
\end_inset

–
\begin_inset Formula $1$
\end_inset

 开始逆时针增加，那么 
\begin_inset Formula $\sbf N_{1}^{e}$
\end_inset

 可表示为：
\begin_inset Formula 
\begin{equation}
\sbf N_{1}^{e}=\frac{\rho}{h_{3}^{e}}\hat{\sbf\varphi}.\label{eq:8.16}
\end{equation}

\end_inset

其中 
\begin_inset Formula $h_{3}^{e}$
\end_inset

 表示节点
\begin_inset Formula $3$
\end_inset

与棱
\begin_inset Formula $1$
\end_inset

–
\begin_inset Formula $2$
\end_inset

的铅锤距离（三角形的高），
\begin_inset Formula $\{\rho,\varphi\}$
\end_inset

是极坐标。其它两个函数满足类似的表达式，这个表达式可以通过坐标变换证明。
\end_layout

\begin_layout Standard
最后，与矩形单元类似，容易验证 
\begin_inset Formula $\hat{\sbf z}\times\sbf N_{i}^{e}$
\end_inset

 是满足 
\series bold
法向连续性
\series default
 的基函数，它们有 
\series bold
零旋度
\series default
 和 
\series bold
非零散度
\series default
。在上面定义的柱坐标系中，
\begin_inset Formula $\hat{\sbf z}\times\sbf N_{1}^{e}$
\end_inset

可以写为
\begin_inset Formula 
\begin{equation}
\hat{\sbf z}\times\sbf N_{1}^{e}=-\frac{\rho}{h_{3}^{e}}\hat{\sbf\rho}.\label{eq:8.17}
\end{equation}

\end_inset

在电磁学中，这些矢量基函数可以用来表示 任意形状导体 的表面电流。
\end_layout

\begin_layout Exercise
引用坐标变换证明 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.12"
plural "false"
caps "false"
noprefix "false"

\end_inset

 和 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.16"
plural "false"
caps "false"
noprefix "false"

\end_inset

 式等价。
\end_layout

\begin_layout Subsection
四边形单元
\end_layout

\begin_layout Standard
给定一个特定区域和单元棱边的最大长度，三角形单元比矩形单元多包含大约 
\begin_inset Formula $1/3$
\end_inset

 条边（也就是未知量）。这里引入四边形单元（quadrilateral），它可以看作变形的矩形。
\end_layout

\begin_layout Standard
首先引入一种坐标变换，它能把 
\begin_inset Formula $xy$
\end_inset

平面上的四边形单元变换成 
\begin_inset Formula $\xi\eta$
\end_inset

 平面内的正方形单元。只要在四边形的四个节点上满足下面的关系，即可很容易找到这种变换
\begin_inset Formula 
\begin{equation}
x=a+b\xi+c\eta+d\xi\eta,\quad y=a'+b'\eta+c'\eta+d'\xi\eta\label{eq:8.18}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename inset-fem-JinJianMing/f8.4.png
	lyxscale 70
	scale 60

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
图8.4(a)
\begin_inset Formula $xy$
\end_inset

平面内的四边形单元；(b)变换成
\begin_inset Formula $\xi\eta$
\end_inset

平面内的正方形单元
\begin_inset CommandInset label
LatexCommand label
name "fig:8.4"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
将四个顶点在两种坐标系下一一对应 
\begin_inset Formula $(\xi,\eta)\in[-1,1]$
\end_inset

，
\begin_inset Formula 
\begin{align*}
 & x_{1}=a-b-c+d,\quad y_{1}=a'-b'-c'+d',\\
 & x_{2}=a+b-c-d,\quad y_{1}=a'+b'-c'-d',\\
 & x_{3}=a+b+c+d,\quad y_{1}=a'+b'+c'+d',\\
 & x_{4}=a-b+c-d,\quad y_{1}=a'-b'+c'-d'.
\end{align*}

\end_inset

求解出待定系数，并把它们代入 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.18"
plural "false"
caps "false"
noprefix "false"

\end_inset

 得：
\begin_inset Formula 
\begin{equation}
x=\sum_{i=1}^{4}N_{i}^{e}(\xi,\eta)x_{i}^{e},\quad y=\sum_{i=1}^{4}N_{i}^{e}(\xi,\eta)y_{i}^{e},\label{eq:8.19}
\end{equation}

\end_inset

其中
\begin_inset Formula 
\begin{align*}
 & N_{1}^{e}=\frac{1}{4}\left(1-\xi\right)\left(1-\eta\right)\\
 & N_{2}^{e}=\frac{1}{4}\left(1+\xi\right)\left(1-\eta\right)\\
 & N_{3}^{e}=\frac{1}{4}\left(1+\xi\right)\left(1+\eta\right)\\
 & N_{4}^{e}=\frac{1}{4}\left(1-\xi\right)\left(1+\eta\right)
\end{align*}

\end_inset

也可以统一写成
\begin_inset Formula 
\[
N_{i}^{e}=\frac{1}{4}\left(1+\xi_{i}\xi\right)\left(1+\eta_{i}\xi\right)
\]

\end_inset

其中 
\begin_inset Formula $\left(\xi_{i},\eta_{i}\right)$
\end_inset

表示第
\begin_inset Formula $i$
\end_inset

个节点的坐标。从
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.19"
plural "false"
caps "false"
noprefix "false"

\end_inset

式也可以反过来，把 
\begin_inset Formula $\xi,\eta$
\end_inset

 表示成 
\begin_inset Formula $x,y$
\end_inset

 的函数，然而并不需要，因为直接用 
\begin_inset Formula $\xi,\eta$
\end_inset

 来表示基函数并执行所需的数值积分是很简单的。
\end_layout

\begin_layout Standard
现在按 
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:8.4"
plural "false"
caps "false"
noprefix "false"

\end_inset

 约定棱边的编号。在棱边
\begin_inset Formula $1$
\end_inset

上，
\begin_inset Formula $\eta=-1$
\end_inset

，代入 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.19"
plural "false"
caps "false"
noprefix "false"

\end_inset

得到局域关系：
\begin_inset Formula 
\begin{equation}
x=\frac{1}{2}\left(1-\xi\right)x_{1}^{e}+\frac{1}{2}\left(1+\xi\right)x_{2}^{e}\label{eq:8.20}
\end{equation}

\end_inset

解出 
\begin_inset Formula $\xi$
\end_inset

 得到：
\begin_inset Formula 
\begin{equation}
\xi=\frac{2x-x_{1}^{e}-x_{2}^{e}}{x_{2}^{e}-x_{1}^{e}}\label{eq:8.21}
\end{equation}

\end_inset

假设 
\begin_inset Formula $s$
\end_inset

 为 边
\begin_inset Formula $1$
\end_inset

–
\begin_inset Formula $2$
\end_inset

 的归一化距离，那么 
\begin_inset Formula $x=(1-s)x_{1}^{e}+sx_{2}^{e}$
\end_inset

。当它被带入到 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.21"
plural "false"
caps "false"
noprefix "false"

\end_inset

式时，有
\begin_inset Formula 
\[
\xi=2s-1
\]

\end_inset

它表示
\begin_inset Formula $\xi$
\end_inset

沿棱边
\begin_inset Formula $1$
\end_inset

线性变化。类似地可以证明
\begin_inset Formula $\xi$
\end_inset

沿棱边
\begin_inset Formula $2$
\end_inset

也线性变化。因为在棱边
\begin_inset Formula $3,4$
\end_inset

 上 
\begin_inset Formula $\xi$
\end_inset

 是常数，因此求 
\begin_inset Formula $\nabla\xi$
\end_inset

 得到的矢量函数，在棱边 
\begin_inset Formula $1,2$
\end_inset

 上给出常数切向分量，在棱边 
\begin_inset Formula $3,4$
\end_inset

 上给出
\begin_inset Formula $0$
\end_inset

。因此可以建立棱边
\begin_inset Formula $1$
\end_inset

的矢量基函数为：
\begin_inset Formula 
\begin{equation}
\sbf N_{1}^{e}=\frac{\ell_{1}^{e}}{4}\left(1-\eta\right)\nabla\xi\label{eq:8.22}
\end{equation}

\end_inset

棱边
\begin_inset Formula $2$
\end_inset

的矢量基函数为
\begin_inset Formula 
\begin{equation}
\sbf N_{2}^{e}=\frac{\ell_{2}^{e}}{4}\left(1+\eta\right)\nabla\xi\label{eq:8.23}
\end{equation}

\end_inset

其中
\begin_inset Formula $\ell_{i}^{e}$
\end_inset

表示棱边
\begin_inset Formula $i$
\end_inset

的长度。显然，这样建立的基函数满足矢量基的基本特性，即沿相关棱边有常切向分量，而沿其他棱边则无切向分量。类似地，我们可以建立沿棱边
\begin_inset Formula $3$
\end_inset

的矢量基函数为
\begin_inset Formula 
\begin{equation}
\sbf N_{3}^{e}=\frac{\ell_{3}^{e}}{4}\left(1-\xi\right)\nabla\eta\label{eq:8.24}
\end{equation}

\end_inset

以及棱边
\begin_inset Formula $4$
\end_inset

的矢量基函数为
\begin_inset Formula 
\begin{equation}
\sbf N_{4}^{e}=\frac{\ell_{4}^{e}}{4}\left(1+\xi\right)\nabla\eta\label{eq:8.25}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
上面建立的矢量基函数用图
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:8.5"
plural "false"
caps "false"
noprefix "false"

\end_inset

表示，以说明它们的基本特性。四边形单元的矢量基函数的主要缺点是：
\end_layout

\begin_layout Enumerate
首先四边形单元通常
\series bold
没有简单的解析解
\series default
，而其他两种单元则有，因此总需要
\series bold
数值积分
\series default
。
\end_layout

\begin_layout Enumerate
其次不同于三角形单元和矩阵单元，四边形单元的矢量基函数
\series bold
不是无散的，
\series default

\begin_inset Formula $\nabla\cdot\sbf N_{\alpha}\neq0$
\end_inset

。
\end_layout

\begin_layout Standard
不过四边形单元基函数同样具有建立场表达式所需的
\series bold
切向连续性
\series default
。所以在大多数应用中，和前面两种单元同样有用。
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename inset-fem-JinJianMing/f8.5a.png
	lyxscale 70
	scale 60

\end_inset


\begin_inset Graphics
	filename inset-fem-JinJianMing/f8.5b.png
	lyxscale 70
	scale 60

\end_inset

p
\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
四边形单元的矢量基函数（这里仅给出 a:
\begin_inset Formula $\sbf N_{1}^{e}$
\end_inset

和 b:
\begin_inset Formula $\sbf N_{4}^{e}$
\end_inset

，因为其它两个基函数有相似的特性）
\begin_inset CommandInset label
LatexCommand label
name "fig:8.5"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
单元矩阵的计算
\end_layout

\begin_layout Standard
上面建立的矢量基函数，可以用于表示 矢量波动方程 中的矢量场或势，这是需要考虑与之相关的单元矩阵的计算。从矢量波动方程离散而产生的典型单元矩阵包含下面两种形式的
积分：
\begin_inset Formula 
\begin{align}
 & E_{ij}^{e}=\iint_{\Omega^{e}}\left(\nabla\times\sbf N_{i}^{e}\right)\cdot\left(\nabla\times\sbf N_{j}^{e}\right)\dd{\Omega}\label{eq:8.26}\\
 & F_{ij}^{e}=\iint_{\Omega^{e}}\sbf N_{i}^{e}\cdot\sbf N_{j}^{e}\dd{\Omega}\label{eq:8.27}
\end{align}

\end_inset

对矩形单元和三角形单元，这两个积分可以解析计算。但对四边形单元，必须对它们进行数值计算 。因为其形状不规则，在
\begin_inset Formula $xy$
\end_inset

 平面直接进行积分是困难的。为了避免这个困难，我们在
\begin_inset Formula $\xi\eta$
\end_inset

平面上进行积分，在 
\begin_inset Formula $\xi\eta$
\end_inset

平面上，该单元是正方形。为此，首先要把面元 
\begin_inset Formula $\dd{\Omega}$
\end_inset

 表示为 
\begin_inset Formula $\dd{\xi}\dd{\eta}$
\end_inset

：
\begin_inset Formula 
\[
\dd{\Omega}=\dd{x}\dd{y}=\det[J]\dd{\xi}\dd{\xi}
\]

\end_inset

其中 
\begin_inset Formula $\det[J]$
\end_inset

 是如下定义的行列式
\begin_inset Formula 
\[
[J]=\left[\begin{array}{cc}
\frac{\partial x}{\partial\xi} & \frac{\partial y}{\partial\xi}\\
\frac{\partial x}{\partial\eta} & \frac{\partial y}{\partial\eta}
\end{array}\right].
\]

\end_inset

因此，
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.26"
plural "false"
caps "false"
noprefix "false"

\end_inset

 和 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.27"
plural "false"
caps "false"
noprefix "false"

\end_inset

 两式可写成：
\begin_inset Formula 
\begin{align}
 & E_{ij}^{e}=c\left(\nabla\times\sbf N_{i}^{e}\right)\cdot\left(\nabla\times\sbf N_{j}^{e}\right)\,\det[J]\dd{\xi}\dd{\xi}\label{eq:8.28}\\
 & F_{ij}^{e}=\int_{-1}^{1}\int_{-1}^{1}\sbf N_{i}^{e}\cdot\sbf N_{j}^{e}\,\det[J]\dd{\xi}\dd{\xi}\label{eq:8.29}
\end{align}

\end_inset

其次，也需要把被积函数用 
\begin_inset Formula $\xi$
\end_inset

 和 
\begin_inset Formula $\eta$
\end_inset

 表示。因为
\begin_inset Formula 
\[
\nabla\times\sbf N_{i}=\frac{\ell_{i}^{e}}{4}\begin{cases}
\nabla\xi\times\nabla\eta & i=1,3\\
\nabla\eta\times\nabla\xi & i=2,4
\end{cases}
\]

\end_inset

其中 
\begin_inset Formula $\nabla$
\end_inset

 表示对
\begin_inset Formula $x,y$
\end_inset

 求梯度，则我们需要把 
\begin_inset Formula $\nabla\xi,\nabla\eta$
\end_inset

 表示成 
\begin_inset Formula $\xi$
\end_inset

 和 
\begin_inset Formula $\eta$
\end_inset

 的形式。为此考虑任意函数
\begin_inset Formula $f$
\end_inset

，
\begin_inset Formula 
\[
\left[\begin{array}{c}
\frac{\partial f}{\partial\xi}\\
\frac{\partial f}{\partial\eta}
\end{array}\right]=\left[\begin{array}{cc}
\frac{\partial x}{\partial\xi} & \frac{\partial y}{\partial\xi}\\
\frac{\partial x}{\partial\eta} & \frac{\partial y}{\partial\eta}
\end{array}\right]\left[\begin{array}{c}
\frac{\partial f}{\partial x}\\
\frac{\partial f}{\partial y}
\end{array}\right].
\]

\end_inset

逆变换
\begin_inset Formula 
\[
\left[\begin{array}{c}
\frac{\partial f}{\partial x}\\
\frac{\partial f}{\partial y}
\end{array}\right]=\frac{1}{\det[J]}\left[\begin{array}{cc}
\frac{\partial y}{\partial\eta} & -\frac{\partial y}{\partial\xi}\\
-\frac{\partial x}{\partial\eta} & \frac{\partial x}{\partial\xi}
\end{array}\right]\left[\begin{array}{c}
\frac{\partial f}{\partial\xi}\\
\frac{\partial f}{\partial\eta}
\end{array}\right].
\]

\end_inset

由此得到
\begin_inset Formula 
\[
\left[\begin{array}{cc}
\nabla\xi & \nabla\eta\end{array}\right]=\frac{1}{\det[J]}\left[\begin{array}{cc}
\frac{\partial y}{\partial\eta} & -\frac{\partial y}{\partial\xi}\\
-\frac{\partial x}{\partial\eta} & \frac{\partial x}{\partial\xi}
\end{array}\right]
\]

\end_inset

使用此式，以及
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.19"
plural "false"
caps "false"
noprefix "false"

\end_inset

 
\begin_inset Formula $x=\sum_{i=1}^{4}N_{i}^{e}(\xi,\eta)x_{i}^{e},\quad y=\sum_{i=1}^{4}N_{i}^{e}(\xi,\eta)y_{i}^{e}$
\end_inset

，可以将 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.28"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.29"
plural "false"
caps "false"
noprefix "false"

\end_inset

中的被积函数完全用 
\begin_inset Formula $\xi,\eta$
\end_inset

 表示。因此，通过应用下式给出的二维高斯积分公式
\begin_inset Formula 
\[
\int_{-1}^{1}\int_{-1}^{1}f\left(\xi,\eta\right)\dd{\xi}\dd{\xi}=\sum_{i=1}^{n_{1}}\sum_{j=1}^{n_{2}}W_{i}W_{j}f(\xi_{i},\eta_{i})
\]

\end_inset

可以数值求解出 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.28"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.29"
plural "false"
caps "false"
noprefix "false"

\end_inset

中的积分。上式中 
\begin_inset Formula $W_{i}$
\end_inset

 和
\begin_inset Formula $W_{j}$
\end_inset

是权重因子，
\begin_inset Formula $\xi_{i}$
\end_inset

 和 
\begin_inset Formula $\eta_{i}$
\end_inset

 表示高斯积分点，这些数据见表格3.1。其中 
\begin_inset Formula $n_{1}$
\end_inset

表示沿 
\begin_inset Formula $\xi$
\end_inset

 的积分点数，
\begin_inset Formula $n_{2}$
\end_inset

表示沿 
\begin_inset Formula $\eta$
\end_inset

 轴的积分点数。如果北极函数的多项式次数 
\begin_inset Formula $\le3$
\end_inset

，选择 
\begin_inset Formula $n_{1}=n_{2}=2$
\end_inset

 就够了。
\end_layout

\begin_layout Remark
对于
\begin_inset Formula $2\times2$
\end_inset

矩阵，
\begin_inset Formula $A^{-1}=I^{\prime}T^{\prime}A/\det[A]$
\end_inset

，
\begin_inset Formula $I'$
\end_inset

 表示副对角线相反数，
\begin_inset Formula $T^{\prime}$
\end_inset

表示副对角线转置。
\begin_inset Formula 
\[
M=\left[\begin{array}{cc}
a & b\\
c & d
\end{array}\right]\quad\Rightarrow\quad\frac{1}{\det[M]}\left[\begin{array}{cc}
d & -b\\
-c & a
\end{array}\right]
\]

\end_inset


\end_layout

\begin_layout Section
波导问题的再讨论
\end_layout

\begin_layout Section
三维棱边元
\end_layout

\begin_layout Standard
二维公式可直接推广到三维情形。
\end_layout

\begin_layout Subsection
矩阵块单元 rectangular brick
\end_layout

\begin_layout Standard
考虑图
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:8.7"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示的矩阵块单元，它的边长分别为 
\begin_inset Formula $\ell_{x}^{e}$
\end_inset

、
\begin_inset Formula $\ell_{y}^{e}$
\end_inset

、
\begin_inset Formula $\ell_{z}^{e}$
\end_inset

，其中心位于 
\begin_inset Formula $(x_{c}^{e},y_{c}^{e},z_{c}^{e})$
\end_inset

。类似于二维情形，通过分配常切向量场给单元的每条边，单元内场分量可表示为
\begin_inset Formula 
\begin{equation}
E_{x}^{e}=\sum_{i=1}^{4}N_{x,i}^{e}E_{x,i}^{e},\quad E_{y}^{e}=\sum_{i=1}^{4}N_{y,i}^{e}E_{y,i}^{e},\quad E_{z}^{e}=\sum_{i=1}^{4}N_{z,i}^{e}E_{z,i}^{e}.\label{eq:8.50}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename inset/Jinjm-8.7.pdf
	lyxscale 90
	scale 50

\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
delta = 0.05; Graphics3D[{ Arrowheads[{{.02, 0.65}}], (*vertex 1*) Arrow[{{-1,
 -1, -1}, {-1, 1, -1}}], Arrow[{{-1, -1, -1}, {1, -1, -1}}], Arrow[{{-1,
 -1, -1}, {-1, -1, 1}}], (*vertex 2*) Arrow[{{1, -1, -1}, {1, -1, 1}}],
 Arrow[{{1, -1, -1}, {1, 1, -1}}], (*vertex 4,8*) Arrow[{{-1, 1, -1}, {-1,
 1, 1}}], Arrow[{{-1, 1, -1}, {1, 1, -1}}], Arrow[{{-1, 1, 1}, {1, 1, 1}}],
 (*vertex 3,7*) Arrow[{{1, 1, -1}, {1, 1, 1}}], (*vertex 5*) Arrow[{{-1,
 -1, 1}, {-1, 1, 1}}], Arrow[{{-1, -1, 1}, {1, -1, 1}}], (*vertex 6*) Arrow[{{1,
 -1, 1}, {1, -1, 1}}], Arrow[{{1, -1, 1}, {1, 1, 1}}], (*Axes Label*) Arrowheads
[.02], Arrow[{{1.8, 0, -1}, {2.3, 0, -1}}], Text["x", {2.3 + 2 delta, 0, -1}],
 Arrow[{{1.8, 0, -1}, {1.8, 0.5, -1}}], Text["y", {1.8, 0.5 + 2 delta, -1}],
 Arrow[{{1.8, 0, -1}, {1.8, 0, -0.5}}], Text["z", {1.8, 0, -0.5 + 2 delta}],
 (*Labe for Vertex and edges*) FontSize -> 13, Text[1, {-1 - 3 delta, -1
 - 3 delta, -1 - 3 delta}], Text[2, {1 + 3 delta, -1 - 3 delta, -1 - 3 delta}],
 Text["3", {1 + delta, 1 + 3 delta, -1 - 3 delta}], Text[4, {-1 - 3 delta,
 1 + 3 delta, -1 - 3 delta}], Text[5, {-1 - 3 delta, -1 - 3 delta, 1 + 3
 delta}], Text["6", {1 + 3 delta, -1 - 3 delta, 1 + 3 delta}], Text[7, {1
 + 3 delta, 1 + 3 delta, 1 + 3 delta}], Text[8, {-1 - 3 delta, 1 + 3 delta,
 1 + 3 delta}] , {Red, , Text["(1)", {0, -1, -1}], Text["(2)", {0, 1, -1}]
 , Text["(3)", {0, -1, 1}], Text["(4)", {0, 1, 1}] , Text["(5)", {-1, 0,
 -1}], Text["(6)", {-1, 0, 1}] , Text["(7)", {1, 0, -1}], Text["(8)", {1,
 0 , 1}] , Text["(9)", {-1, -1, 0}], Text["(10)", {1, -1, 0}] , Text["(11)",
 {-1, 1, 0}], Text["(12)", {1, 1, 0}]} } , PlotRangePadding -> {Scaled[.1],
 Scaled[.1], Scaled[.1]}, ImageSize -> Medium, Boxed -> False ]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
矩形块单元
\begin_inset CommandInset label
LatexCommand label
name "fig:8.7"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
其中 
\begin_inset Formula $x$
\end_inset

 方向形函数
\begin_inset Formula 
\begin{align*}
 & N_{x1}^{e}=\frac{1}{\ell_{y}^{e}\ell_{x}^{e}}\left(\frac{\ell_{y}^{e}}{2}+y_{c}^{e}-y\right)\left(\frac{\ell_{z}^{e}}{2}+z_{c}^{e}-z\right),\quad N_{x3}^{e}=\frac{1}{\ell_{y}^{e}\ell_{x}^{e}}\left(\frac{\ell_{y}^{e}}{2}+y_{c}^{e}-y\right)\left(\frac{\ell_{z}^{e}}{2}+z-z_{c}^{e}\right),\\
 & N_{x2}^{e}=\frac{1}{\ell_{y}^{e}\ell_{z}^{e}}\left(\frac{\ell_{y}^{e}}{2}+y-y_{c}^{e}\right)\left(\frac{\ell_{z}^{e}}{2}+z_{c}^{e}-z\right),\quad N_{x4}^{e}=\frac{1}{\ell_{y}^{e}\ell_{x}^{e}}\left(\frac{\ell_{y}^{e}}{2}+y-y_{c}^{e}\right)\left(\frac{\ell_{z}^{e}}{2}+z-z_{c}^{e}\right),
\end{align*}

\end_inset


\begin_inset Formula $y$
\end_inset

 方向形函数
\begin_inset Formula 
\begin{align*}
 & N_{y1}^{e}=\frac{1}{\ell_{z}^{e}\ell_{x}^{e}}\left(\frac{\ell_{z}^{e}}{2}+z_{c}^{e}-z\right)\left(\frac{\ell_{x}^{e}}{2}+x_{c}^{e}-x\right),\quad N_{y3}^{e}=\frac{1}{\ell_{z}^{e}\ell_{x}^{e}}\left(\frac{\ell_{z}^{e}}{2}+z_{c}^{e}-z\right)\left(\frac{\ell_{x}^{e}}{2}+x-x_{c}^{e}\right),\\
 & N_{y2}^{e}=\frac{1}{\ell_{z}^{e}\ell_{x}^{e}}\left(\frac{\ell_{z}^{e}}{2}+z-z_{c}^{e}\right)\left(\frac{\ell_{x}^{e}}{2}+x_{c}^{e}-x\right),\quad N_{y4}^{e}=\frac{1}{\ell_{z}^{e}\ell_{x}^{e}}\left(\frac{\ell_{z}^{e}}{2}+z-z_{c}^{e}\right)\left(\frac{\ell_{x}^{e}}{2}+x-x_{c}^{e}\right),
\end{align*}

\end_inset


\begin_inset Formula $z$
\end_inset

 方向形函数
\begin_inset Formula 
\begin{align*}
 & N_{z1}^{e}=\frac{1}{\ell_{x}^{e}\ell_{y}^{e}}\left(\frac{\ell_{x}^{e}}{2}+x_{c}^{e}-x\right)\left(\frac{\ell_{y}^{e}}{2}+y_{c}^{e}-y\right),\quad N_{z3}^{e}=\frac{1}{\ell_{x}^{e}\ell_{y}^{e}}\left(\frac{\ell_{x}^{e}}{2}+x_{c}^{e}-x\right)\left(\frac{\ell_{y}^{e}}{2}+y-y_{c}^{e}\right),\\
 & N_{z2}^{e}=\frac{1}{\ell_{x}^{e}\ell_{y}^{e}}\left(\frac{\ell_{x}^{e}}{2}+x-x_{c}^{e}\right)\left(\frac{\ell_{y}^{e}}{2}+y_{c}^{e}-y\right),\quad N_{z4}^{e}=\frac{1}{\ell_{x}^{e}\ell_{y}^{e}}\left(\frac{\ell_{x}^{e}}{2}+x-x_{c}^{e}\right)\left(\frac{\ell_{y}^{e}}{2}+y-y_{c}^{e}\right),
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
如果用
\begin_inset CommandInset ref
LatexCommand eqref
reference "tab:8.1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 定义棱边编号，那么展开式
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.50"
plural "false"
caps "false"
noprefix "false"

\end_inset

 可用是矢量记号写成
\begin_inset Formula 
\begin{equation}
\sbf E^{e}=\sum_{i=1}^{12}N_{i}^{e}\sbf E_{i}^{e}\label{eq:8.51}
\end{equation}

\end_inset

其中，令 
\begin_inset Formula $j=1,2,3,4$
\end_inset

时
\begin_inset Formula 
\begin{equation}
\sbf N_{j}^{e}=N_{x,j}^{e}\hat{\sbf x},\quad\sbf N_{j+4}^{e}=N_{y,j}^{e}\hat{\sbf y},\quad\sbf N_{j+8}^{e}=N_{z,j}^{e}\hat{\sbf z}\label{eq:8.52}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="13" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
棱边
\begin_inset Formula $i$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
节点
\begin_inset Formula $i_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
节点
\begin_inset Formula $i_{2}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
11
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
12
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Rectangular Brick Element 的边定义
\begin_inset CommandInset label
LatexCommand label
name "tab:8.1"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
不难看出，
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.52"
plural "false"
caps "false"
noprefix "false"

\end_inset

式定义的矢量基函数有零散度（即 
\begin_inset Formula $\nabla\cdot\sbf N_{i}^{e}=0$
\end_inset

）和非零旋度。也不难看出，单元小平面 上的切向场由组成小平面的 棱边上的切向场决定。因此，
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.51"
plural "false"
caps "false"
noprefix "false"

\end_inset

 式给出的展开式不仅保证了穿越棱边时的切向连续性，而且保证了穿越单元面时的切向连续性。
\end_layout

\begin_layout Subsection
四面体单元 tetrahedral
\end_layout

\begin_layout Standard
第
\begin_inset CommandInset ref
LatexCommand eqref
reference "chap:5"
plural "false"
caps "false"
noprefix "false"

\end_inset

章中导出了四面体单元的线性插值函数，在此可记为
\begin_inset Formula $(L_{1}^{e},L_{2}^{e},L_{3}^{e},L_{4}^{e})$
\end_inset

。类似于三角形单元，让我们考察矢量函数
\begin_inset Formula 
\begin{equation}
\sbf W_{12}=L_{1}^{e}\nabla L_{2}^{e}-L_{2}^{e}\nabla L_{1}^{e}\label{eq:8.53}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate
它满足
\begin_inset Formula 
\begin{equation}
\nabla\cdot\sbf W_{12}=0,\quad\nabla\times\sbf W_{12}=2\nabla L_{1}^{e}\times\nabla L_{2}^{e}\label{eq:8.54}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $\sbf W_{12}$
\end_inset

 沿着棱边 
\begin_inset Formula $(1,2)$
\end_inset

 有一个常数切向分量，沿另外五条棱没有切向分量。
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\sbf W_{12}$
\end_inset

 只在包含棱边 
\begin_inset Formula $(1,2)$
\end_inset

 的单元小平面有切向分量，即在 
\begin_inset Formula $(1,2,3)$
\end_inset

 和 
\begin_inset Formula $(1,2,4)$
\end_inset

 上。而在 
\begin_inset Formula $(1,3,4)$
\end_inset

 和 
\begin_inset Formula $(2,3,4)$
\end_inset

 上没有切向分量。
\end_layout

\begin_layout Standard
因此 
\begin_inset Formula $\sbf W_{12}$
\end_inset

 具有作为与棱边
\begin_inset Formula $(1,2)$
\end_inset

 相关的棱边场的矢量基函数所需的所有特性。如果定义该边为棱边
\begin_inset Formula $1$
\end_inset

，则有
\begin_inset Formula 
\begin{equation}
\sbf N_{1}^{e}=\sbf W_{12}\ell_{1}^{e}=\left(L_{1}^{e}\nabla L_{2}^{e}-L_{2}^{e}\nabla L_{1}^{e}\right)\ell_{1}^{e}\label{eq:8.56}
\end{equation}

\end_inset

类似地得到棱边
\begin_inset Formula $i$
\end_inset

的矢量基函数为
\begin_inset Formula 
\begin{equation}
\sbf N_{i}^{e}=\sbf W_{i_{1}i_{2}}\ell_{i}^{e}=\left(L_{i_{1}}^{e}\nabla L_{i_{2}}^{e}-L_{i_{2}}^{e}\nabla L_{i_{1}}^{e}\right)\ell_{i}^{e}\label{eq:8.57}
\end{equation}

\end_inset

其中棱边编号及相关节点 
\begin_inset Formula $i_{1}$
\end_inset

和
\begin_inset Formula $i_{2}$
\end_inset

 定义在
\begin_inset CommandInset ref
LatexCommand eqref
reference "tab:8.2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中。
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "48col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename inset/Jinjm-8.8.pdf
	scale 50

\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
delta = 0.05; Graphics3D[{ Arrowheads[{{.02, 0.65}}], vtx2 = {0, 0, 0}; vtx1
 = {-1, 1, 0}; vtx3 = {1, 1, 0}; vtx4 = {0, 1, 1}; (*vertex 1*) Arrow[{vtx1,
 vtx2}], Arrow[{vtx2, vtx3}], Arrow[{vtx1, vtx3}], (*dsss*) Arrow[{vtx1,
 vtx4}], Arrow[{vtx4, vtx2}], Arrow[{vtx3, vtx4}], (*Axes Label*) Arrowheads[.02]
, ls = {-.7, -.7, 0}; Arrow[{ls + {0, 0, 0}, ls + {0.5, 0, 0}}], Text["x",
 ls + {0.5 + delta, 0, 0}], Arrow[{ls + {0, 0, 0}, ls + {0, 0.5, 0}}], Text["y",
 ls + {0, 0.5 + delta, 0}], Arrow[{ls + {0, 0, 0}, ls + {0, 0, 0.5}}], Text["z",
 ls + {0, 0, 0.5 + delta}], (*Labe for Vertex and edges*) FontSize -> 13,
 vs = {.1, .1, .1}; Text[1, vtx1 - vs], Text[2, vtx2 - vs], Text[3, vtx3 +
 vs], Text[4, vtx4 + vs], {Red , Text["(1)", 0.6 vtx1 + 0.4 vtx2] , Text["(2)",
 0.6 vtx1 + 0.4 vtx3] , Text["(3)", 0.6 vtx1 + 0.4 vtx4] , Text["(4)", 0.6 vtx2
 + 0.4 vtx3] , Text["(5)", 0.6 vtx4 + 0.4 vtx2] , Text["(6)", 0.6 vtx3 + 0.4
 vtx4] }} , PlotRangePadding -> {Scaled[.1], Scaled[.1], Scaled[.1]}, ImageSize
 -> Medium, Boxed -> False ]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
四面体单元
\begin_inset CommandInset label
LatexCommand label
name "fig:8.8"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "48col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
棱边
\begin_inset Formula $i$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
节点
\begin_inset Formula $i_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
节点
\begin_inset Formula $i_{2}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $5$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $6$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
四面体单元的棱边定义
\begin_inset CommandInset label
LatexCommand label
name "tab:8.2"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $\sbf N_{i}^{e}$
\end_inset

 的另一种表达式在文献[8]中到处，它们是
\begin_inset Formula 
\begin{equation}
\sbf N_{7-i}^{e}=\begin{cases}
\sbf f_{7-i}^{e}+\sbf g_{7-i}^{e}\times\sbf r, & \sbf r\,\text{在四面体内}\\
0, & \text{其他}
\end{cases}\label{eq:8.58}
\end{equation}

\end_inset

其中
\begin_inset Formula 
\begin{equation}
\sbf f_{7-i}^{e}=\frac{\ell_{7-i}^{e}}{6V^{e}}\sbf r_{i_{1}}^{e}\times\sbf r_{i_{2}}^{e},\quad\sbf g_{7-i}^{e}=\frac{\ell_{i}^{e}\ell_{7-i}^{e}\sbf e_{i}}{6V^{e}}\label{eq:8.59}
\end{equation}

\end_inset

式中 
\begin_inset Formula $i=1,2,\cdots,6$
\end_inset

，
\begin_inset Formula $V^{e}$
\end_inset

是四面体单元的体积，
\begin_inset Formula $\sbf e_{i}=\left(\sbf r_{i_{2}}^{e}-\sbf r_{i_{1}}^{e}\right)/\ell_{i}^{e}$
\end_inset

 是第
\begin_inset Formula $i$
\end_inset

个棱边的单位矢量，且 
\begin_inset Formula $\ell_{i}^{e}=\abs{\sbf r_{i_{2}}^{e}-\sbf r_{i_{1}}^{e}}$
\end_inset

 是第
\begin_inset Formula $i$
\end_inset

个棱边的长度，
\begin_inset Formula $\sbf r_{i_{1}}^{e}$
\end_inset

和 
\begin_inset Formula $\sbf r_{i_{2}}^{e}$
\end_inset

表示第
\begin_inset Formula $e$
\end_inset

 个单元的 
\begin_inset Formula $i_{1}$
\end_inset

和
\begin_inset Formula $i_{2}$
\end_inset

节点的位置。
\end_layout

\begin_layout Subsection
六面体单元 hexahedral
\end_layout

\begin_layout Standard
除了矩阵块单元和四面体单元外，另一种值得提及的单元是六面体单元，即所谓的变形的矩阵块单元。类似于二维中的四边形单元，
\begin_inset Formula $xyz$
\end_inset

 坐标系中的一个六面体单元可以变换成 
\begin_inset Formula $\xi\eta\zeta$
\end_inset

坐标系中的正方体单元。所需的变换可容易找到
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename inset-fem-JinJianMing/f8.9.png
	lyxscale 70
	scale 60

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Formula $(a)$
\end_inset

 
\begin_inset Formula $xyz$
\end_inset

 坐标系中的六面体单元；
\begin_inset Formula $(b)$
\end_inset

 变换成 
\begin_inset Formula $\xi\eta\zeta$
\end_inset

坐标系中的正方体单元
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
x=\sum_{i=1}^{8}N_{i}^{e}\left(\xi,\eta,\zeta\right)x_{i}^{e},\quad z=\sum_{i=1}^{8}N_{i}^{e}\left(\xi,\eta,\zeta\right)y_{i}^{e},\quad z=\sum_{i=1}^{8}N_{i}^{e}\left(\xi,\eta,\zeta\right)z_{i}^{e},\label{eq:8.60}
\end{equation}

\end_inset

其中 
\begin_inset Formula 
\begin{equation}
N_{i}^{e}\left(\xi,\eta,\zeta\right)=\frac{1}{8}\left(1+\xi_{i}\xi\right)\left(1+\eta_{i}\eta\right)\left(1+\zeta_{i}\zeta\right)\label{eq:8.61}
\end{equation}

\end_inset


\begin_inset Formula $(\xi_{i},\eta_{i},\xi_{i})$
\end_inset

 表示第
\begin_inset Formula $i$
\end_inset

个节点的坐标。
\end_layout

\begin_layout Standard
因为
\begin_inset Formula $\xi$
\end_inset

沿平行于 
\begin_inset Formula $\xi$
\end_inset

 轴的那些棱边线性变化，而沿其他棱边是常量，所以有
\begin_inset Formula $\nabla\xi$
\end_inset

定义的矢量函数仅沿平行 
\begin_inset Formula $\xi$
\end_inset

 轴的那些棱边有非零切向分量。因而可以为这些棱边建立矢量基函数
\begin_inset Formula 
\begin{equation}
N_{i}^{e}=\frac{\ell_{i}^{e}}{8}\left(1+\eta_{i}\eta\right)\left(1+\zeta_{i}\zeta\right)\nabla\xi\label{eq:8.62}
\end{equation}

\end_inset

 其中 
\begin_inset Formula $(\eta_{i},\xi_{i})$
\end_inset

 表示坐标 
\begin_inset Formula $(\eta,\zeta)$
\end_inset

 在棱边
\begin_inset Formula $i$
\end_inset

上的值。类似地，我们可以建立平行于
\begin_inset Formula $\eta$
\end_inset

轴的棱边的矢量基函数
\begin_inset Formula 
\begin{equation}
N_{i}^{e}=\frac{\ell_{i}^{e}}{8}\left(1+\xi_{i}\xi\right)\left(1+\zeta_{i}\zeta\right)\nabla\eta\label{eq:8.63}
\end{equation}

\end_inset

和平行于 
\begin_inset Formula $\zeta$
\end_inset

 轴的基函数
\begin_inset Formula 
\begin{equation}
N_{i}^{e}=\frac{\ell_{i}^{e}}{8}\left(1+\xi_{i}\xi\right)\left(1+\eta_{i}\eta\right)\nabla\zeta\label{eq:8.64}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
这样建立的矢量基函数具有保证穿越单元棱边和单元面的 
\series bold
切向连续性
\series default
 所需的全部性质。然而不像矩形块单元和四面体单元的矢量基函数，它们不是无散的。因为散度对略微变形单元是小的，对严重变形单元是大的，所以人们应该尽量避免在形状上极
大偏离矩阵块单元的六面体单元。
\end_layout

\begin_layout Subsection
单元矩阵的计算
\end_layout

\begin_layout Standard
把上面讨论的基函数，应用到矢量波动方程的三维有限元离散，得到的单元矩阵包含下面两个积分
\begin_inset Formula 
\begin{align}
 & E_{ij}^{e}=\iiint_{V^{e}}\left(\nabla\times\sbf N_{i}^{e}\right)\cdot\left(\nabla\times\sbf N_{j}^{e}\right)\dd{V}\label{eq:8.65}\\
 & E_{ij}^{e}F_{i}^{e}=\iiint_{V^{e}}\sbf N_{i}^{e}\cdot\sbf N_{j}^{e}\dd{V}\label{eq:8.66}
\end{align}

\end_inset

对矩形块单元（rectangular brick）和四面体（tetrahedral）单元，可解析计算这两个积分。对六面体（hexahedral）单元采用高斯积分
法。
\end_layout

\begin_layout Example
For rectangular brick elements,
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Example
For tetrahedral elements,
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Example
六面体单元的
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.65"
plural "false"
caps "false"
noprefix "false"

\end_inset

式和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.66"
plural "false"
caps "false"
noprefix "false"

\end_inset

的数值计算与二维中四边形单元相似，在此做简要讨论。首先需要把所有被积函数转换到 
\begin_inset Formula $\xi,\eta,\zeta$
\end_inset

 坐标系。为此引入雅可比行列式
\begin_inset Formula 
\begin{equation}
[J]=\left[\begin{array}{ccc}
\frac{\partial x}{\partial\xi} & \frac{\partial y}{\partial\xi} & \frac{\partial z}{\partial\xi}\\
\frac{\partial x}{\partial\eta} & \frac{\partial y}{\partial\eta} & \frac{\partial z}{\partial\eta}\\
\frac{\partial x}{\partial\zeta} & \frac{\partial y}{\partial\zeta} & \frac{\partial z}{\partial\zeta}
\end{array}\right]\label{eq:8.66-1}
\end{equation}

\end_inset

根据
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.60"
plural "false"
caps "false"
noprefix "false"

\end_inset

 式，
\begin_inset Formula $[J]$
\end_inset

 可以用 
\begin_inset Formula $\xi,\eta,\zeta$
\end_inset

 完全表示。体积单元的变换为
\begin_inset Formula 
\[
\dd{V}=\dd{x}\dd{y}\dd{z}=\det[J]\dd{\xi}\dd{\eta}\dd{\zeta}.
\]

\end_inset

此外，对任意函数
\begin_inset Formula $f$
\end_inset

，
\begin_inset Formula 
\begin{equation}
\left\{ \begin{array}{c}
\frac{\partial f}{\partial x}\\
\frac{\partial f}{\partial y}\\
\frac{\partial f}{\partial z}
\end{array}\right\} =[J]^{-1}\left\{ \begin{array}{c}
\frac{\partial f}{\partial\xi}\\
\frac{\partial f}{\partial\eta}\\
\frac{\partial f}{\partial\zeta}
\end{array}\right\} .\label{eq:8.66-2}
\end{equation}

\end_inset

使用此式可得到用 
\begin_inset Formula $\xi,\eta,\zeta$
\end_inset

 表示的 
\begin_inset Formula $\nabla\xi$
\end_inset

，
\begin_inset Formula $\nabla\eta$
\end_inset

，
\begin_inset Formula $\nabla\zeta$
\end_inset

 的表达式。因此实现把 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.65"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:8.66"
plural "false"
caps "false"
noprefix "false"

\end_inset

中的被积函数完全用 
\begin_inset Formula $\xi,\eta,\zeta$
\end_inset

 表示。经过转换后，它们可以用下面给出的三维高斯积分公式进行数值计算，
\begin_inset Formula 
\[
\int_{-1}^{1}\int_{-1}^{1}\int_{-1}^{1}f\left(\xi,\eta,\zeta\right)\dd{\xi}\dd{\eta}\dd{\zeta}=\sum_{i=1}^{n_{1}}\sum_{i=2}^{n_{2}}\sum_{i=3}^{n_{3}}W_{i}W_{j}W_{k}f\left(\xi_{i},\eta_{i},\zeta_{i}\right).
\]

\end_inset

其中 
\begin_inset Formula $n_{1}$
\end_inset

，
\begin_inset Formula $n_{2}$
\end_inset

，
\begin_inset Formula $n_{3}$
\end_inset

分别是沿 
\begin_inset Formula $\xi$
\end_inset

 轴，
\begin_inset Formula $\eta$
\end_inset

轴， 
\begin_inset Formula $\zeta$
\end_inset

 轴的积分点数，
\begin_inset Formula $W_{i}$
\end_inset

 ，
\begin_inset Formula $W_{j}$
\end_inset

，
\begin_inset Formula $W_{k}$
\end_inset

是权重因子，
\begin_inset Formula $\xi_{i}$
\end_inset

，
\begin_inset Formula $\eta_{i}$
\end_inset

，
\begin_inset Formula $\zeta_{i}$
\end_inset

 是积分点。同样，如果被积函数多项式阶数
\begin_inset Formula $\le3$
\end_inset

，选择 
\begin_inset Formula $n_{1}=n_{2}=n_{3}$
\end_inset

就足够了。 
\end_layout

\begin_layout Chapter
时域有限元
\end_layout

\begin_layout Section
有限元公式
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
[T]\frac{\dd[2]{\{u\}}}{\dd{t^{2}}}+\left([R]+[Q]\right)\frac{\dd{\{u\}}}{\dd{t}}+[S]\{u\}+\{f\}=\{0\}.\label{eq:12.5}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
时域离散
\end_layout

\begin_layout Standard
在这一节我们采用几种有限差分方案，在时域上（time domain）离散化（discretize）
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.5"
plural "false"
caps "false"
noprefix "false"

\end_inset

。为此，首先把时间轴均匀分成多份，从而将时间变量
\begin_inset Formula $t$
\end_inset

写成
\begin_inset Formula $t=n\Delta t$
\end_inset

，其中
\begin_inset Formula $\Delta t$
\end_inset

叫做时间步（time step）。为了简洁，我们经常把
\begin_inset Formula $u(n\Delta t)$
\end_inset

写作
\begin_inset Formula $u^{n}$
\end_inset

。
\end_layout

\begin_layout Subsection
前向差分
\end_layout

\begin_layout Standard
函数
\begin_inset Formula $(u+\Delta t)$
\end_inset

 可以写成
\begin_inset Formula $t$
\end_inset

 的泰勒级数
\begin_inset Formula 
\begin{equation}
u(t+\Delta t)=u(\Delta t)+u'(t)\Delta t+u''(t)\frac{(\Delta t)^{2}}{2!}+\mathcal{O}[(\Delta t)^{3}]\label{eq:12.11}
\end{equation}

\end_inset

其中
\begin_inset Formula $\mathcal{O}[(\Delta t)^{3}]$
\end_inset

表示其余包含 
\begin_inset Formula $(\Delta t)^{p}$
\end_inset

且
\begin_inset Formula $p\ge3$
\end_inset

的项之和，从
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.11"
plural "false"
caps "false"
noprefix "false"

\end_inset

得到
\begin_inset Formula 
\begin{equation}
u'(t)=\frac{u(t+\Delta t)-u(t)}{\Delta t}+\mathcal{O}[(\Delta t)^{2}]\label{eq:12.12}
\end{equation}

\end_inset

或者写成
\begin_inset Formula 
\begin{equation}
u'(t)\approx\frac{u(t+\Delta t)-u(t)}{\Delta t}\label{eq:12.13}
\end{equation}

\end_inset

这就是向前差分格式（representation），它是一阶精度（accurate），截断误差包含
\begin_inset Formula $(\Delta t)^{p}$
\end_inset

，
\begin_inset Formula $p>1$
\end_inset

。
\end_layout

\begin_layout Standard
使用记号 
\begin_inset Formula $u(t)=u(n\Delta t)=u^{n}$
\end_inset

，可以把
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.13"
plural "false"
caps "false"
noprefix "false"

\end_inset

写成
\begin_inset Formula 
\begin{equation}
u'(t)\approx\frac{u^{n+1}-u^{n}}{\Delta t}.\label{eq:12.14}
\end{equation}

\end_inset

如果把向前差分应用到
\begin_inset Formula $\dd{u}/\dd{t}$
\end_inset

，可以得到二阶导数的向前差分格式
\begin_inset Formula 
\begin{equation}
u''(t)\approx\frac{u^{n+2}-2u^{n+1}+u^{n}}{(\Delta t)^{2}}.\label{eq:12.15}
\end{equation}

\end_inset

它是一阶精度的(accurate)。
\end_layout

\begin_layout Standard
使用
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.14"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.15"
plural "false"
caps "false"
noprefix "false"

\end_inset

代入
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.5"
plural "false"
caps "false"
noprefix "false"

\end_inset

 
\begin_inset Formula $[T]\{u''(t)\}+[T_{\sigma}]\{u'(t)\}+[S]\{u\}+\{f\}=\{0\}$
\end_inset

，可得
\begin_inset Formula 
\begin{align}
\frac{1}{(\Delta t)^{2}}[T]\{u\}^{n+1}= & \left\{ \frac{2}{(\Delta t)^{2}}[T]-\frac{1}{\Delta t}[T_{\sigma}]\right\} \{u\}^{n}\nonumber \\
 & -\left\{ \frac{1}{(\Delta t)^{2}}[T]-\frac{1}{\Delta t}[T_{\sigma}]+[S]\right\} \{u\}^{n-1}-\{f\}^{n-1}\label{eq:12.16}
\end{align}

\end_inset

其中
\begin_inset Formula $[T_{\sigma}]=[R]+[Q]$
\end_inset

。显然，当给出输入
\begin_inset Formula $\{f\}^{n}$
\end_inset

和初值
\begin_inset Formula $\{u\}^{(0)}$
\end_inset

和
\begin_inset Formula $\{u\}^{(1)}$
\end_inset

，可以使用
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.16"
plural "false"
caps "false"
noprefix "false"

\end_inset

解出
\begin_inset Formula $\{u\}^{(2)}$
\end_inset

，
\begin_inset Formula $\{u\}^{(3)}$
\end_inset

等等。这个过程称为
\series bold
时间推进
\series default
（time marching）。不幸的是，后面将证明
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.16"
plural "false"
caps "false"
noprefix "false"

\end_inset

的时间推进是数值不稳定的，因此目前
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.16"
plural "false"
caps "false"
noprefix "false"

\end_inset

的用处不大。
\end_layout

\begin_layout Subsection
后向差分
\end_layout

\begin_layout Standard
函数
\begin_inset Formula $(u-\Delta t)$
\end_inset

的泰勒展开
\begin_inset Formula 
\begin{equation}
u(t-\Delta t)=u(\Delta t)+u'(t)\Delta t+u''(t)\frac{(\Delta t)^{2}}{2!}+\mathcal{O}[(\Delta t)^{3}]\label{eq:12.17}
\end{equation}

\end_inset

可以得到后向差分，
\begin_inset Formula 
\begin{equation}
u'(t)\approx\frac{u^{n}-u^{n-1}}{\Delta t}.\label{eq:12.20}
\end{equation}

\end_inset

它是一阶精度的。
\begin_inset Formula 
\begin{equation}
u''(t)\approx\frac{u^{n}-2u^{n-1}+u^{n-2}}{(\Delta t)^{2}}.\label{eq:12.21}
\end{equation}

\end_inset

也是一阶精度。
\end_layout

\begin_layout Standard
使用
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.20"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.21"
plural "false"
caps "false"
noprefix "false"

\end_inset

代入
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.5"
plural "false"
caps "false"
noprefix "false"

\end_inset

 
\begin_inset Formula $[T]\{u''(t)\}+[T_{\sigma}]\{u'(t)\}+[S]\{u\}+\{f\}=\{0\}$
\end_inset

，可得
\begin_inset Formula 
\begin{align}
\left\{ \frac{1}{(\Delta t)^{2}}[T]+\frac{1}{\Delta t}[T_{\sigma}]+[S]\right\} \{u\}^{n+1}= & \left\{ \frac{2}{(\Delta t)^{2}}[T]+\frac{1}{\Delta t}[T_{\sigma}]\right\} \{u\}^{n}\nonumber \\
 & -\frac{1}{(\Delta t)^{2}}[T]\{u\}^{n-1}-\{f\}^{n+1}\label{eq:12.22}
\end{align}

\end_inset

其中
\begin_inset Formula $[T_{\sigma}]=[R]+[Q]$
\end_inset

。同理，当给出输入
\begin_inset Formula $\{f\}^{n}$
\end_inset

和初值
\begin_inset Formula $\{u\}^{(0)}$
\end_inset

和
\begin_inset Formula $\{u\}^{(1)}$
\end_inset

，可以使用
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.22"
plural "false"
caps "false"
noprefix "false"

\end_inset

解出
\begin_inset Formula $\{u\}^{(2)}$
\end_inset

，
\begin_inset Formula $\{u\}^{(3)}$
\end_inset

等等。这个方法被称为
\series bold
隐式方案
\series default
（implicit scheme），因为在每个时间步，它需要求解包含
\begin_inset Formula $[S]$
\end_inset

 的矩阵方程。后面会看到，不管怎样选取
\begin_inset Formula $\Delta t$
\end_inset

，这个方法总是稳定的（stable），或者说是它无条件稳定的。
\end_layout

\begin_layout Subsection
中心差分
\end_layout

\begin_layout Standard
用
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.11"
plural "false"
caps "false"
noprefix "false"

\end_inset

减去
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.17"
plural "false"
caps "false"
noprefix "false"

\end_inset

，
\begin_inset Formula 
\begin{align*}
u(t+\Delta t) & =u(\Delta t)+u'(t)\Delta t+u''(t)\frac{(\Delta t)^{2}}{2!}+\mathcal{O}[(\Delta t)^{3}]\\
u(t-\Delta t) & =u(\Delta t)+u'(t)\Delta t+u''(t)\frac{(\Delta t)^{2}}{2!}+\mathcal{O}[(\Delta t)^{3}]
\end{align*}

\end_inset

得到中心差分
\begin_inset Formula 
\begin{equation}
\frac{\dd{u}}{\dd{t}}=\frac{u^{n+1}-u^{n-1}}{2\Delta t}+\mathcal{O}[(\Delta t)^{3}].\label{eq:12.27}
\end{equation}

\end_inset

用
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.17"
plural "false"
caps "false"
noprefix "false"

\end_inset

加上
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.11"
plural "false"
caps "false"
noprefix "false"

\end_inset

，得到二阶导数的近似表达式
\begin_inset Formula 
\begin{equation}
\frac{\dd[2]{u}}{\dd{t^{2}}}=\frac{u^{n+1}-2u^{n-1}+u^{n-1}}{(\Delta t)^{2}}+\mathcal{O}[(\Delta t)^{3}].\label{eq:12.28}
\end{equation}

\end_inset

它们都是二阶精度的。
\end_layout

\begin_layout Standard
使用
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.27"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.28"
plural "false"
caps "false"
noprefix "false"

\end_inset

代入
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.5"
plural "false"
caps "false"
noprefix "false"

\end_inset


\begin_inset Formula $[T]\{u''(t)\}+[T_{\sigma}]\{u'(t)\}+[S]\{u\}+\{f\}=\{0\}$
\end_inset

，可得
\begin_inset Formula 
\begin{align}
\left\{ \frac{1}{(\Delta t)^{2}}[T]+\frac{1}{2\Delta t}[T_{\sigma}]\right\} \{u\}^{n+1}= & \left\{ \frac{2}{(\Delta t)^{2}}[T]-[S]\right\} \{u\}^{n}\nonumber \\
 & -\left\{ \frac{1}{(\Delta t)^{2}}[T]-\frac{1}{2\Delta t}[T_{\sigma}]\right\} \{u\}^{n-1}-\{f\}^{n}\label{eq:12.29}
\end{align}

\end_inset

其中
\begin_inset Formula $[T_{\sigma}]=[R]+[Q]$
\end_inset

。只要给定
\begin_inset Formula $\{f\}^{n}$
\end_inset

和初值
\begin_inset Formula $\{u\}^{(0)}$
\end_inset

，
\begin_inset Formula $\{u\}^{(1)}$
\end_inset

，就能逐步求出
\begin_inset Formula $\{u\}^{n}$
\end_inset

。相比于
\series bold
隐式方案
\series default
，此方法被称为
\series bold
显式方案
\series default
，因为每个时间步要求解的矩阵不涉及
\begin_inset Formula $[S]$
\end_inset

。后面会证明，只要
\begin_inset Formula $\Delta t$
\end_inset

足够小，
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.29"
plural "false"
caps "false"
noprefix "false"

\end_inset

的时间推进过程就是稳定的。
\end_layout

\begin_layout Subsection
Newmark方法
\end_layout

\begin_layout Standard
ref: page 280/534。
\end_layout

\begin_layout Standard
另一种直接积分方法被称作 Newmark 方法。在这种方法中[48]，在
\begin_inset Formula $t+\Delta t$
\end_inset

时刻的函数
\begin_inset Formula $u(t)$
\end_inset

与其导数被近似为
\begin_inset Formula 
\begin{align}
u(t+\Delta t)= & u(t)+(\Delta t)\,u'(t)+(\frac{1}{2}-\beta)(\Delta t)^{2}\,u''(t)+\beta(\Delta t)^{2}\,u''(t+\Delta t)\label{eq:12.30}\\
u'(t+\Delta t)= & u'(t)+(1-\gamma)\Delta t\,u''(t)+\gamma\Delta t\,u''(t+\Delta t)\label{eq:12.31}
\end{align}

\end_inset

其中
\begin_inset Formula $u'$
\end_inset

和
\begin_inset Formula $u''$
\end_inset

分别表示
\begin_inset Formula $1$
\end_inset

，
\begin_inset Formula $2$
\end_inset

阶导数，
\begin_inset Formula $\beta$
\end_inset

和
\begin_inset Formula $\gamma$
\end_inset

是两个参数，通过选择它们，可以控制 时间推进过程 的精度和稳定性（accuracy and stability）。将
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.30"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.31"
plural "false"
caps "false"
noprefix "false"

\end_inset

代入
\begin_inset Formula $t+\Delta t$
\end_inset

时刻的二阶偏微分方程，可以导出 
\begin_inset Formula $u''(t+\Delta t)$
\end_inset

用 
\begin_inset Formula $u(t)$
\end_inset

，
\begin_inset Formula $u'(t)$
\end_inset

和
\begin_inset Formula $u''(t)$
\end_inset

表示的表达式，将结果回代到
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.30"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.31"
plural "false"
caps "false"
noprefix "false"

\end_inset

，就分别得到了 
\begin_inset Formula $u(t+\Delta t)$
\end_inset

 和 
\begin_inset Formula $u'(t+\Delta t)$
\end_inset

 的表达式。
\end_layout

\begin_layout Standard
将Newmark 方法用于离散
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.5"
plural "false"
caps "false"
noprefix "false"

\end_inset

得到
\begin_inset Formula 
\begin{align}
\left\{ \frac{1}{(\Delta t)^{2}}[T]+\frac{\gamma}{\Delta t}[T_{\sigma}]+\beta[S]\right\} \{u\}^{n+1}= & \left\{ \frac{2}{(\Delta t)^{2}}[T]-\frac{(1-2\gamma)}{\Delta t}[T_{\sigma}]-(\frac{1}{2}+\gamma-2\beta)[S]\right\} \{u\}^{n}\nonumber \\
 & -\left\{ \frac{1}{(\Delta t)^{2}}[T]-\frac{1-\gamma}{\Delta t}[T_{\sigma}]+(\frac{1}{2}-\gamma+\beta)[S]\right\} \{u\}^{n-1}\nonumber \\
 & -\left[\beta\{f\}^{n+1}+(\frac{1}{2}+\gamma-2\beta)\{f\}^{n}+(\frac{1}{2}-\gamma+\beta)\{f\}^{n-1}\right].\label{eq:12.32}
\end{align}

\end_inset

Newmark 方法最有用的版本是令
\begin_inset Formula $\gamma=\frac{1}{2}$
\end_inset

，也被称为 Newmark–
\begin_inset Formula $\beta$
\end_inset

方法，在这里
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.32"
plural "false"
caps "false"
noprefix "false"

\end_inset

将变成
\begin_inset Formula 
\begin{align}
\left\{ \frac{1}{(\Delta t)^{2}}[T]+\frac{1}{2\Delta t}[T_{\sigma}]+\beta[S]\right\} \{u\}^{n+1}= & \left\{ \frac{2}{(\Delta t)^{2}}[T]-(1-2\beta)[S]\right\} \{u\}^{n}\nonumber \\
 & -\left\{ \frac{1}{(\Delta t)^{2}}[T]-\frac{1}{2\Delta t}[T_{\sigma}]+\beta[S]\right\} \{u\}^{n-1}\nonumber \\
 & -\left[\beta\{f\}^{n+1}+(1-2\beta)\{f\}^{n}+\beta\{f\}^{n-1}\right].\label{eq:12.33}
\end{align}

\end_inset

显然如果令
\begin_inset Formula $\beta=0$
\end_inset

，
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.33"
plural "false"
caps "false"
noprefix "false"

\end_inset

就回到中心差分格式。如果令
\begin_inset Formula $\beta=0.25$
\end_inset

，Newmark–
\begin_inset Formula $\beta$
\end_inset

给出著名的梯形规则（trapezoidal rule）。可以证明，当
\begin_inset Formula $\beta\ge0.25$
\end_inset

时，
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.33"
plural "false"
caps "false"
noprefix "false"

\end_inset

的时间推进总是无条件稳定的，对应的方法是
\series bold
隐式方案
\series default
。
\end_layout

\begin_layout Standard
当
\begin_inset Formula $\gamma\ge1/2$
\end_inset

，
\begin_inset Formula $\beta\ge\frac{1}{4}(\frac{1}{2}+\gamma)^{2}$
\end_inset

时，Newmark–
\begin_inset Formula $\beta$
\end_inset

法是无条件稳定的。
\end_layout

\begin_layout Subsection
Newmark迭代求解
\end_layout

\begin_layout Standard
ref: 
\begin_inset CommandInset href
LatexCommand href
name "Newmark-Beta求解振动方程"
target "https://zhuanlan.zhihu.com/p/451555272"
literal "false"

\end_inset

。从Newmark方法的表达式
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.30"
plural "false"
caps "false"
noprefix "false"

\end_inset

，
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.31"
plural "false"
caps "false"
noprefix "false"

\end_inset


\begin_inset Formula 
\begin{align*}
u_{n+1}= & u_{n}+\Delta t\,u_{n}^{\prime}+(\frac{1}{2}-\beta)\Delta t{}^{2}\,u_{n}^{\prime\prime}+\beta\Delta t^{2}\,u_{n+1}^{\prime\prime}\\
u_{n+1}^{\prime}= & u_{n}^{\prime}+(1-\gamma)\Delta t\,u_{n}^{\prime\prime}+\gamma\Delta t\,u_{n+1}^{\prime\prime}
\end{align*}

\end_inset

可以推导出
\begin_inset Formula $u''(t+\Delta t)$
\end_inset

和
\begin_inset Formula $u'(t+\Delta t)$
\end_inset

 以 
\begin_inset Formula $u(t)$
\end_inset

，
\begin_inset Formula $u'(t)$
\end_inset

和
\begin_inset Formula $u''(t)$
\end_inset

表示的表达式，即
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Solve[{ u[n + 1] == u[n] + 
\backslash
[CapitalDelta]t* u'[n] + (1/2 - 
\backslash
[Beta]) (
\backslash
[CapitalDelta]t)^2 u''[ n] + 
\backslash
[Beta] (
\backslash
[CapitalDelta]t)^2 u''[n + 1], u'[n + 1] == u'[n] + (1 - 
\backslash
[Gamma]) 
\backslash
[CapitalDelta]t* u''[n] + 
\backslash
[Gamma]*
\backslash
[CapitalDelta]t*u''[n + 1] }, {u'[n + 1], u''[n + 1]} ] // Expand
\end_layout

\end_inset


\begin_inset Formula 
\begin{align}
u_{n+1}^{\prime} & =\frac{\gamma}{\beta\Delta t}\left(u_{n+1}-u_{n}\right)+\left(1-\frac{\gamma}{\beta}\right)u{}_{n}^{\prime}+\left(1-\frac{\gamma}{2\beta}\right)\Delta_{t}u_{n}^{\prime\prime}\label{eq:nmark1}\\
u_{n+1}^{\prime\prime} & =\frac{1}{\beta(\Delta t)^{2}}\left(u_{n+1}-u_{n}\right)-\frac{1}{\beta\Delta t}u_{n}^{\prime}+\left(1-\frac{1}{2\beta}\right)u_{n}^{\prime\prime}\label{eq:nmark2}
\end{align}

\end_inset


\end_layout

\begin_layout Exercise
使用
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.30"
plural "false"
caps "false"
noprefix "false"

\end_inset

和
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.31"
plural "false"
caps "false"
noprefix "false"

\end_inset

，从
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.5"
plural "false"
caps "false"
noprefix "false"

\end_inset

推导
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.32"
plural "false"
caps "false"
noprefix "false"

\end_inset

。即本章开始的方程
\begin_inset Formula 
\begin{equation}
[T]\{u_{n}^{\prime\prime}\}+[T_{\sigma}]\{u_{n}^{\prime}\}+[S]\{u_{n}\}+\{f_{n}\}=\{0\}.\label{eq:12.5b}
\end{equation}

\end_inset

分别写出
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:nmark1"
plural "false"
caps "false"
noprefix "false"

\end_inset

在第
\begin_inset Formula $n+1$
\end_inset

步，第
\begin_inset Formula $n$
\end_inset

步的表达式，
\begin_inset Formula 
\begin{align*}
 & u_{n+1}^{\prime}=\left[u_{n+1},u_{n},u_{n}^{\prime},u_{n}^{\prime\prime}\right]\\
 & u_{n+1}^{\prime\prime}=\left[u_{n+1},u_{n},u_{n}^{\prime},u_{n}^{\prime\prime}\right]\\
 & u_{n}^{\prime}=\left[u_{n},u_{n-1},u_{n-1}^{\prime},u_{n-1}^{\prime\prime}\right]\\
 & u_{n}^{\prime\prime}=\left[u_{n},u_{n-1},u_{n-1}^{\prime},u_{n-1}^{\prime\prime}\right]
\end{align*}

\end_inset

以及微分方程
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.5b"
plural "false"
caps "false"
noprefix "false"

\end_inset

在第
\begin_inset Formula $n-1$
\end_inset

，
\begin_inset Formula $n$
\end_inset

，
\begin_inset Formula $n+1$
\end_inset

步的表达式，
\begin_inset Formula 
\begin{align*}
 & [T]u_{n+1}^{\prime\prime}+[T_{\sigma}]u_{n+1}^{\prime}+[S]u_{n+1}=-f_{n+1}\\
 & [T]u_{n}^{\prime\prime}+[T_{\sigma}]u_{n}^{\prime}+[S]u_{n}=-f_{n}\\
 & [T]u_{n-1}^{\prime\prime}+[T_{\sigma}]u_{n-1}^{\prime}+[S]u_{n-1}=-f_{n-1}
\end{align*}

\end_inset

一共是
\begin_inset Formula $7$
\end_inset

个方程，
\begin_inset Formula $7$
\end_inset

个变量
\begin_inset Formula 
\[
u_{n+1}^{\prime\prime},\quad u_{n+1}^{\prime},\quad u_{n}^{\prime\prime},\quad u_{n}^{\prime},\quad u_{n-1}^{\prime\prime},\quad u_{n-1}^{\prime},\quad u_{n+1}
\]

\end_inset

其他均视为已知量，求解此方程组
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
ans = Simplify@First@First@Solve[{ Subscript[u1, np1] == 
\backslash
[Gamma]/(
\backslash
[Beta] 
\backslash
[CapitalDelta]t) (Subscript[u, np1] - Subscript[u, n]) + (1 - 
\backslash
[Gamma]/
\backslash
[Beta]) Subscript[ u1, n] + (1 - 
\backslash
[Gamma]/( 2 
\backslash
[Beta])) 
\backslash
[CapitalDelta]t Subscript[u2, n], Subscript[u2, np1] == 1/(
\backslash
[Beta] 
\backslash
[CapitalDelta]t^2) (Subscript[u, np1] - Subscript[ u, n]) - 1/(
\backslash
[Beta] 
\backslash
[CapitalDelta]t) Subscript[u1, n] + (1 - 1/(2 
\backslash
[Beta])) Subscript[u2, n], Subscript[u1, n] == 
\backslash
[Gamma]/(
\backslash
[Beta] 
\backslash
[CapitalDelta]t) (Subscript[u, n] - Subscript[u, nm1]) + (1 - 
\backslash
[Gamma]/
\backslash
[Beta]) Subscript[u1, nm1] + (1 - 
\backslash
[Gamma]/(2 
\backslash
[Beta])) 
\backslash
[CapitalDelta]t Subscript[ u2, nm1], Subscript[u2, n] == 1/(
\backslash
[Beta] 
\backslash
[CapitalDelta]t^2) (Subscript[u, n] - Subscript[u, nm1]) - 1/(
\backslash
[Beta] 
\backslash
[CapitalDelta]t) Subscript[u1, nm1] + (1 - 1/(2 
\backslash
[Beta])) Subscript[u2, nm1], T*Subscript[u2, np1] + Subscript[T, 
\backslash
[Sigma]]*Subscript[u1, np1] + S*Subscript[u, np1] == -Subscript[f, np1],
 T*Subscript[u2, n] + Subscript[T, 
\backslash
[Sigma]]*Subscript[u1, n] + S*Subscript[u, n] == -Subscript[f, n], T*Subscript[u
2, nm1] + Subscript[T, 
\backslash
[Sigma]]*Subscript[u1, nm1] + S*Subscript[u, nm1] == -Subscript[f, nm1]
 }, {Subscript[u, np1], Subscript[u1, np1], Subscript[u2, np1], Subscript[u1,
 n], Subscript[u2, n], Subscript[u1, nm1], Subscript[u2, nm1]} ]
\end_layout

\end_inset

，可以验证
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
ans2 = (Numerator@Last@ans)/(2 
\backslash
[CapitalDelta]t^2); ansB = (2/
\backslash
[CapitalDelta]t^2 T - (1 - 2 
\backslash
[Gamma])/
\backslash
[CapitalDelta]t Subscript[ T, 
\backslash
[Sigma]] - (1/2 + 
\backslash
[Gamma] - 2 
\backslash
[Beta]) S) Subscript[u, n] - (1/
\backslash
[CapitalDelta]t^2 T - (1 - 
\backslash
[Gamma])/
\backslash
[CapitalDelta]t 
\backslash
 Subscript[T, 
\backslash
[Sigma]] + (1/2 - 
\backslash
[Gamma] + 
\backslash
[Beta]) S) Subscript[u, nm1] - (
\backslash
[Beta]*Subscript[f, np1] + (1/2 + 
\backslash
[Gamma] - 2 
\backslash
[Beta]) Subscript[f, n] + (1/2 - 
\backslash
[Gamma] + 
\backslash
[Beta]) Subscript[f, nm1]); Simplify[ans2 - ansB]
\end_layout

\end_inset

，
\begin_inset Formula $u_{n+1}$
\end_inset

的表达式就是
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.32"
plural "false"
caps "false"
noprefix "false"

\end_inset

。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Exercise
类似地，对于形如
\begin_inset Formula 
\[
[T]\{u_{n}^{\prime}\}+[S]\{u_{n}\}+\{f_{n}\}=\{0\}.
\]

\end_inset

的方程，同样使用上面的
\begin_inset Formula $7$
\end_inset

阶方程组，得到
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
ans = Simplify@First@First@Solve[{ Subscript[u1, np1] == 
\backslash
[Gamma]/(
\backslash
[Beta] 
\backslash
[CapitalDelta]t) (Subscript[u, np1] - Subscript[u, n]) + (1 - 
\backslash
[Gamma]/
\backslash
[Beta]) Subscript[ u1, n] + (1 - 
\backslash
[Gamma]/( 2 
\backslash
[Beta])) 
\backslash
[CapitalDelta]t Subscript[u2, n], Subscript[u2, np1] == 1/(
\backslash
[Beta] 
\backslash
[CapitalDelta]t^2) (Subscript[u, np1] - Subscript[ u, n]) - 1/(
\backslash
[Beta] 
\backslash
[CapitalDelta]t) Subscript[u1, n] + (1 - 1/(2 
\backslash
[Beta])) Subscript[u2, n], Subscript[u1, n] == 
\backslash
[Gamma]/(
\backslash
[Beta] 
\backslash
[CapitalDelta]t) (Subscript[u, n] - Subscript[u, nm1]) + (1 - 
\backslash
[Gamma]/
\backslash
[Beta]) Subscript[u1, nm1] + (1 - 
\backslash
[Gamma]/(2 
\backslash
[Beta])) 
\backslash
[CapitalDelta]t Subscript[ u2, nm1], Subscript[u2, n] == 1/(
\backslash
[Beta] 
\backslash
[CapitalDelta]t^2) (Subscript[u, n] - Subscript[u, nm1]) - 1/(
\backslash
[Beta] 
\backslash
[CapitalDelta]t) Subscript[u1, nm1] + (1 - 1/(2 
\backslash
[Beta])) Subscript[u2, nm1], T*Subscript[u1, np1] + S*Subscript[u, np1]
 == -Subscript[f, np1], T*Subscript[u1, n] + S*Subscript[u, n] == -Subscript[f,
 n], T*Subscript[u1, nm1] + S*Subscript[u, nm1] == -Subscript[f, nm1] },
 {Subscript[u, np1], Subscript[u1, np1], Subscript[u2, np1], Subscript[u1,
 n], Subscript[u2, n], Subscript[u1, nm1], Subscript[u2, nm1]} ]
\end_layout

\end_inset


\begin_inset Formula 
\begin{align*}
\left\{ \frac{\gamma}{\Delta t}[T]+\beta[S]\right\} u_{n+1}= & \left\{ \frac{(2\gamma-1)}{\Delta t}[T]-(\frac{1}{2}+\gamma-2\beta)[S]\right\} u_{n}\\
 & +\left\{ \frac{1-\gamma}{\Delta t}[T]-(\frac{1}{2}-\gamma+\beta)[S]\right\} u_{n-1}\\
 & -\left[\beta f_{n+1}+(\frac{1}{2}+\gamma-2\beta)f_{n}+(\frac{1}{2}-\gamma+\beta)f_{n-1}\right]
\end{align*}

\end_inset

可以验证
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
ans2 = (Numerator@Last@ans)/(2 
\backslash
[CapitalDelta]t); ansB = ((2 
\backslash
[Gamma] - 1)/
\backslash
[CapitalDelta]t T - (1/2 + 
\backslash
[Gamma] - 2 
\backslash
[Beta]) S) Subscript[u, n] + ((1 - 
\backslash
[Gamma])/
\backslash
[CapitalDelta]t T - (1/ 2 - 
\backslash
[Gamma] + 
\backslash
[Beta]) S) Subscript[u, nm1] - (
\backslash
[Beta]*Subscript[f, np1] + (1/2 + 
\backslash
[Gamma] - 2 
\backslash
[Beta]) Subscript[f, n] + (1/2 - 
\backslash
[Gamma] + 
\backslash
[Beta]) Subscript[f, nm1]); Simplify[ans2 - ansB]
\end_layout

\end_inset

，此结果等于令
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:12.32"
plural "false"
caps "false"
noprefix "false"

\end_inset

中的
\begin_inset Formula $[T]$
\end_inset

矩阵为零。
\end_layout

\begin_layout Chapter
附录A：矢量恒等式和积分定理
\end_layout

\begin_layout Standard
page 304.
\end_layout

\begin_layout Section
矢量恒等式
\end_layout

\begin_layout Enumerate
混合积的轮换不变性：
\begin_inset Formula 
\begin{equation}
\sbf a\cdot(\sbf b\times\sbf c)=\sbf b\cdot(\sbf c\times\sbf a)=\sbf c\cdot(\sbf a\times\sbf b)\label{eq:jA.1}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
积分定理
\end_layout

\begin_layout Standard
下面用 
\begin_inset Formula $\sbf n$
\end_inset

 表示
\begin_inset Formula $S$
\end_inset

的单位法向矢量，
\begin_inset Formula $S$
\end_inset

可以是封闭曲面或未封闭面。在后一种情形下，
\begin_inset Formula $\hat{\sbf l}\dd{\ell}$
\end_inset

表示与
\begin_inset Formula $S$
\end_inset

面和包围
\begin_inset Formula $S$
\end_inset

面的轮廓
\begin_inset Formula $C$
\end_inset

都相切的线元。
\end_layout

\begin_layout Enumerate
梯度定理：
\begin_inset Formula 
\begin{equation}
\int_{V}\dd{V}\nabla\phi=\oint_{S}\dd{\sbf S}\phi\label{eq:jA.13}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate
散度定理（高斯定理）：
\begin_inset Formula 
\begin{equation}
\int_{V}\dd{V}\nabla\cdot\sbf A=\oint_{S}\dd{\sbf S}\cdot\sbf A\label{eq:jA.14}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate
旋度定理：
\begin_inset Formula 
\begin{equation}
\int_{V}\dd{V}\nabla\times\sbf A=\oint_{S}\dd{\sbf S}\times\sbf A\label{eq:jA.15}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate
叉乘–梯度定理：
\begin_inset Formula 
\begin{equation}
\int_{S}\dd{\sbf S}\times\nabla\phi=\oint_{C}\dd{\ell}\hat{\sbf l}\,\phi\label{eq:jA.16}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate
斯托克斯（stokes）定理：
\begin_inset Formula 
\begin{equation}
\int_{S}\dd{\sbf S}\cdot\nabla\times\sbf A=\oint_{C}\dd{\ell}\hat{\sbf l}\cdot\sbf A\label{eq:jA.17}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate
叉乘–nabla–叉乘定理：
\begin_inset Formula 
\begin{equation}
\int_{S}\dd{\sbf S}\times\nabla\times\sbf A=\oint_{C}\dd{\ell}\hat{\sbf l}\times\sbf A\label{eq:jA.18}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate
第一标量格林定理
\begin_inset Formula 
\begin{equation}
\int_{V}\left[a\nabla\cdot{\color{blue}(u\nabla b)}+u(\nabla a)\cdot(\nabla b)\right]\dd{V}=\oint_{S}a{\color{blue}u\frac{\partial b}{\partial n}}\dd{S}\label{eq:jA.19}
\end{equation}

\end_inset


\begin_inset Formula $u=1$
\end_inset

的简化形式为：
\begin_inset Formula 
\begin{equation}
\int_{V}\left[a{\color{blue}(\nabla^{2}b)}+(\nabla a)\cdot(\nabla b)\right]\dd{V}=\oint_{S}a{\color{blue}\frac{\partial b}{\partial n}}\dd{S}\label{eq:jA.19b}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate
第二标量格林定理：
\begin_inset Formula 
\begin{equation}
\int_{V}\left[a\nabla\cdot{\color{blue}(u\nabla b)}-b\nabla\cdot{\color{brown}(u\nabla a)}\right]\dd{V}=\oint_{S}u({\color{blue}a\frac{\partial b}{\partial n}}{\color{brown}-b\frac{\partial a}{\partial n}})\dd{S}\label{eq:jA.20}
\end{equation}

\end_inset


\begin_inset Formula $u=1$
\end_inset

的简化形式为：
\begin_inset Formula 
\begin{equation}
\int_{V}\left[a{\color{blue}(\nabla^{2}b)}-b{\color{brown}(\nabla^{2}a)}\right]\dd{V}=\oint_{S}({\color{blue}a\frac{\partial b}{\partial n}}{\color{brown}-b\frac{\partial a}{\partial n}})\dd{S}\label{eq:jA.20b}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate
第一矢量格林定理：
\begin_inset Formula 
\begin{equation}
\int_{V}\left[u{\color{blue}(\nabla\times\sbf a)}\cdot{\color{brown}(\nabla\times\sbf b)}-{\color{blue}\sbf a}\cdot(\nabla\times{\color{brown}u\nabla\times\sbf b})\right]\dd{V}=\oint_{S}\,u({\color{blue}\sbf a}\times{\color{brown}\nabla\times\sbf b})\cdot\sbf n\dd{S}\label{eq:jA.21}
\end{equation}

\end_inset


\begin_inset Formula $u=1$
\end_inset

的简化形式为：
\begin_inset Formula 
\begin{equation}
\int_{V}\left[{\color{blue}(\nabla\times\sbf a)}\cdot{\color{brown}(\nabla\times\sbf b)}-{\color{blue}\sbf a}\cdot(\nabla\times{\color{brown}\nabla\times\sbf b})\right]\dd{V}=\oint_{S}\,({\color{blue}\sbf a}\times{\color{brown}\nabla\times\sbf b})\cdot\sbf n\dd{S}\label{eq:jA.21b}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate
第二矢量格林定理：
\begin_inset Formula 
\begin{equation}
\int_{V}\left[\sbf b\cdot(\nabla\times u{\color{blue}\nabla\times\sbf a})-\sbf a\cdot(\nabla\times u{\color{brown}\nabla\times\sbf b})\right]\dd{V}=\oint_{S}\,u(\sbf a\times{\color{brown}\nabla\times\sbf b}-\sbf b\times{\color{blue}\nabla\times\sbf a})\cdot\sbf n\dd{S}\label{eq:jA.22}
\end{equation}

\end_inset


\begin_inset Formula $u=1$
\end_inset

的简化形式为：
\begin_inset Formula 
\begin{equation}
\int_{V}\left[\sbf b\cdot(\nabla\times{\color{blue}\nabla\times\sbf a})-\sbf a\cdot(\nabla\times{\color{brown}\nabla\times\sbf b})\right]\dd{V}=\oint_{S}\,(\sbf a\times{\color{brown}\nabla\times\sbf b}-\sbf b\times{\color{blue}\nabla\times\sbf a})\cdot\sbf n\dd{S}\label{eq:jA.22b}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
EOF
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "ref61"
literal "true"

\end_inset

xx
\end_layout

\end_body
\end_document
