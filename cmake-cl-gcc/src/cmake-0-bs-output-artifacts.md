# cmake build system 基本概念

[cmake-buildsystem](https://cmake.org/cmake/help/latest/manual/cmake-buildsystem.7.html)

## Output Artifacts, 输出工件

`add_library()` 和 `add_executable()` 命令创建的 构建系统targets, 会创建 制作二进制输出 的规则.
二进制文件的确切输出位置只能在生成时确定, 因为它可能取决于 编译配置 和 链接依赖项 的 link-language 等.
`TARGET_FILE`, `TARGET_LINKER_FILE` 和相关表达式可用于访问 生成的二进制文件的名称和位置.
不过, 这些表达式不适用于 OBJECT 库,
as there is no single file generated by such libraries which is relevant to the expressions.

targets 可生成三种 输出工件(output artifacts), 详见以下章节.
它们的分类在 DLL 平台和非 DLL 平台上有所不同.
包括 Cygwin 在内的所有基于 Windows 的系统都是 DLL 平台.

### Runtime Output Artifacts, 运行时输出工件

buildsystem target 的 *runtime* output artifact 可以是

+ 通过 add_executable() 命令创建的可执行目标的可执行文件(如 `.exe`).
+ 在 DLL 平台上: 通过带有 SHARED 选项的 add_library()命令创建的共享库目标的可执行文件(如 `.dll`).

`RUNTIME_OUTPUT_DIRECTORY` 和 `RUNTIME_OUTPUT_NAME` 目标属性可用于控制构建树中的运行时输出工件位置和名称.

### Library Output Artifacts, 库输出工件

buildsystem target 的 *library* output artifact 可以是

+ 由带有 `MODULE` 选项的 `add_library()` 命令创建的 module library target 的
loadable module file(如 `.dll` 或 `.so`).
+ 在非 DLL 平台上: 由带有 `SHARED` 选项的 `add_library()` 命令创建的共享库目标的共享库文件
(例如 `.so` 或 `.dylib`).

`LIBRARY_OUTPUT_DIRECTORY` 和 `LIBRARY_OUTPUT_NAME` 目标属性可用于控制构建树中库输出工件的位置和名称.

### Archive Output Artifacts, 归档输出工件

构建系统目标的归档输出工件可以是

+ 由带有 `STATIC` 选项的 `add_library()` 命令创建的静态库目标的静态库文件(如 `.lib` 或 `.a`).

+ 在 DLL 平台上: 使用带有 `SHARED` 选项的 `add_library()`命令创建的 shared library target 的
import library file(例如 `.lib`). 只有当库至少导出一个unmanaged symbol, 才能保证存在该文件.
+ 在 DLL 平台上: `add_executable()` 命令创建的  executable target 的导入库文件(如 `.lib`),
前提是设置了其 `ENABLE_EXPORTS` 目标属性.

+ 在 `AIX` 上: `add_executable()` 命令创建的可执行目标的链接器导入文件(如 .imp),
当其 `ENABLE_EXPORTS` 目标属性被设置时.

+ 在 macOS 上: 使用带有 SHARED 选项的 add_library()命令创建的共享库目标文件的链接器导入文件(如 `.tbd`),
且其 `ENABLE_EXPORTS` 目标属性已设置.

`ARCHIVE_OUTPUT_DIRECTORY` 和 `ARCHIVE_OUTPUT_NAME` 目标属性可用于控制编译树中归档输出工件的位置和名称.