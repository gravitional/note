# c++ 声明与定义

[C++ 找到一个或多个重定义符号(头文件 重定义问题)](https://zhuanlan.zhihu.com/p/141833130)

情况一: 多个源文件包含了同一个头文件时,
如果头文件中有某个局部变量或者非内联函数的定义,
那么相当于每个源文件都把该局部变量或者非内联函数定义了一次.
而它们(局部变量或者非内联函数)在这种情况下默认又是全局的, 那么自然会导致重定义错误.

情况二: 某个源文件多次包含同一个头文件时,
如果头文件中有定义语句, 那么不管是什么东西的定义, 都会产生重定义错误.

针对情况一: 我们应当避免在头文件中定义 `局部变量` 或者 `非内联函数`.
而由于编译器会将 `类`, `内联函数` 以及 `const变量` 默认视为定义它们的源文件所私有,
因此 它们(类, 内联函数以及const变量)可以定义在头文件中.

解决方法:

1. 把实现放到cpp文件中去.
1. 内联添加inline关键字
1. 如果是变量的话, 可以在头文件使用extern int XXX,然后在某个cpp中不加extern定义.

针对情况二: 我们可以在头文件中使用一种叫做头文件保护符的东西, 格式如下:

```cpp
#ifndef A_H
#define A_H
/* 这里写真正的头文件 */
#endif

但是我更喜欢在每个头文件顶部增加(clang VC 下可用):

```cpp
#pragma once
```
