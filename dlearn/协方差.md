# 协方差的计算（离散与连续例子）

好的，我们先回顾协方差的定义，再分别用离散和连续的例子一步步算给你看。  

---

### 1. 协方差的定义  

两个随机变量 \(X, Y\) 的协方差定义为  
\[
\mathrm{Cov}(X,Y)=\mathbb{E}\!\left[(X-\mu_X)(Y-\mu_Y)\right]
\]  
其中  
- \(\mu_X=\mathbb{E}[X]\)，\(\mu_Y=\mathbb{E}[Y]\) 是各自的期望。  
等价地可以写成  
\[
\mathrm{Cov}(X,Y)=\mathbb{E}[XY]-\mathbb{E}[X]\,\mathbb{E}[Y]
\]  
这个“先算乘积的期望再减去期望的乘积”的公式在离散和连续情形都适用，下面两个例子都用它。

---

### 2. 离散型例子：掷骰子得分的协方差  

**问题描述**  
同时掷两颗公平骰子，记  
- \(X\)：第一颗骰子的点数；  
- \(Y\)：两颗骰子点数之和。  

求 \(\mathrm{Cov}(X,Y)\)。

**步骤 1：列出联合分布**  
共有 \(6\times6=36\) 种等可能结果。对每个 \((x,y)\) 组合，出现概率都是 \(\frac{1}{36}\)。  
计算 \(\mathbb{E}[X]\)、\(\mathbb{E}[Y]\)、\(\mathbb{E}[XY]\)：

- \(\displaystyle \mathbb{E}[X]=\sum_{x=1}^{6}x\cdot\frac{6}{36}=\frac{1+2+3+4+5+6}{6}=3.5\)  
- \(\displaystyle \mathbb{E}[Y]=\sum_{y=2}^{12}y\cdot P(Y=y)=\frac{1}{36}\sum_{y=2}^{12}y\cdot(\text{出现}y\text{的组合数})  
\quad=\frac{1}{36}(2\cdot1+3\cdot2+\dots+12\cdot1)=\frac{252}{36}=7\)  

- \(\displaystyle \mathbb{E}[XY]=\sum_{x=1}^{6}\sum_{y=x+1}^{x+6}x y\cdot\frac{1}{36}\)  
  把全部36种组合列出并求和即可，算得  
  \[
  \mathbb{E}[XY]=\frac{1}{36}\sum_{i=1}^{6}\sum_{j=1}^{6}i(i+j)=
  \frac{1}{36}\left[\sum_{i=1}^{6}\sum_{j=1}^{6}i^2+\sum_{i=1}^{6}\sum_{j=1}^{6}i j\right]=
  \frac{1}{36}\left[6\cdot91+21\cdot21\right]=
  \frac{546+441}{36}=27.4167
  \]

**步骤 2：代入公式**  
\[
\mathrm{Cov}(X,Y)=\mathbb{E}[XY]-\mathbb{E}[X]\mathbb{E}[Y]=27.4167-3.5\times7=2.9167
\]  
（精确值是 \(\frac{35}{12}\approx2.9167\)）

---

### 3. 连续型例子：二维均匀分布的协方差  

**问题描述**  
设 \((X,Y)\) 在单位正方形 \([0,1]\times[0,1]\) 上服从均匀分布，其联合密度  
\[
f_{X,Y}(x,y)=1,\qquad 0\le x\le1,\;0\le y\le1
\]  
求 \(\mathrm{Cov}(X,Y)\)。

**步骤 1：计算期望**  
- \(\displaystyle \mathbb{E}[X]=\int_0^1\!\!\int_0^1 x\,f(x,y)\,dy\,dx=\int_0^1 x\,dx=\frac12\)  
- 同理 \(\displaystyle \mathbb{E}[Y]=\frac12\)  

- \(\displaystyle \mathbb{E}[XY]=\int_0^1\!\!\int_0^1 xy\,f(x,y)\,dy\,dx
=\int_0^1 x\,dx\int_0^1 y\,dy=\frac12\cdot\frac12=\frac14\)  

**步骤 2：代入公式**  
\[
\mathrm{Cov}(X,Y)=\frac14-\Bigl(\frac12\Bigr)\Bigl(\frac12\Bigr)=0
\]  
直观上，\(X\) 与 \(Y\) 独立，自然协方差为 0。

---

### 4. 小结  

- **离散**：把求和符号 \(\sum\) 用到底。  
- **连续**：把积分符号 \(\int\) 用到底。  
核心公式永远是  
\[
\boxed{\mathrm{Cov}(X,Y)=\mathbb{E}[XY]-\mathbb{E}[X]\,\mathbb{E}[Y]}
\]