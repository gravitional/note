# learn.vim.md

For myself and for you

## 前言

介于notepad++ 作者, 某 “donho” 同志发表的一些XX言论,
[jianshu][]  and  [notepad++][]
又给了我一个学习Vim的理由, 所以准备做一个比较系统的(也许吧)学习笔记, 随缘更新.

`vim` 的大部分命令是英文缩写, 记住英文单词应该可以帮助记忆, 不过主要肯定是多用了, 形成肌肉记忆.

此笔记搬运了：  [Vim 实操教程][]  and [vim作者写的教程][]

比较好的教程：
[vim作者写的教程][]
[简明Vim练级攻略][]
[每日一Vim][]
[vim教程网][]

[jianshu]: https://www.jianshu.com/p/1adced676d79
[notepad++]: https://github.com/notepad-plus-plus/notepad-plus-plus
[Vim 实操教程]: https://github.com/dofy/learn-vim

[vim作者写的教程]: http://vimcdoc.sourceforge.net/doc/usr_toc.html
[简明Vim练级攻略]: https://coolshell.cn/articles/5426.html
[每日一Vim]: https://liuzhijun.iteye.com/category/270228
[vim教程网]: https://vimjc.com/

## 配置

进行必要的配置, 可以保护视力, 更容易学习. 😄

vim有两种运行方式(我只知道两种)：附送的 `gui`程序`gVim` 或者 各种命令行/shell 里的`vim`.
可以直接在`gVim`或者`vim`用命令进行配置, 不过直接改配置文件, 一劳永逸, 应该更开心一些.

vim的配置文件, 路径一般是`~/.vimrc`, windows 下就是 `C:\Users\Your-Name\.vimrc`.
不同操作系统具体位置应该不太一样, 可以自行搜索一下.

另外, `gui` 环境下的 `gVim`还有一个配置文件`defaults.vim`在
`C:\Program Files (x86)\Vim\vim81\defaults.vim`
类似的路径下, 它主要是对 `gVim`的外观有影响,
配置可以直接从`.vimrc`粘贴**附在原有的配置后面**, 我测试的结果是可以正常使用.

以上两个路径, 由于操作系统, 安装位置不同, 具体路径应该有点小差别, 大家自行琢磨或者搜索.

以下是我的`.vimrc` 文件, 参考了很多网友的例子.

```vimrc
" 设置编码
set fileencodings=utf-8,ucs-bom,gb18030,gbk,gb2312,cp936
set termencoding=utf-8
set encoding=utf-8

" 默认字体
set guifont=Courier\ New:h20

" 窗口大小 位置
set lines=30 columns=90
winpos 300 0

" 显示行号和相对行号 etc
set number
set relativenumber

" highlight the search results
set hlsearch

" file type detection
filetype on

" 突出显示当前行
" set cursorline

" 突出显示当前列
" set cursorcolumn

" 显示括号匹配
set showmatch

" 设置缩进
" 设置Tab长度为4空格
set tabstop=4
" 设置自动缩进长度为4空格
set shiftwidth=4
" 继承前一行的缩进方式, 适用于多行注释
set autoindent
set smartindent

" tab convert to space
set expandtab

" 设置粘贴模式
set paste

" 显示空格和tab键
set listchars=tab:>-,trail:-

" 总是显示状态栏
set laststatus=2
" 显示光标当前位置
set ruler

" 代码补全
set completeopt=preview,menu

" 去掉输入错误的提示声音
set noeb

" 颜色方案
syntax on
" set background=dark
" colorscheme solarized
```

## 光标移动操作

大家可以去 github： [Vim 实操教程][] 下载教程文件, 实际操作学习, 很快的 \~\~

关于 vim 的三种模式：插入模式(Insert mode), 命令模式(Command mode)/或者叫普通模式 , 底线模式(Last line mode), 这里不做赘述, 大家自行搜索, 不必摸得十分透彻, 有这个概念就行了.

这里只是对 [Vim 实操教程][] 的内容做一些总结或者补充.

### 单位级

- `h` 向左一字符
- `j` 下一行
- `k` 上一行
- `l` 向右一字符

### 单词级

- `w` or `W` 向右移动到下一单词开头  `word`
- `e` or `E` 向右移动到单词结尾 `end`
- `b` or `B` 向左移动到单词开头 `back`

注意：
所有小写单词都是以分词符作为单词界限, 大写字母以空格作为界限_

正好是一个`w e b`, 多用 `w e b` 可以让你变快😅, 大概就是这样

并不是很懂啥是分词 [分词] []

[分词]: https://blog.csdn.net/qq_32458499/article/details/78949231

当文档很长时, 可能需要下面这些命令：

### 块级

- `gg` 到文档第一行 `gogo??`
- `G` 到文档最后一行 `goto??`
- `0` 到行首(第 1 列)
- `^` 到第一个非空白字符
- `$` 到行尾
- `Ctrl-d` 向下移动半页 `down`
- `Ctrl-u` 向上移动半页 `up`
- `Ctrl-f` 向下移动一页 `forward`
- `Ctrl-b` 向上移动一页 `back`
- `:<N>` or `<N>gg` or `<N>G`跳转到第 N 行
- `:+<N>` or `<N>j` 向下跳 N 行
- `:-<N>` or `<N>k` 向上跳 N 行

注意：

1. 所有**命令前**都可以加一个数字 **N**, 表示对后面的命令执行 **N** 次.
2. 例如你想向下移动 `3` 行, 除了可以用 `:+3`(这是底线模式的命令, 回车确认执行) 之外, 还可以用 `3j`(这是 命令模式 的命令) 来实现同样的效果.
3. 你可能希望, 光标所在行处于屏幕的中间. 这可以通过 `zz`命令实现
4. `<Esc>` 可以中止大部分命令

## 打开文件, 查找内容

### 在 Vim 中打开文件

- `:e <filename>` 打开名为 `filename` 的文件, 若文件不存在则创建之
- `:Ex` 在 Vim 中打开目录树, 光标选中后回车打开对应文件(提示：`-` 进入上级目录)

### 查找

如果在 vim 里遇到不确定的字符, 可以在那个字符上按 `ga`, 会显示那个字的 `ascii` 码.
包括：十进制, 八进制, 十六进制. 如果不是 `ascii` 字符, 就是 `unicode` 码.

[空字符][]

[空字符]: https://zhidao.baidu.com/question/490512756331303652.html

#### 文档内查找

- `*` 向后查找光标当前所在单词
- `#` 向前查找光标当前所在单词
- `/<search>` 向后查找指定字符串
- `?<search>` 向前查找指定字符串
- `n` 继续查找下一个 `next`
- `N` 继续查找上一个

注意：
`n` 和 `N` 是有方向性的,
若你之前通过 `*` 查找, 则 `n` 会继续向文档尾方向查找, `N`向文档首方向；
反之, 若你通过 `#` 查找, 则 `n` 指向文档首, `N` 指向文档尾
这个无需记忆, 用起来自然懂.

#### 行内查找

- `f<X>` 当前行内向行尾方向查找并定位到字符 `X` ,`find`
- `t<X>` 当前行内向行尾方向查找并定位到字符 `X` 之前 `tail? tell?`
- `F<X>` 当前行内向行首方向查找并定位到字符 `X`
- `T<X>` 当前行内向行首方向查找并定位到字符 `X` 之后
- `;` 继续向当前方向查找下一个字符
- `,` 向当前相反方向查找下一个字符

这个也可以帮助你在行内快速移动.

#### 匹配查找

Vim 中可以使用 `%` 对 `(` 和 `)`, `[` 和 `]`, `{` 和 `}` 进行匹配查找,
当光标位于其中一个符号上时, 按下 `%`, 光标会跳到与之匹配的另外一个符号上.

#### 缓冲区

buffer

[缓冲区][] 的介绍

你可以用 `:buffers` 或 `:ls` 命令查看 buffer/ 缓冲区列表, 大概是这个样子：

```bash
:ls
  1 #h   "file-one.md"                  line 47
  2 %a   "file-two.md"                  line 1
Press ENTER or type command to continue
```

你可以尝试通过以下命令在文件缓存中进行跳转

- `:bn` 打开缓存中下一个文件
- `:bp` 打开缓存中上一个文件
- `:b<N>` 打开缓存中第 N 个文件

你也可以使用 `:bdelete<N>` 来删除所要关闭的缓冲区, 缩写 `:bd<N>`.

[缓冲区]: https://github.com/wsdjeg/vim-galore-zh_cn#%E7%BC%93%E5%86%B2%E5%8C%BA%E7%AA%97%E5%8F%A3%E6%A0%87%E7%AD%BE

## 修改-常用操作

### 修改文档

以上操作都是在 Vim 的 `normal模式`/`命令模式` 下进行的.
现在, 是时候进入 Vim 的另外一种模式 —— `insert 模式`, 学习一下如何修改文件了.

### 一些具体的常用操作

#### 插入

- `i` 当前字符前插入 `insert`
- `a` 当前字符后插入 `after`
- `I` 行首插入
- `A` 行尾插入
- `o` 在下一行插入
- `O` 在上一行插入

注意：

以上任何一个命令都会使 Vim 进入 insert 模式, 进入该模式后光标会发生变化, 这时输入的
文字会直接出现在文档中, 按 `Esc` 键或 `Ctrl-[` 或 `Ctrl-C` 退出 `insert 模式`.

#### 删除(并保存到 Vim 剪贴板)

- `x` 删除当前字符, 相当于 insert 模式下的 `Delete` `就是熟悉的ctrl+x, execute？？`
- `X` 删除前一个字符, 相当于 insert 模式下的 `Backspace`
- `dd` 删除当前行, 并将删除的内容保存到 Vim 剪贴板
- `d<X>` 删除指定内容并保存到 Vim 剪贴板
- `c<X>` 删除指定内容并保存到 Vim 剪贴板, 同时进入 insert 模式

说明：

`<X>` 部分是对操作内容的描述,
如果要删除一个单词, 就输入 `dw` 或者 `de`,
要复制当前位置到行尾的内容, 就输入 `y$`,
要删除后面 3 个字符并插入, 就输入 `c3l` (`copy 3 left`)诸如此类.

#### 复制

- `yy` 复制当前行到  Vim 剪贴板, `yanking`(抽出)
- `y<X>` 复制指定内容到 Vim 剪贴板

#### 粘贴

- `p` 在当前位置后粘贴, `paste`
- `P`(大写) 在当前位置前粘贴

#### 合并

- `J` 将当前行与下一行合并, 即删除换行符, `Join`

#### 替换

[vim 查找替换](https://www.cnblogs.com/ltang/articles/2034291.html)

- `r<X>` 将当前字符替换为 X, `replace`
- `gu<X>` 将指定的文本转换为小写, `这个实在不知道是啥的缩写,get u ？？`
- `gU<X>` 将指定的文本转换为大写
- `:%s/<search>/<replace>/` 查找 `search` 内容并替换为 `replace` 内容,

还有个更好玩的命令 `g~<X>`, 大小写互换.
例如 `0g~$` 将一行内的所有字母 大写变小写, 小写变大写.

***

`vi/vim` 中可以使用 `:s` 命令来替换字符串

`:s/vivian/sky/` 替换当前行第一个 `vivian` 为 `sky`
`:s/vivian/sky/g` 替换当前行所有 `vivian` 为 `sky`
`:n,$s/vivian/sky/` 替换第 `n` 行开始到最后一行中每一行的第一个 `vivian` 为 `sky`
`:n,$s/vivian/sky/g` 替换第 n 行开始到最后一行中每一行所有 `vivian` 为 `sky`
`n` 为数字, 若 `n` 为 `.`, 表示从当前行开始到最后一行
`:%s/vivian/sky/`(等同于` :g/vivian/s//sky/`) 替换每一行的第一个 `vivian` 为 `sky`
`:%s/vivian/sky/g`(等同于 `:g/vivian/s//sky/g`) 替换每一行中所有 `vivian` 为 `sky`

***
可以使用 `#` 作为分隔符, 此时中间出现的 `/` 不会作为分隔符
`:s#vivian/#sky/#` 替换当前行第一个 `vivian/` 为 `sky/`
`:%s+/oradata/apras/+/user01/apras1+ `(使用`+`来替换`/` )：` /oradata/apras/`替换成`/user01/apras1/`

***
`:s/vivian/sky/ `替换当前行第一个 `vivian` 为 `sky`
`:s/vivian/sky/g` 替换当前行所有 `vivian` 为 `sky`

***

`:n,$s/vivian/sky/` 替换第 `n` 行开始到最后一行中每一行的第一个 `vivian` 为 `sky`
`:n,$s/vivian/sky/g` 替换第 `n` 行开始到最后一行中每一行所有 `vivian` 为 `sky`

(`n` 为数字, 若 `n` 为 `.`, 表示从当前行开始到最后一行)

***
`:%s/vivian/sky/`(等同于 `:g/vivian/s//sky/`) 替换每一行的第一个 `vivian` 为 `sky`
`:%s/vivian/sky/g`(等同于 `:g/vivian/s//sky/g`) 替换每一行中所有 `vivian` 为 `sky`

***

可以使用 `#` 作为分隔符, 此时中间出现的 `/` 不会作为分隔符

`:s#vivian/#sky/#` 替换当前行第一个 `vivian/` 为 `sky/`

***

删除文本中的`^M`

问题描述：对于换行,window下用回车换行(`0A0D`)来表示, Linux下是回车(`0A`)来表示.
这样, 将window上的文件拷到Unix上用时, 总会有个`^M`.
请写个用在unix下的过滤windows文件的换行符(`0D`)的shell或c程序.

+ 使用命令：`cat filename1 | tr -d “^V^M” > newfile`；
+ 使用命令：`sed -e “s/^V^M//” filename > outputfilename`.

需要注意的是在1, 2两种方法中, `^V`和`^M`指的是`Ctrl+V`和`Ctrl+M`. 你必须要手工进行输入, 而不是粘贴.

在`vi`中处理：首先使用`vi`打开文件, 然后按`ESC`键, 接着输入命令：`%s/^V^M//`.

`:%s/^M$//g`

如果上述方法无用, 则正确的解决办法是：

```bash
tr -d "\r" < src >dest
tr -d "\015" dest
strings A>B
```

***

从上述替换命令可以看到：`g` 放在命令末尾, 表示对搜索字符串的每次出现进行替换；不加 `g`, 表示只对搜索字符串的首次出现进行替换；
`g` 放在命令开头, 表示对正文中所有包含搜索字符串的行进行替换操作.

#### 撤销, 重做

- `u` 撤销 `undo`
- `Ctrl-r` 重做 `redo`

#### 保存文件

- `:w` 保存当前文件 `write`
- `:wa` 保存全部文件 `write all`
- `:wq` or `ZZ` 保存并退出 `write and quit` `ZZ睡辽`
- `:q!` or `ZQ` 强制退出, 不保存 `quit!`
- `:saveas <new filename>` 文件另存为
- `:w <new filename>` 文件另存一份名为 `<new filename>` 的副本并继续编辑原文件

## 修改---三种模式

实际上, `vim` 有三种修改文本的基本方法:

1. 操作符-动作,
2. 可视模式
3. 文本对象.

Don't care what they are called

### 操作符-动作

`dw` 命令删除一个单词. 你可能认出来了, `w` 是词移动命令. 实际上, `d` 命令
后面可以跟任何 `动作` (motion) 命令, 它会删除从当前位置到光标移动到的目标位置
的全部内容.

是否包括光标所在的字符取决于你使用的移动命令. 在参考手册中, 当不包括这个字符
时, 称为 **非包含的** (exclusive), 而包括这个字符时, 称为 **包含的** (inclusive).
`$` 命令移动到行尾. 所以, `d$` 命令从当前的位置一直删除到本行行尾. 这是一个
**包含的** 命令, 所以, 这行的最后一个字符也会被删除:

以上定义了一个命令组合模式: `操作符－动作`. 你首先输入一个操作符命令, 例如, `d`
就是一个删除操作符. 然后你输入一个动作命令, 例如 `4l` 或者 `w`. 这种方法使你可
以在任何你能越过的文本上执行各种操作

更详细可参见 [vimdoc](http://vimcdoc.sourceforge.net/doc/usr_04.html#usr_04.txt)

#### 修改文本--`c`

另一个操作符命令是 `c`, 表示修改, `change`.
它的作用方式与 `d` 操作符相似, 只是完成后会切换到插入模式.
例如, `cw` 修改一个词, 更精确的说, 它删除一个词, 并切换到插入模式.

`c` 操作符在很多地方都和 `d` 一样, 但有一个例外, `cw`. 它实际上像 `ce` 一样, 删除到单词
尾. 这样单词后面的空格就不包括在内了. 这要追溯到使用 `Vi` 的旧日子. 由于很多人已
经习惯了这种方式, 这个不一致之处就留在 `Vim` 里了.

#### 更多的修改命令

像`dd` 可以删除一行一样, `cc` 修改一整行. 但它会保留这一行的缩进 (前导空格).

`d$` 删除到行尾；`c$` 则修改到行尾.
这相当于先用 `d$` 删除一行再用 `a` 启动插入模式, 以便加入新的文字.

### 快捷键

有些 "操作符－动作" 命令由于经常被使用, 所以被设置为单字符命令:

- `x`  表示  `dl`  (删除当前光标下的字符)
- `X`  表示  `dh`  (删除光标左边的字符)
- `D`  表示  `d$`  (删除到行尾)
- `C`  表示  `c$`  (修改到行尾)
- `s`  表示  `cl`  (修改一个字符)
- `S`  表示  `cc`  (修改一整行)

#### 计数前缀的位置

命令

- `3dw`：表示删除一个单词 3 次
- `d3w`：删除一个单词 3 次

实际上你可以放两个计数前缀, 例如,

- `3d2w` 删除两个单词三次, 共计六个单词.

#### 替换单个字符

`r` 命令不是操作符. 它只是等你输入一个字符然后用这个字符替换当前光标上的字符.
`r` 命令不需要使用 `<Esc>` 退出插入状态:

要用换行符替换一个字符可以用命令 `r<Enter>`. 这会删除一个字符并插入一个换行
符. 在这里使用计数前缀会删除多个字符但只插入一个换行符: `4r<Enter>` 用一个换行
符替换四个字符.

### 可视模式

不是说好只有三种模式的吗？？怎么又多一种？😅, 但罗老师说过,

> ***又不是不能用***

好用, 不就行了. 😎

#### 行内模式

要删除一些简单的东西, 用 `操作符－动作` 命令可以完成得很好. 但很多情况下, 并不容易确定用什么命令可以移到你想修改的地方. 这时候, 你就需要可视模式了.

你可以用 `v` 命令启动可视模式.
你可以移动光标到需要的地方,中间的文本会被高亮显示. 最后执行一下 "操作符" 命令即可.

如果任何时候你改了主意, 只用按一下 `<Esc>` 就能退出可视模式.

#### 多行模式

如果你想对整行做操作, 可以使用 `V` (大写)命令来启动可视模式.
你会发现在你作任何移动之前, 整行都被高亮显示了. 左右移动不会有任何效果. 而通过上下移动, 你可以一次选择多行.

#### 矩形选择

如果你要处理一个矩形块内的文本, 可以使用 `CTRL-V` 启动可视模式. 这在处理表格时非
常有用.

如果你在可视模式下选中了一些文字, 然后你又发现你需要改变被选择的文字的另一端,
用 `o` (小写)命令即可 ( `other end`), 光标会移动到被选中文字的另一端, 现
在你可以移动光标去改变选中文字的开始点了. 再按 `o` 光标还会回到另一端.

当使用列块可视模式的时候, 你会有四个角, `o` 只是把你移到对角上.
而用 `O` (大写)则能移到同一行的另一个角上.

注意：:

`o` 和 `O` 在**可视模式**下与在**普通模式**下的作用有很大的不同；
在普通模式下, 它们的作用是在光标后或前加入新的一行.

### 文本对象

使用文本对象是 `Vim` 中执行修改的第三种方法. 这种方法与 `操作符-动作` 很相似, 但它不是操作于从当前位置到移动目标间的内容, 而是对光标所在位置的 `文本对象` 进行操作. 文本对象是作为一个整体来处理的. 现在光标在对象中的位置无关紧要.

#### daw-and-cis

比如你在一个单词的中间而又想删掉这个单词, 在你用 `dw` 前, 你必须先移到这个单词
的开始处. 这里还有一个更简单的方法: `daw`.

`daw` 的 `d` 是删除操作符. `aw` 是一个文本对象(`A Word`). 这样, `daw` 就是 `Delete A Word` (删除一个单词). 确切地说, 该单词后的空格字符也被删除掉了.

用 `cis` 可以改变一个句子.

`cis` 包括 `c` (change, 修改) 操作符和 `is` 文本对象(`Inner Sentence`, 内含句子).
还有一个文本对象是 `as`, 区别是 `as` 包括句子后面的空白字符而 `is`不包括.
如果你要删除一个句子和句子后面空白字符, 就用 `das`

#### 扩选

你还可以在可视模式下使用文本对象. 这样会选中一个文本对象, 而且继续留在可视模
式, 你可以继续多次执行文本对象命令.
例如, 先用 `v` 启动可视模式, 再用 `as` 选中一个句子. 重复执行 `as`, 就会继续选中更多的句子. 最后你可以使用一个操作符去处理这些被选中的句子.

### 替换模式

`R` 命令启动替换模式. 在这个模式下, 你输入的每个字符都会覆盖当前光标上的字符.
这会一直持续下去, 直到你输入 `<Esc>`.

你可以通过 `<Insert>` 在插入模式和替换模式间切换.

但当你使用 `<BS>` (退格键) 进行修正时, 你会发现原来被替换的字符又回来了. 这就好
像一个 "撤销" 命令一样.

### 结论

操作符, 移动命令和文本对象可以有各种组合. 现在你已经知道它是怎么工作了, 你可以
用 N 个操作符加上 M 个移动命令, 组合出 N*M 个命令！

还有很多方法可以删除文本. 这是一些经常用到的:

- `x`   : 删除光标下的字符 ("dl" 的缩写)
- `X`   : 删除光标前的字符 ("dh" 的缩写)
- `D`   : 从当前位置删除到行尾 ("d$" 的缩写)
- `dw`  : 从当前位置删除到下一个单词开头
- `db`  : 从当前位置删除到前一个单词的开头
- `diw` : 删除光标上的单词 (不包括空白字符)
- `daw` : 删除光标上的单词 (包括空白字符)
- `dG`  : 删除到文件末
- `dgg` : 删除到文件首

如果你用 `c` 代替 `d`, 这会变成修改命令；而改用 `y`, 则变成拷贝命令, 等等等
等.

还有一些常用的进行修改的命令, 放在哪一章都不合适, 列在这里:

- `~` 修改光标下字符的大小写, 并移动到下一个字符. 这不是一个操作符(除非设置了 '`tildeop`'), 所以你不能连接一个动作命令. 这个命令在可视模式下也有效, 它会改变被选中的所有文本的大小写. (recall `0g~$`)
- I 移到当前行的第一个非空字符并启动插入模式.
- A 移动到行尾并启动插入模式.

### 关于修改的更多知识

`p` 和 `P` 命令接受计数前缀, 被插入的文本就会被插入指定的次数. 所以 `dd` 后加
一个 `3p` 会把删除行的三个拷贝插入到文本中.

#### 交换两个字符

经常发生这样的情况, 你的手指比脑子转得快 (或者相反？), 把 "the" 敲成 "teh".
Vim 让你可以很容易得修正这种错误：
只要把光标移到 `teh` 的 `e` 上, 然后执行 `xp` 即可. 这个工作过程是: `x` 删除一个字
符, 保存到寄存器. `p` 把这个被保存的字符插入到光标的后面, 也就是在 `h` 的后面
了.

#### 拷贝文本

由于 `y` 是一个操作符, 所以 `yw` 命令就是拷贝一个单词了.
当然了, 计数前缀也是有效的. 要拷贝两个单词, 就可以用 `y2w`

注意:`yw` 命令包括单词后面的空白字符. 如果你不想要这个字符, 改用 `ye` 命令.

`yy` 命令拷贝一整行, 就像 `dd` 删除一整行一样.
出乎意料地是, `D` (从光标所在)删除到行尾而`Y` 却是拷贝一整行. 要注意这个区别！
`y$` 拷贝到行尾.

#### 使用剪贴板

这部分比较有用的内容

如果你使用 `Vim` 的 `GUI` 版本 (`gvim`), 你可以在 `Edit` 菜单中找到 "`Copy`" 项.
如果你用的不是`GUI`, 或者你根本不喜欢用菜单, 你只能用其它办法了.

假如你已经从其它程序中拷贝了一些文字到剪贴板, 你还是可以用普通的 `y` (`yank`) 和 `p` (`put`) 命令, 但在前面必须加上 `"*` (一个双引号加一个星号). 例如, 要拷贝一行到剪贴板中:

```vim
"*yy
```

要粘贴回来:

```vim
"*p
```

这仅在支持剪贴板的 `Vim` 版本中才能工作.

更多的寄存器名称：

| 类型           | 标识               | 读写者 | 是否为只读 | 包含的字符来源                                                                                                                                                                   |
| -------------- | ------------------ | ------ | ---------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `Unnamed`      | `"`                | `vim`  | 否         | `最近一次的复制或删除操作 (d, c, s, x, y)`                                                                                                                                      |
| `Numbered`     | `0`至`9`           | `vim`  | 否         | ``寄存器 0: 最近一次复制. 寄存器 1: 最近一次删除. 寄存器 2: 倒数第二次删除, 以此类推. 对于寄存器 1 至 9, 他们其实是只读的最多包含 9 个元素的队列. 这里的队列即为数据类型 queue`` |
| `Small delete` | `-`                | `vim`  | 否         | `最近一次行内删除`                                                                                                                                                               |
| `Named`        | `a`至`z`, `A`至`Z` | 用户   | 否         | `如果你通过复制操作存储文本至寄存器 a, 那么 a 中的文本就会被完全覆盖. 如果你存储至 A, 那么会将文本添加给寄存器 a, 不会覆盖之前已有的文本`                                        |
| `Selection`    | `+`和`*`           | `vim`  | 否         | `*` 和 `+` 是 剪贴板 寄存器                                                                                                                                                      |

这里涉及到的`寄存器`概念, 详见 [寄存器][]

[寄存器]: https://github.com/wsdjeg/vim-galore-zh_cn#%E5%AF%84%E5%AD%98%E5%99%A8

## 一些小技巧

### 清除搜索高亮

前面提到的配置中, 有一项是高亮全部搜索结果 `:set hlsearch`, 其作用是当你执行 `/`
, `?`, `*` 或 `#` 搜索后高亮所有匹配结果.

它会一直高亮下去, 直到你用 `:set nohlsearch` 将其关闭.

但这样很麻烦, 可以通过
**再搜一个不存在的字符串**
比如 `/lfw`, 一是因为 `lfw` 这个组合一般不会出现, 二是这三个字母的组合按起来比较舒服.

anyway, help yourself.

### 重复上一次命令

Vim 有一个特殊的命令 `.`, 你可以用它重复执行上一个命令.

### 缩进

- `>>` 向右缩进当前行
- `<<` 向左缩进当前行

### 自动排版

- `==` 自动排版当前行
- `gg=G` 当前文档全文自动排版
- `<N>==` 对从当前行开始的 N 行进行自动排版
- `=<N>j` 对当前行以及向下 N 行进行自动排版
- `=<N>k` 对当前行以及向上 N 行进行自动排版

## 分屏与标签页

### 窗口分屏

工作中经常会遇到这种情况, 就是需要参照其他文档编辑当前文档(场景：翻译), 或者从另外一个文档复制代码到当前文档(场景：复制 html 元素类名到 css 文档), 这时候就是你最需要分屏的时候.

#### 分屏方式

- `:split` 缩写 `:sp` or `Ctrl-w s` 上下分屏
- `:vsplit` 缩写 `:vs` or `Ctrl-w v` 左右分屏
- `:diffsplit` 缩写 `:diffs` `diff` 模式打开一个分屏, 后面可以加上 {filename}

#### 窗口跳转

- `Ctrl-w w` 激活下一个窗口
- `Ctrl-w j` 激活下方窗口
- `Ctrl-w k` 激活上方窗口
- `Ctrl-w h` 激活左侧窗口
- `Ctrl-w l` 激活右侧窗口
- `Ctrl-w c` 关闭当前窗口

#### 移动分屏

- `Ctrl-w L` 移动到最右侧
- `Ctrl-w H` 移动到最左侧
- `Ctrl-w K` 移动到顶部
- `Ctrl-w J` 移动到底部

注意：区分大小写. 另外, 可以将底部的屏幕移动到右侧, 实现上下分屏到左右分屏的转换.

#### 屏幕缩放

- `Ctrl-w =` 平均窗口尺寸
- `Ctrl-w +` 增加高度
- `Ctrl-w -` 缩减高度
- `Ctrl-w _` 最大高度
- `Ctrl-w >` 增加宽度
- `Ctrl-w <` 缩减宽度
- `Ctrl-w |` 最大宽度

### 标签页

[缓冲区](###-buffer)中提到过的 `buffer` 和刚刚讲到的分屏操作都很适合在少量文件之间进行切换,
文件超过 3 个我觉得就不方便了, 而标签页则更适合多文件之间的切换.

#### 创建标签页

- `:tabnew` or `:tabedit` 缩写 `:tabe` 打开新标签页
- `Ctrl-w` or `gf` 在新标签页中打开当前光标所在位置的文件名

注意：

`:tabnew` 和 `:tabedit` 后面都可以跟一个 `<空格><文件名>` 用以在新标签页中
打开指定文件, 还可以在 `:` 后面加一个数字, 指出新标签页在列表中的位置(从 `0` 开始).

#### 切换标签页

- `gt` or `:tabnext` 缩写 `:tabn` 下一个标签页(最后一个会循环到第一个)
- `gT` or `:tabprevious` 缩写 `:tabp` 上一个标签页(第一个会循环到最后一个)
- `:tabrewind` 缩写 `:tabr` or `:tabfirst` 缩写 `:tabfir` 到第一个
- `:tablast` 缩写 `:tabl` 到最后一个标签页

#### 关闭标签页

- `:tabclose` 缩写 `:tabc` 关闭当前标签页
- `:-tabc` 关闭上一个标签页
- `:+tabc` 关闭下一个标签页
- `:tabonly` 缩写 `:tabo` 关闭其他标签页

## 块操作

我们经常会遇到这种情况：某处有一个多行文本, 我们要把他复制到代码中用来初始化一个数组.
大部分时候我们会这么做：

写好数组声明；
把内容复制到中括号内(大概长成下面那段文本的样子)
然后行首加 `'` 行尾加 `'`,, 重复直到最后一行(想象一下这段文本有50行)

有了 `Vim` 块操作就不用这么麻烦了, 按 `014gg`, 然后:

`Ctrl-v` 进入块操作, `$` 到行尾, `j` 到下一行

现在按 `A` 插入, 然后输入 `<单引号><逗号><Esc>` 完成第一步.

末行按 `A` 时改按 `I`, 块操作中 `A` 是字符后插入,  `I` 是字符前插入；
最后按`<单引号><Esc>`.

最后再做些收尾工作, `19gg$x` 删掉最后一行结尾处的 `,`, 然后 `14gg7==` 把代码缩进一下.

Done!

注意：选择行首行尾的操作也可以在选择完要处理的内容之后执行, 即 `Ctrl-v jjj$',<Esc>`

## Vim 中的宏

按 `qa` 开启宏录制, 前方高能, 连续按 `I<单引号><Esc>A<单引号><逗号><Esc>jq7@a`

- `q` 是开启录制宏, `a` 是给这次宏的录制过程一个存储位置, 可以是 `0-9` 或 `a-z`；
- 然后 `I<单引号><Esc>A<单引号><逗号><Esc>j` 是你这次录制的整个宏的操作过程, 意思就是行首
插入单引号, 行尾插入单引号和逗号, 跳到下一行；
- 接下来的 `q` 是结束本次宏的录制；
- `@` 是唤起宏, `a` 是要唤起的宏的名字(存储位置), 前面的 `7` 你应该明白吧, 就是执行 `7` 次.

**Tips:** `@@` 再次唤起最后一次执行的宏.

## 24.3--补全

`Vim` 能自动补全插入的单词. 你键入一个单词的开头部分, 按 `CTRL-P`, `Vim` 就会为你猜
测余下的部分.
例如, 假定你正在建立一个 `C` 程序, 并要键入以下语句:

```c
total = ch_array[0] + ch_array[1] + ch_array[2];
```

你先输入下面这部分:

```c
total = ch_array[0] + ch_
```

此时, 你用命令 `CTRL-P` 告诉 `Vim` 来补全这个词. `Vim` 就会搜索以光标前字符串开头的
词. 在这个例子中, 就是 "`ch_`", 与词 `ch_array` 匹配. 所以, 键入 `CTRL-P` 就会得到下
面的结果:

```vim
total = ch_array[0] + ch_array
```

再键入几个字符使这个语句变成这样 (结尾是空格):

```vim
total = ch_array[0] + ch_array[1] +
```

如果你现在键入 `CTRL-P`, `Vim` 将再次搜索以补全光标前的词. 由于光标前是空格, 它找
到的是之前的第一个词, 即 "`ch_array`". 再键入 `CTRL-P` 给你下一个匹配的词, 在本例
中就是 "`total`". 第三次 `CTRL-P` 搜寻更前面的. 如果那儿没其它的了, 编辑器就会陷入
无词可配状态, 所以搜索就返回原处, 即那个空格. 第四次 `CTRL-P` 导致编辑器周而复
始, 又找到 "`ch_array`".

往下搜索, 用 `CTRL-N`. 由于在文件结尾搜索又绕回开头, `CTRL-N` 和 `CTRL-P` 将找到相同
的匹配, 但顺序不同. 提示: `CTRL-N` 意为下一个匹配, 而 `CTRL-P` 意为前一个匹配.
(译者: 英文 Next 意为下一个, `Previous`意为前一个)

`Vim` 编辑器会非常努力的来补全不完整的词. 默认情况下, 它搜索如下一些地方:

1. 当前文件
1. 其它窗口内的文件
1. 其它载入文件 (隐藏缓冲区)
1. 未载入文件 (非激活缓冲区)
1. 标签文件
1. 被当前文件以 `#include` 语句包含的所有头文件

### completion选项

你可以利用 '`complete`' 选项定制搜索顺序.

还可以使用 '`ignorecase`' 选项. 设定这个选项后, 搜寻匹配时大小写的区别就会被忽
略.

一个特殊的补全选项是 '`infercase`'. 它的用处是在寻找忽略大小写的匹配时
('`ignorecase`' 必须先被设定), 但仍然采用已键入部分的大小写. 这样, 如果你键入
"`For`" 而 `Vim` 找到了匹配 "`fortunately`", 所产生的结果将是 "`Fortunately`".

### 补全特定文本

如果你知道你要找什么, 那么你可以用这些命令来补全某种类型的文本:

- `CTRL-X CTRL-F`           文件名
- `CTRL-X CTRL-L`           整行
- `CTRL-X CTRL-D`           宏定义 (包括包含文件里的)
- `CTRL-X CTRL-I`           当前文件以及所包含的文件
- `CTRL-X CTRL-K`           字典文件内的单词
- `CTRL-X CTRL-T`           同义词词典文件内的单词
- `CTRL-X CTRL-]`           标签
- `CTRL-X CTRL-V`           `Vim` 命令行

每个命令之后, `CTRL-N` 可以用来搜索下一个匹配, 而 `CTRL-P` 则用于搜索前一个匹配.
关于每个命令的详细用法, 参见:  `ins-completion` .

### 补全文件名

我们以 `CTRL-X CTRL-F` 为例. 这个命令将找寻文件名.
它在当前目录里搜索文件, 并显示每一个与光标前单词匹配的文件名.
例如, 假定你在当前目录里有下面这些文件:

```vim
main.c  sub_count.c  sub_done.c  sub_exit.c
```

现在进入插入模式并开始键入:

```vim
The exit code is in the file sub
```

就在这点上, 你输入 `CTRL-X CTRL-F`. 现在, `Vim` 通过查看当前目录里的文件来补全当前
词 "`sub`". 最初的匹配是 `sub_count.c`. 这不是你想要的, 所以你按 `CTRL-N` 以匹配下一
个文件. 这次匹配的是 `sub_done.c`. 再键入 `CTRL-N` 给了你 `sub_exit.c`. 结果:

```vim
The exit code is in the file sub_exit.c
```

如果文件名以 `/ (Unix)` 或 `C:\ (MS-Windows)` 开头, 那么你就能搜索文件系统下所有的
文件. 例如, 键入 `"/u"` 然后 `CTRL-X CTRL-F`, 这将匹配 `"/usr"` (这是在 `Unix` 上):

```vim
the file is found in /usr/
```

如果你现在按 `CTRL-N`, 你就又回到 "`/u`". 接受 "`/usr/`" 并进入下一层目录, 再来一次`CTRL-X CTRL-F`:

```vim
the file is found in /usr/X11R6/
```

当然, 匹配结果取决于你的文件系统上有什么文件. 匹配结果以字母顺序来排列.

### 补全源代码

源代码文件有良好的结构. 这使通过某种智能方式补全成为可能. 在 `Vim` 中, 这被称为
全能补全. 在其他编辑器中, 它被称为智能补全(`intellisense`), 但这是一个注册商标.

全能补全的热键是 `CTRL-X CTRL-O`. 显然, `O` 在这里代表全能 (`Omni`), 这样方便我们记
忆. 让我们以编辑 `C` 程序为例:

```vim
{ ~
  struct foo *p; ~
p-> ~
```

光标在 "`p->`" 之后. 现在键入 `CTRL-X CTRL-O``. Vim` 会给你提供一个可选项的列表, 这
些可选项为 "`struct foo`" 所拥有. 这和使用 `CTRL-P` 有很大不同, 后者补全任意单词,
而我们这里只要求 "`struct foo`" 的成员.

为使全能补全工作, 需要做一些初始化. 起码, 要保证打开文件类型插件. 你的 `vimrc`
文件应该包含形如:
`filetype plugin on`
或:
`filetype plugin indent on`
的一行.

对于 `C` 代码, 需要建立标签文件并设置 '`tags`' 选项. 在 `ft-c-omni`  中有进一步的解
释. 对于其他文件类型, 需要做类似的事情, 请查看  `compl-omni-filetypes` . 补全只
对特定文件类型有效. 查看 '`omnifunc`' 选项的值, 以便检查补全能否正常工作.

## Vim显示空白字符

[ Vim怎么显示空格, Tab制表符, 行尾换行符等非打印字符][]

[ Vim怎么显示空格, Tab制表符, 行尾换行符等非打印字符]: https://vimjc.com/vim-display-unprintable-character.html

默认配置下, Vim下无法显示空格, tab键, 换行符等特殊的不可打印字符.
但恰恰是这些不可打印字符, 经常对源代码编译, 文件编码, 错误输入检查等问题定位产生干扰.

Vim教程网(https://vimjc.com)介绍如何通过VIM设置, 在Vim下正常显示出空格, tab制表符, 换行符等字符.

### Vim显示行尾换行符

Vim设置项 `list` (默认关闭, 只对当前窗口有效) 可用于设置 `List mode`：使用` ^I` (通过组合键 `<CTRL-I>`输入) 显示 `tab` 制表符, 使用 `$` 符号显示行尾.

因此, 如果仅仅是需要在 `Vim` 中显示制表符和行尾结束符, 可以在 `Vim` 命令行下执行 `:set list` 命令达到目的.

`:set nolist` 可关闭 “`List mode`”, 即不再在Vim下显示出行尾和制表符等特殊符号.

可以通过 `:help 'list'` 查看Vim官方文档中对 `list` 选项的介绍.

### Vim定制Tab制表符, 行尾结束符显示格式

如果希望更改 Vim 默认对空格, 行尾结束符, Tab制表符的显示样式, 需要使用到 `listchars` (缩写形式 `lcs`) 选项.

Vim 的 `listchars` 选项用于设置 “List mode” 以及 `:list` 命令的显示样式 (Strings to use in ‘list’ mode and for the :list command), 通过分割不同字符的设置.

1. 可通过 `set listchars=eol:c` 设置 某个字符 来显示每行的行尾结束符 (Character to show at the end of each line).
2. 可通过 `set listchars=tab:xy` 设置 两个字符 来显示`Tab`制表符. 第一个字符只会显示一次, 制表符剩余的空间会用第二个字符重复进行显示.

例如, 若设置了 `set listchars=tab:>-`, 则会用 `>--- `显示4个长度的制表符.
可阅读[Vim自动缩进配置, 原理和tab键替换空格][] 查看关于Vim缩进以及Tab键显示相关介绍.

3. 可通过 `set listchars=space:c` 设置 某个字符 来显示一个空格 (Character to show for a space).
4. 可通过 `set listchars=trail:c` 设置 某个字符 来显示一个行尾空格 (Character to show for trailing spaces).

[Vim自动缩进配置, 原理和tab键替换空格]: https://vimjc.com/vim-indent.html

### vim tab设置为4个空格

[vim tab设置为4个空格][]

[vim tab设置为4个空格]: https://blog.csdn.net/jiang1013nan/article/details/6298727

在`.vimrc`中添加以下代码后, 重启`vim`即可实现按`TAB`产生`4`个空格：

```vim
set ts=4  (注：ts是tabstop的缩写, 设TAB宽4个空格)
set expandtab
```

对于已保存的文件, 可以使用下面的方法进行空格和TAB的替换：

```vim
TAB替换为空格：
:set ts=4
:set expandtab
:%retab!
```

空格替换为TAB：

```bash
:set ts=4
:set noexpandtab
:%retab!
```

加`!`是用于处理非空白字符之后的`TAB`, 即所有的`TAB`, 若不加!, 则只处理行首的`TAB`.
